[WI-0][TI-0] - [INFO] 2024-05-04 01:00:01.616 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:06.637 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:09.905 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8313253012048194 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:09.919 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:10.034 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8313253012048194 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:10.484 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714755609998, cpuUsage=0.8438438438438438, jvmMemoryUsage=0.03402503331502279, memoryUsage=0.48407042500804787, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:10.502 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:10.924 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:11.724 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:11.924 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:12.926 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:13.932 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:14.933 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:15.938 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:16.764 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:16.943 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:17.948 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:18.951 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:19.959 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8284023668639054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:19.959 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:20.118 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8284023668639054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:20.524 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714755620113, cpuUsage=0.8456973293768546, jvmMemoryUsage=0.03402503331502279, memoryUsage=0.48269548025935255, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:20.555 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:20.960 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8882521489971347 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:20.961 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:21.189 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8882521489971347 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:21.789 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:21.962 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492537313432835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:21.963 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:22.194 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492537313432835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:22.965 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7397260273972602 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:22.966 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:23.205 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7397260273972602 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:23.969 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:24.974 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:25.975 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:26.869 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:26.977 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:27.978 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:28.984 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:29.990 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:30.629 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:31.890 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:34.009 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7071005917159764 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:34.009 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:34.250 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7071005917159764 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:36.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:39.020 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9310344827586207 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:39.020 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:39.287 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9310344827586207 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:40.022 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8285714285714285 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:40.023 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:40.339 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8285714285714285 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:40.644 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714755639289, cpuUsage=0.9316239316239316, jvmMemoryUsage=0.03402503331502279, memoryUsage=0.48784013975721835, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:40.649 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:41.024 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:41.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:42.036 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7721893491124261 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:42.047 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:42.391 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7721893491124261 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:43.052 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7881619937694704 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:43.053 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:43.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7881619937694704 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:44.054 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:45.058 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:46.060 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:47.012 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:47.065 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:48.068 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:49.070 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:00:50.072 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:50.665 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:52.072 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:00:57.106 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:02.139 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:07.155 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:11.213 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8411505951354148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:01:11.227 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:11.507 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8411505951354148 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:12.210 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:12.229 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7640467089071582 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:01:12.229 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:12.519 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7640467089071582 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:13.230 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7921348314606741 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:01:13.230 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:13.520 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7921348314606741 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:14.236 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8622589531680441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:01:14.236 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:14.520 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8622589531680441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:16.240 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7797101449275362 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:01:16.240 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:16.535 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7797101449275362 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:17.243 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:22.270 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:27.283 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:32.298 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:37.372 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:42.408 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:47.426 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:52.441 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:01:57.465 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:02.491 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:07.511 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:12.564 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:15.834 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7692395483995575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:02:15.834 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:15.942 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7692395483995575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:17.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:22.605 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:27.624 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:32.641 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:37.712 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:42.760 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:47.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:52.803 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:02:57.821 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:02.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:07.863 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:12.959 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:13.253 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7065868263473054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:03:13.253 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:13.273 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7065868263473054 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:17.997 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:23.059 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:28.085 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:31.384 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7236467236467237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:03:31.384 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:31.418 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7236467236467237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:33.135 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:38.155 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:43.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:48.197 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:52.527 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:03:52.528 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:53.214 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:58.342 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 29/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:58.569 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7087378640776698 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:03:58.627 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7087378640776698 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:03:58.628 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:02.629 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7987991347803387 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:02.648 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7987991347803387 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:02.654 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:03.412 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:03.694 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9801699716713881 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:03.695 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:07.715 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:08.520 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:08.723 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7626112759643917 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:08.729 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:08.738 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7626112759643917 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:09.731 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7414772727272727 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:09.731 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:09.739 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7414772727272727 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:10.742 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7349397590361446 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:10.737 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7349397590361446 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:10.748 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:11.321 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714755848913, cpuUsage=0.7634730538922155, jvmMemoryUsage=0.03402503331502279, memoryUsage=0.5083475947812148, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:11.327 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:11.749 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:11.749 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7752161383285303 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:12.752 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:13.578 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:13.756 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:14.771 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:15.786 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:16.787 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:17.789 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:18.600 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:18.789 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:19.792 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:20.794 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.339 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.796 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.830 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.837 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.837 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.839 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.840 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.844 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.880 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.880 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.892 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.899 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2700, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:21.929 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.929 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.930 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:21.930 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.930 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.940 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:21.953 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2700, processInstanceId=879, startTime=1714755861944, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.475 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.484 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.493 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2700, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.495 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.496 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.504 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:22.504 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.524 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2700, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.525 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:22.987 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=Sat May 04 01:04:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2700, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, processId=611, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.479 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=Sat May 04 01:04:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2700, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, processId=611, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.488 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2700, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.489 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2700, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:21 GMT+08:00 2024, endTime=Sat May 04 01:04:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2700, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2700.log, processId=611, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:23.489 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.555 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2700, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.556 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.556 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.556 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.557 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.566 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.567 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.567 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.569 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2700] - [INFO] 2024-05-04 01:04:23.572 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2701, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.578 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.578 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.579 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.579 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.579 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.579 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:23.579 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:04:21 GMT+08:00 2024
Submit Time:            Sat May 04 01:04:21 GMT+08:00 2024
Start Time:             Sat May 04 01:04:21 GMT+08:00 2024
End Time:               Sat May 04 01:04:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:04:23.581 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2701, taskName=switch, firstSubmitTime=1714755863569, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=1, appIds=null, processInstanceId=879, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2701'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504010423'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='879'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.583 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.585 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.590 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.590 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.591 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.591 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714755863591
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.591 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 879_2701
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.592 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2701,
  "taskName" : "switch",
  "firstSubmitTime" : 1714755863569,
  "startTime" : 1714755863591,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 1,
  "processInstanceId" : 879,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2701"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504010423"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "879"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "879_2701",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.592 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.592 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.593 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:23.593 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:23.594 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2701, processInstanceId=879, startTime=1714755863591, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.595 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}] successfully
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.597 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.597 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage'"
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.597 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"'local_storage'" == "local_storage" successfully
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:23.617 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.689 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "'local_storage'" == "local_storage" successfully: false
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.689 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.690 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.691 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.692 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:23 GMT+08:00 2024, endTime=Sat May 04 01:04:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.694 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.695 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:23.695 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.480 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.485 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.485 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:04:24.489 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=161), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2701] - [ERROR] 2024-05-04 01:04:24.492 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.492 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:23 GMT+08:00 2024, endTime=Sat May 04 01:04:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:04:24.496 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=162), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2701] - [WARN] 2024-05-04 01:04:24.498 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2701
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.499 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2701, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.499 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2701, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:23 GMT+08:00 2024, endTime=Sat May 04 01:04:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2701.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:24.499 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.590 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2701, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.590 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.590 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.590 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.591 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.610 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.610 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.610 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.613 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2701] - [INFO] 2024-05-04 01:04:24.615 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2702, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:24.620 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.622 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.622 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:04:24.622 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:04:23 GMT+08:00 2024
Submit Time:            Sat May 04 01:04:23 GMT+08:00 2024
Start Time:             Sat May 04 01:04:23 GMT+08:00 2024
End Time:               Sat May 04 01:04:23 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:04:24.630 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:24.667 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2702, processInstanceId=879, startTime=1714755864635, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.488 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.488 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.494 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2702, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.495 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.495 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.502 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:25.503 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.587 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2702, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.587 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:25.711 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=Sat May 04 01:04:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2702, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, processId=622, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.521 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=Sat May 04 01:04:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2702, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, processId=622, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.544 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2702, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.545 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2702, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:04:24 GMT+08:00 2024, endTime=Sat May 04 01:04:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_1/879/2702, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/1/879/2702.log, processId=622, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage'"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:26.550 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2702, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.619 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.619 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.619 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2702] - [INFO] 2024-05-04 01:04:26.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:04:24 GMT+08:00 2024
Submit Time:            Sat May 04 01:04:24 GMT+08:00 2024
Start Time:             Sat May 04 01:04:24 GMT+08:00 2024
End Time:               Sat May 04 01:04:25 GMT+08:00 2024

[WI-879][TI-null] - [INFO] 2024-05-04 01:04:26.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=879, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-null] - [INFO] 2024-05-04 01:04:26.642 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-null] - [INFO] 2024-05-04 01:04:26.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-1-20240504010421800
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:04:21 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:04:21 GMT+08:00 2024
End Time:                  Sat May 04 01:04:26 GMT+08:00 2024

[WI-879][TI-0] - [INFO] 2024-05-04 01:04:26.648 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:28.660 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 29/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:31.914 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:04:31.914 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:33.139 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:33.160 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 01:04:33.160 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:04:33.160 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:04:33.160 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:04:33.161 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:04:33.161 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:04:33.162 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:04:33.163 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:04:33.163 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:33.163 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:6ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:33.689 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:38.701 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:43.711 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:48.733 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:53.760 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:04:58.811 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 20/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:03.940 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 23/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:07.116 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8198198198198199 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:07.135 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8198198198198199 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:05:07.136 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:08.142 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7172619047619048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:08.154 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7172619047619048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:05:08.154 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:09.002 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:09.155 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7090909090909091 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:05:09.155 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:10.156 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7045454545454545 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:05:10.159 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:10.172 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7045454545454545 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:14.036 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:19.111 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 17/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:24.136 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:29.157 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:34.175 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:39.189 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:44.204 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:49.219 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:54.243 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:05:59.271 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:04.289 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:09.323 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:14.338 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:19.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:24.376 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:29.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:34.407 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:39.421 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:44.439 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:49.510 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:54.523 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:06:59.539 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:04.561 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:09.617 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:14.630 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:19.710 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:24.741 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:29.762 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:31.669 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7852941176470588 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:31.669 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7852941176470588 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:31.670 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:31.807 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:32.671 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:33.677 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:34.678 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:34.790 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:35.684 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7011494252873564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:35.684 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:35.694 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7011494252873564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:36.692 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7936046511627908 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:36.700 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:36.705 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7936046511627908 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:37.712 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.751412429378531 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:37.702 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.751412429378531 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:37.712 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:38.721 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:39.730 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.73121387283237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:39.731 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:39.739 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.73121387283237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:39.874 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:40.732 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7964071856287425 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:40.733 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:40.753 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7964071856287425 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:41.739 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774480712166172 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:41.748 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:41.771 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774480712166172 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:41.812 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714756059912, cpuUsage=0.7357954545454545, jvmMemoryUsage=0.03403472900390625, memoryUsage=0.501472473367529, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:41.816 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:42.749 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:43.754 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:44.765 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:44.935 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:45.767 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:46.771 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:47.776 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:48.778 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:49.781 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:49.956 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:50.783 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:07:51.784 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:51.842 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:07:54.976 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:00.036 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 33/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:05.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:10.113 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:15.148 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:20.212 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:25.238 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:30.264 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:35.277 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:40.326 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:42.060 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.5 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:08:42.061 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:45.346 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:50.365 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:53.103 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:08:53.103 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:55.378 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:08:58.172 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:08:58.172 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:00.397 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:05.467 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:06.223 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7546583850931677 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:06.228 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7546583850931677 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:06.229 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:10.498 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:15.511 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:20.294 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7225609756097562 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:20.315 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7225609756097562 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:20.315 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:20.632 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:21.318 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8575667655786351 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:21.319 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:21.358 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8575667655786351 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:22.062 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714756160606, cpuUsage=0.7713414634146342, jvmMemoryUsage=0.03403472900390625, memoryUsage=0.5066674381468728, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:22.067 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:22.320 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7155688622754491 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:22.320 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:22.367 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7155688622754491 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:23.329 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:24.330 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:25.332 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:25.671 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:26.341 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:27.343 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:28.345 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:29.347 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230769230769231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:29.347 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:29.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230769230769231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:30.349 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:30.724 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:09:31.371 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:32.274 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:35.819 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 27/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:40.846 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:45.873 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:50.900 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:09:55.927 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:00.937 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:05.952 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:10.992 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:16.010 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:21.023 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:26.036 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:31.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:36.100 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:41.124 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:46.145 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:51.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:10:56.206 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:01.337 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:06.363 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:11.421 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:16.437 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:21.445 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:26.458 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:31.483 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:36.511 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:41.525 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:46.541 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:51.575 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:11:56.586 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:01.603 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:06.619 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:11.639 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:13.623 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:12:13.624 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:16.664 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:21.698 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:26.721 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:31.743 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:36.764 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:41.780 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:46.802 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:51.843 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:12:56.857 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:01.898 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:06.917 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:11.948 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:16.961 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:21.977 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:26.993 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:32.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:32.136 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:32.764 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:33.161 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:34.163 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:34.163 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:35.166 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:36.170 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:37.040 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:37.182 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:38.186 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:39.187 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:40.190 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:41.191 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:42.058 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:42.205 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:42.773 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:46.231 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:13:46.231 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:47.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:52.104 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:13:57.122 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:02.140 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:07.164 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:12.269 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:17.300 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:22.331 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:25.469 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8710601719197708 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:14:25.469 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:25.481 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8710601719197708 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:27.353 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:32.372 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:33.180 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:33.268 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 01:14:33.268 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:14:33.268 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:14:33.269 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:14:33.269 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:14:33.269 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:14:33.269 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:14:33.270 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:14:33.270 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:33.270 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:14ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:37.402 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:42.459 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:47.473 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:52.489 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:53.576 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7176470588235293 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:14:53.577 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:53.610 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7176470588235293 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:14:57.521 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:02.563 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:07.600 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:12.629 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:17.646 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:22.666 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:27.683 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:32.746 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:37.768 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:42.792 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:47.861 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:51.884 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8130841121495327 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:15:51.885 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:51.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8130841121495327 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:52.877 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:53.887 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8070739549839229 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:15:53.887 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:53.913 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8070739549839229 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:57.911 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:15:59.998 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9138888888888889 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:00.001 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9138888888888889 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:00.001 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.007 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 3ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.036 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.043 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.044 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.047 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=879)
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.048 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.048 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.053 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.053 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.060 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.061 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.066 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.075 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2703, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.092 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:01.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.092 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.135 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.215 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2703, processInstanceId=879, startTime=1714756561134, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.608 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.623 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.624 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.649 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2703, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.650 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.651 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.663 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:01.663 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2703, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:01.755 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.278 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2703, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, processId=778, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.611 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2703, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, processId=778, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.621 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2703, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.622 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2703, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:01 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2703, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2703.log, processId=778, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:02.622 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2703, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.707 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.708 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.708 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.708 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.716 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.720 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2703] - [INFO] 2024-05-04 01:16:02.723 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2704, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.729 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.729 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.730 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.730 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.730 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.730 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:02.731 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:01 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:01 GMT+08:00 2024
Start Time:             Sat May 04 01:16:01 GMT+08:00 2024
End Time:               Sat May 04 01:16:02 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:02.732 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2704, taskName=switch, firstSubmitTime=1714756562720, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=2, appIds=null, processInstanceId=879, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2704'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504011602'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='879'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.733 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:02.739 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.740 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.741 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714756562741
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.741 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 879_2704
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.741 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2704,
  "taskName" : "switch",
  "firstSubmitTime" : 1714756562720,
  "startTime" : 1714756562741,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 2,
  "processInstanceId" : 879,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2704"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504011602"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "879"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "879_2704",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.742 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.742 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.742 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:02.743 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2704, processInstanceId=879, startTime=1714756562741, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.744 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.746 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.747 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.748 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-879][TI-2704] - [ERROR] 2024-05-04 01:16:02.749 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2704] - [ERROR] 2024-05-04 01:16:02.749 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2704] - [WARN] 2024-05-04 01:16:02.749 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.753 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:02 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.755 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.755 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.756 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:02.756 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:02.941 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.614 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.619 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.619 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:03.623 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=174), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2704] - [ERROR] 2024-05-04 01:16:03.625 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:02 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.625 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:02 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:03.639 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=175), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2704] - [WARN] 2024-05-04 01:16:03.641 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2704
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.642 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2704, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.642 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2704, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:02 GMT+08:00 2024, endTime=Sat May 04 01:16:02 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2704.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:03.642 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.742 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2704, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.743 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.743 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.747 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.747 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.747 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.768 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.770 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2704] - [INFO] 2024-05-04 01:16:03.773 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2705, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.810 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:03.811 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:03.812 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:03.812 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:03.812 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:02 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:02 GMT+08:00 2024
Start Time:             Sat May 04 01:16:02 GMT+08:00 2024
End Time:               Sat May 04 01:16:02 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:03.813 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2705, taskName=switch, firstSubmitTime=1714756563770, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=2, appIds=null, processInstanceId=879, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2705'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504011603'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='879'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.814 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.814 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.818 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:03.821 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.821 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.821 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714756563821
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.822 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 879_2705
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2705,
  "taskName" : "switch",
  "firstSubmitTime" : 1714756563770,
  "startTime" : 1714756563821,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 2,
  "processInstanceId" : 879,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2705"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504011603"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "879"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "879_2705",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.826 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.827 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.827 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:03.830 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2705, processInstanceId=879, startTime=1714756563821, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.832 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.834 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-879][TI-2705] - [ERROR] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.836 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2705] - [ERROR] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2705] - [WARN] 2024-05-04 01:16:03.836 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.838 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:03 GMT+08:00 2024, endTime=Sat May 04 01:16:03 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.839 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.839 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.839 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:03.839 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.633 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.640 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.640 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:04.645 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=179), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2705] - [ERROR] 2024-05-04 01:16:04.646 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.647 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:03 GMT+08:00 2024, endTime=Sat May 04 01:16:03 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:04.652 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=180), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2705] - [WARN] 2024-05-04 01:16:04.654 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2705
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.654 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2705, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.654 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2705, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:03 GMT+08:00 2024, endTime=Sat May 04 01:16:03 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2705.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:04.654 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2705, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.720 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.721 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.721 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.721 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.725 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2705] - [INFO] 2024-05-04 01:16:04.726 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2706, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.736 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:04.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:04.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:04.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:04.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:03 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:03 GMT+08:00 2024
Start Time:             Sat May 04 01:16:03 GMT+08:00 2024
End Time:               Sat May 04 01:16:03 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:04.738 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2706, taskName=switch, firstSubmitTime=1714756564725, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=2, appIds=null, processInstanceId=879, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2706'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504011604'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='879'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.738 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.745 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.745 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:04.757 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.756 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714756564756
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 879_2706
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2706,
  "taskName" : "switch",
  "firstSubmitTime" : 1714756564725,
  "startTime" : 1714756564756,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 2,
  "processInstanceId" : 879,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2706"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504011604"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "879"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "879_2706",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.759 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:04.760 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2706, processInstanceId=879, startTime=1714756564756, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.761 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.762 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.762 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.762 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.762 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.763 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.763 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.763 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.763 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-879][TI-2706] - [ERROR] 2024-05-04 01:16:04.763 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.764 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.764 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.764 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2706] - [ERROR] 2024-05-04 01:16:04.764 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2706] - [WARN] 2024-05-04 01:16:04.764 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.765 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:04 GMT+08:00 2024, endTime=Sat May 04 01:16:04 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:04.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.637 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.649 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.649 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:05.660 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=184), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2706] - [ERROR] 2024-05-04 01:16:05.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:04 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.689 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:04 GMT+08:00 2024, endTime=Sat May 04 01:16:04 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:05.699 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=185), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2706] - [WARN] 2024-05-04 01:16:05.701 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2706
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.702 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2706, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.702 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2706, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:04 GMT+08:00 2024, endTime=Sat May 04 01:16:04 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2706.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:05.702 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2706, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.761 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.761 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.761 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.761 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.761 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.764 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.764 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.764 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.768 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2706] - [INFO] 2024-05-04 01:16:05.771 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2707, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.781 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:05.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:05.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:05.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:05.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:04 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:04 GMT+08:00 2024
Start Time:             Sat May 04 01:16:04 GMT+08:00 2024
End Time:               Sat May 04 01:16:04 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:05.784 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2707, taskName=switch, firstSubmitTime=1714756565769, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=2, appIds=null, processInstanceId=879, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2707'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504011605'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='879'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.785 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.785 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.793 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:05.791 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.795 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714756565795
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 879_2707
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.795 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2707,
  "taskName" : "switch",
  "firstSubmitTime" : 1714756565769,
  "startTime" : 1714756565795,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 2,
  "processInstanceId" : 879,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2707"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504011605"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "879"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "879_2707",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:05.798 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2707, processInstanceId=879, startTime=1714756565795, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.803 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-879][TI-2707] - [ERROR] 2024-05-04 01:16:05.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-879][TI-2707] - [ERROR] 2024-05-04 01:16:05.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2707] - [WARN] 2024-05-04 01:16:05.805 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.809 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:05 GMT+08:00 2024, endTime=Sat May 04 01:16:05 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:05.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.739 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.739 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:06.745 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=189), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2707] - [ERROR] 2024-05-04 01:16:06.748 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.748 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:05 GMT+08:00 2024, endTime=Sat May 04 01:16:05 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:06.756 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=190), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 119, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-879][TI-2707] - [WARN] 2024-05-04 01:16:06.759 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2707
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.760 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2707, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.760 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2707, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:16:05 GMT+08:00 2024, endTime=Sat May 04 01:16:05 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2707.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:06.760 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.790 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2707, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.790 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.791 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.791 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.791 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.804 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:879, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2707] - [INFO] 2024-05-04 01:16:06.806 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2708, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:879, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:06.818 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.819 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.820 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-879][TI-0] - [INFO] 2024-05-04 01:16:06.821 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:05 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:05 GMT+08:00 2024
Start Time:             Sat May 04 01:16:05 GMT+08:00 2024
End Time:               Sat May 04 01:16:05 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:06.843 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2708, processInstanceId=879, startTime=1714756566831, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:06.848 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.675 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.693 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2708, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.693 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.694 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [WARN] 2024-05-04 01:16:07.695 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.695 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.696 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.711 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2708, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.713 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:07.712 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:07.919 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=Sat May 04 01:16:07 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2708, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, processId=792, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:07.965 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.679 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=Sat May 04 01:16:07 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2708, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, processId=792, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.712 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=879, taskInstanceId=2708, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.712 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2708, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:06 GMT+08:00 2024, endTime=Sat May 04 01:16:07 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_2/879/2708, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/2/879/2708.log, processId=792, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=879)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:08.712 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-879] persist events succeeded
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.735 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=879, taskInstanceId=2708, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.738 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.738 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.739 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-2708] - [INFO] 2024-05-04 01:16:08.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-1-20240504010421800
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:06 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:06 GMT+08:00 2024
Start Time:             Sat May 04 01:16:06 GMT+08:00 2024
End Time:               Sat May 04 01:16:07 GMT+08:00 2024

[WI-879][TI-null] - [INFO] 2024-05-04 01:16:08.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=879, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-879][TI-null] - [INFO] 2024-05-04 01:16:08.766 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-879][TI-null] - [INFO] 2024-05-04 01:16:08.770 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-1-20240504010421800
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:16:01 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:16:01 GMT+08:00 2024
End Time:                  Sat May 04 01:16:08 GMT+08:00 2024

[WI-879][TI-0] - [INFO] 2024-05-04 01:16:08.771 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:10.085 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8119402985074627 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:10.103 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8119402985074627 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:10.104 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:11.105 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7953216374269005 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:11.108 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:11.112 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7953216374269005 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:12.109 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.717741935483871 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:12.110 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:12.113 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.717741935483871 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:12.947 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:13.027 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:13.117 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:14.123 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:15.124 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:16.131 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:17.137 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:18.044 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:18.164 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:19.166 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:20.171 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:21.170 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8323443160255304 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:21.173 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8323443160255304 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:21.176 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:22.178 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:22.980 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:23.056 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:28.076 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.245 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 14ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.286 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=880)
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.286 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=880)
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.287 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=880)
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.288 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=880)
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.289 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.292 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.293 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.295 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:880, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.297 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2709, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:880, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.304 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.304 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.304 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:29.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.305 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.310 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.317 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2709, processInstanceId=880, startTime=1714756589313, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.767 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.813 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.820 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.841 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=880, taskInstanceId=2709, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.842 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.878 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:29.878 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-880] persist events succeeded
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.893 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=880, taskInstanceId=2709, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:29.893 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.220 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8181818181818181 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.289 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8181818181818181 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:30.290 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.362 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2709, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, processId=808, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.766 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2709, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, processId=808, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.777 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=880, taskInstanceId=2709, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.777 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2709, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:29 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2709, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2709.log, processId=808, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.777 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-880] persist events succeeded
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=880, taskInstanceId=2709, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.837 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.838 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.839 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.839 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.859 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.860 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.861 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.866 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:880, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-2709] - [INFO] 2024-05-04 01:16:30.873 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2710, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:880, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.885 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.886 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:30.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-120-20240504011629262
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:29 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:29 GMT+08:00 2024
Start Time:             Sat May 04 01:16:29 GMT+08:00 2024
End Time:               Sat May 04 01:16:30 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.888 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2710, taskName=check file existence, firstSubmitTime=1714756590866, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=120, appIds=null, processInstanceId=880, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2710'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504011630'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='880'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='null'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.890 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.891 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.911 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.911 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.911 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.911 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714756590911
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.912 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 880_2710
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.912 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2710,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714756590866,
  "startTime" : 1714756590911,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 120,
  "processInstanceId" : 880,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2710"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504011630"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "880"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "null"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "880_2710",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.915 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:30.916 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2710, processInstanceId=880, startTime=1714756590911, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.919 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.920 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.920 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.920 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}] successfully
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.922 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.922 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"null"
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.923 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"null" != "null" successfully
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.940 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "null" != "null" successfully: false
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.953 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.960 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.967 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.967 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.967 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.967 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.971 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:30 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.973 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.973 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:30.973 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:31.274 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7088948787061995 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:31.290 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7088948787061995 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:31.291 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.768 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.778 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.779 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:31.787 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=202), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-880][TI-2710] - [ERROR] 2024-05-04 01:16:31.789 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.790 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:30 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:16:31.831 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=203), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-880][TI-2710] - [WARN] 2024-05-04 01:16:31.832 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2710
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.835 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=880, taskInstanceId=2710, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.836 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2710, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:30 GMT+08:00 2024, endTime=Sat May 04 01:16:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2710.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:31.837 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-880] persist events succeeded
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=880, taskInstanceId=2710, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.887 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.889 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.890 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.926 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:end workflow, task id:null, task code:13348985859488
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.927 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348985859488, dependTaskCodes: [13348933988640, 13340113777664]
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.928 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task end workflow is success, so ready to submit to execute
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.931 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : end workflow, processInstance id:880, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-2710] - [INFO] 2024-05-04 01:16:31.934 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2711, taskInstanceName: end workflow, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:880, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:31.940 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.941 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-880][TI-0] - [INFO] 2024-05-04 01:16:31.941 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-120-20240504011629262
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:30 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:30 GMT+08:00 2024
Start Time:             Sat May 04 01:16:30 GMT+08:00 2024
End Time:               Sat May 04 01:16:30 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:16:31.969 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2711, processInstanceId=880, startTime=1714756591951, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:31.972 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task end workflow to 172.18.1.1:1234.
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.768 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.775 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=880, taskInstanceId=2711, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.775 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.776 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [WARN] 2024-05-04 01:16:32.776 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.776 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.776 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.783 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:32.783 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-880] persist events succeeded
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=880, taskInstanceId=2711, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:32.843 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.048 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=Sat May 04 01:16:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2711, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, processId=821, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:33.124 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=Sat May 04 01:16:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2711, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, processId=821, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.791 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=880, taskInstanceId=2711, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.792 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2711, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:16:31 GMT+08:00 2024, endTime=Sat May 04 01:16:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/880/2711, logPath=/opt/dolphinscheduler/logs/20240504/13201021801792/120/880/2711.log, processId=821, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=880)
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:33.792 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-880] persist events succeeded
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.862 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=880, taskInstanceId=2711, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.863 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.863 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348985859488 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.863 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.863 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.869 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.869 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.876 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348985859488 state:TaskExecutionStatus{code=7, desc='success'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.876 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-880][TI-2711] - [INFO] 2024-05-04 01:16:33.876 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              end workflow
Workflow Instance Name: preprocess_post-120-20240504011629262
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:16:31 GMT+08:00 2024
Submit Time:            Sat May 04 01:16:31 GMT+08:00 2024
Start Time:             Sat May 04 01:16:31 GMT+08:00 2024
End Time:               Sat May 04 01:16:33 GMT+08:00 2024

[WI-880][TI-null] - [INFO] 2024-05-04 01:16:33.876 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=880, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-880][TI-null] - [INFO] 2024-05-04 01:16:33.877 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-880][TI-null] - [INFO] 2024-05-04 01:16:33.878 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-120-20240504011629262
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:16:29 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:16:29 GMT+08:00 2024
End Time:                  Sat May 04 01:16:33 GMT+08:00 2024

[WI-880][TI-0] - [INFO] 2024-05-04 01:16:33.878 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:38.187 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:43.206 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:45.352 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7092164759078705 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:45.371 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7092164759078705 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:45.375 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:46.380 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8902077151335311 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:46.394 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:46.404 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8902077151335311 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:48.238 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:50.427 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.734375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:50.427 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:50.440 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.734375 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:51.428 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7217391304347825 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:51.428 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:51.460 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7217391304347825 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:52.429 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7715877437325904 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:52.429 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:52.463 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7715877437325904 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:53.033 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714756612231, cpuUsage=0.7918992162894601, jvmMemoryUsage=0.03435719807942708, memoryUsage=0.5205683979835735, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:53.037 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:53.297 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:53.431 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:54.438 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:55.440 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:56.443 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:57.444 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:58.672 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:16:58.694 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:16:59.678 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:17:00.695 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:17:01.696 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:17:02.698 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:03.052 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:03.727 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:08.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:10.787 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:17:10.788 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:13.797 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:18.810 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:23.822 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:27.924 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:17:27.925 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:28.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:33.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:38.874 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:43.890 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:48.904 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:53.922 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:17:58.945 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:04.022 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 46/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:09.065 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:14.091 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:19.111 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:24.167 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:29.268 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:34.282 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:39.306 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:44.329 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:49.351 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:54.375 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:18:59.390 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:04.403 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:09.438 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:14.452 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:19.479 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:24.493 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:29.515 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:34.537 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:39.551 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:44.564 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:49.576 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:54.588 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:19:59.612 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:04.643 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:09.678 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:14.707 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:19.724 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:24.747 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:29.770 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:34.799 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:39.820 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:44.836 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:49.876 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:54.905 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:20:59.926 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:04.980 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:10.025 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:15.053 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:20.070 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:25.087 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:30.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:35.119 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:40.135 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:45.150 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:50.203 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:50.931 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7470588235294118 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:50.933 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7470588235294118 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:50.935 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:52.950 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8171428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:52.950 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:53.083 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8171428571428572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:53.508 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714756910935, cpuUsage=0.7374631268436579, jvmMemoryUsage=0.03435719807942708, memoryUsage=0.5234745718732235, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:53.512 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:53.952 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7522658610271903 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:53.953 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:54.100 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7522658610271903 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:54.973 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:21:55.273 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:55.976 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:56.978 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:57.983 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:21:59.005 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:22:00.007 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:00.293 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:22:01.009 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:22:02.012 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:22:03.014 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:03.520 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:05.312 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:10.338 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:15.352 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:20.378 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:25.388 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:30.408 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:35.428 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:40.443 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:45.483 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:50.503 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:22:55.544 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:00.594 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:05.637 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:10.664 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:15.679 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:20.702 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:25.725 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:30.740 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:35.825 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:40.851 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:45.904 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:47.865 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8377581120943953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:23:47.865 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:47.936 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8377581120943953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:50.996 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:56.018 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:57.901 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7877906976744186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:23:57.905 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:23:58.041 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7877906976744186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:01.111 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 15/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:01.915 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7934212634164575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:01.916 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:02.089 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7934212634164575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:02.917 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7175622752953261 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:02.917 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:03.105 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7175622752953261 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:03.731 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757042111, cpuUsage=0.7046153846153846, jvmMemoryUsage=0.03435719807942708, memoryUsage=0.5280825754236231, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:03.733 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:03.932 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:04.937 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:05.938 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:06.158 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:06.940 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:07.942 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7360703812316716 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:07.943 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:08.135 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7360703812316716 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:08.950 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:09.954 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7369942196531792 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:09.954 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:10.223 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7369942196531792 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:10.956 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8757396449704142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:10.956 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:11.282 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8757396449704142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:11.290 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:11.958 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8664688427299703 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:11.958 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:12.294 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8664688427299703 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:12.968 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8724035608308605 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:12.971 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:13.308 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8724035608308605 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:13.754 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757050230, cpuUsage=0.7888888888888889, jvmMemoryUsage=0.03435719807942708, memoryUsage=0.5310527742169725, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:13.801 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:13.973 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9090909090909091 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:13.973 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:14.314 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9090909090909091 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:14.974 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:15.976 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:16.347 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:16.978 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:17.979 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:18.981 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7950310559006212 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:18.981 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:19.329 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7950310559006212 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:19.982 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:20.983 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:21.404 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:21.995 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:24:22.998 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:23.830 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:26.421 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:31.438 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:33.286 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:33.340 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 01:24:33.340 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:24:33.340 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:24:33.340 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:33.341 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:6ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:36.453 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:41.470 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:46.490 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:51.518 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:24:56.550 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:01.593 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:06.609 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:11.660 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:16.680 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:21.711 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:26.740 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:31.761 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:36.781 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:41.808 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:46.855 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 31/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:51.906 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:25:56.918 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:01.961 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:06.975 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:12.010 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:17.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:22.048 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:27.062 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:32.077 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:37.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:42.147 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:42.688 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9464788732394366 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:42.694 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:43.129 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9464788732394366 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:43.699 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8938053097345133 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:43.699 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:44.085 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757202237, cpuUsage=0.8849557522123894, jvmMemoryUsage=0.03435719807942708, memoryUsage=0.5272118765003352, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:44.091 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:44.169 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8938053097345133 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:44.702 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:45.704 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7831416299639646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:45.704 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:46.220 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7831416299639646 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:46.708 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:47.336 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:47.719 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7767295597484277 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:47.719 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:48.390 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7767295597484277 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:48.726 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:49.737 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:50.747 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:51.756 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:52.365 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:52.763 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:26:53.764 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.155 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.790 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 10ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.822 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=881)
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.822 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=881)
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.823 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=881)
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.824 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=881)
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.826 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.826 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.827 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.829 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2712, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:54.832 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.832 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.832 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:54.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.833 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.839 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:54.844 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2712, processInstanceId=881, startTime=1714757214841, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.547 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.553 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.553 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.562 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2712, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.562 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.562 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:55.575 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.605 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2712, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.606 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:55.884 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=Sat May 04 01:26:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2712, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, processId=957, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.549 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=Sat May 04 01:26:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2712, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, processId=957, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.559 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2712, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.559 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2712, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:26:54 GMT+08:00 2024, endTime=Sat May 04 01:26:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2712, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2712.log, processId=957, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:56.560 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.623 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2712, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.623 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.623 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.624 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.624 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.633 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2712] - [INFO] 2024-05-04 01:26:56.635 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2713, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.639 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.639 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:56.641 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2713, taskName=switch, firstSubmitTime=1714757216633, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=3, appIds=null, processInstanceId=881, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2713'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504012656'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='881'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='"local_store"'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:56.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:26:54 GMT+08:00 2024
Submit Time:            Sat May 04 01:26:54 GMT+08:00 2024
Start Time:             Sat May 04 01:26:54 GMT+08:00 2024
End Time:               Sat May 04 01:26:55 GMT+08:00 2024

[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.651 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.652 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.652 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.652 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757216652
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.652 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 881_2713
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.655 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2713,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757216633,
  "startTime" : 1714757216652,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 3,
  "processInstanceId" : 881,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2713"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504012656"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "881"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "\"local_store\""
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "881_2713",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\\\"local_store\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.650 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.658 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.659 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.659 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:56.661 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2713, processInstanceId=881, startTime=1714757216652, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:56.661 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.662 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.663 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.664 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.664 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}] successfully
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.666 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.666 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:""local_store""
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.666 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""local_store"" == "local_storage" successfully
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.671 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""local_store"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^ in <eval> at line number 1 at column number 2
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.672 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.672 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.674 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:56 GMT+08:00 2024, endTime=Sat May 04 01:26:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.676 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.677 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:56.677 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:57.387 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.552 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:57.562 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=215), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2713] - [ERROR] 2024-05-04 01:26:57.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.564 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:56 GMT+08:00 2024, endTime=Sat May 04 01:26:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:57.573 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=216), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2713] - [WARN] 2024-05-04 01:26:57.574 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2713
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.575 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2713, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2713, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:56 GMT+08:00 2024, endTime=Sat May 04 01:26:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2713.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:57.575 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.586 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2713, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.586 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.586 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.586 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.587 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.591 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.592 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.592 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.594 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2713] - [INFO] 2024-05-04 01:26:57.596 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2714, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.602 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:57.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:57.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:57.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:57.603 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:26:56 GMT+08:00 2024
Submit Time:            Sat May 04 01:26:56 GMT+08:00 2024
Start Time:             Sat May 04 01:26:56 GMT+08:00 2024
End Time:               Sat May 04 01:26:56 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:26:57.605 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2714, taskName=switch, firstSubmitTime=1714757217595, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=3, appIds=null, processInstanceId=881, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2714'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504012657'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='881'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='"local_store"'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.606 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.611 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.613 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.613 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757217613
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.613 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 881_2714
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:57.614 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.614 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2714,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757217595,
  "startTime" : 1714757217613,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 3,
  "processInstanceId" : 881,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2714"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504012657"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "881"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "\"local_store\""
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "881_2714",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\\\"local_store\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.615 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:57.617 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2714, processInstanceId=881, startTime=1714757217613, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.618 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}] successfully
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.619 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:""local_store""
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""local_store"" == "local_storage" successfully
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""local_store"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^ in <eval> at line number 1 at column number 2
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.620 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.622 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:57 GMT+08:00 2024, endTime=Sat May 04 01:26:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.622 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.623 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:57.623 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.553 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.560 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.560 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:58.565 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=220), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2714] - [ERROR] 2024-05-04 01:26:58.566 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.566 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:57 GMT+08:00 2024, endTime=Sat May 04 01:26:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:58.571 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=221), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2714] - [WARN] 2024-05-04 01:26:58.572 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2714
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.572 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2714, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2714, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:57 GMT+08:00 2024, endTime=Sat May 04 01:26:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2714.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:58.572 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.627 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2714, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.627 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.627 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.628 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.628 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.630 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.631 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.631 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.633 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2714] - [INFO] 2024-05-04 01:26:58.635 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2715, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.644 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:58.645 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2715, taskName=switch, firstSubmitTime=1714757218633, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=3, appIds=null, processInstanceId=881, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2715'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504012658'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='881'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='"local_store"'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:58.644 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.646 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.645 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.648 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.656 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.656 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757218656
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:58.645 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.656 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 881_2715
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:58.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:58.657 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:26:57 GMT+08:00 2024
Submit Time:            Sat May 04 01:26:57 GMT+08:00 2024
Start Time:             Sat May 04 01:26:57 GMT+08:00 2024
End Time:               Sat May 04 01:26:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:26:58.657 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.660 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2715,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757218633,
  "startTime" : 1714757218656,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 3,
  "processInstanceId" : 881,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2715"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504012658"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "881"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "\"local_store\""
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "881_2715",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\\\"local_store\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.662 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.662 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.662 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:58.663 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2715, processInstanceId=881, startTime=1714757218656, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.665 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.665 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.665 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.666 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}] successfully
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.666 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.667 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.667 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.667 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:""local_store""
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.668 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""local_store"" == "local_storage" successfully
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.669 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""local_store"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^ in <eval> at line number 1 at column number 2
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.669 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.669 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.669 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.670 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.672 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:58 GMT+08:00 2024, endTime=Sat May 04 01:26:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.673 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.673 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:58.674 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.557 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:59.573 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=225), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2715] - [ERROR] 2024-05-04 01:26:59.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.575 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:58 GMT+08:00 2024, endTime=Sat May 04 01:26:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:26:59.580 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=226), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2715] - [WARN] 2024-05-04 01:26:59.581 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2715
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2715, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.582 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2715, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:58 GMT+08:00 2024, endTime=Sat May 04 01:26:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2715.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:59.582 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2715, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.628 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.629 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.630 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.630 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.631 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2715] - [INFO] 2024-05-04 01:26:59.632 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2716, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.640 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:59.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:59.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:59.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:26:59.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:26:58 GMT+08:00 2024
Submit Time:            Sat May 04 01:26:58 GMT+08:00 2024
Start Time:             Sat May 04 01:26:58 GMT+08:00 2024
End Time:               Sat May 04 01:26:58 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:26:59.643 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2716, taskName=switch, firstSubmitTime=1714757219631, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=3, appIds=null, processInstanceId=881, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2716'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504012659'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='881'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='"local_store"'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.644 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.644 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:59.647 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.651 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.653 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757219653
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 881_2716
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.653 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2716,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757219631,
  "startTime" : 1714757219653,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 3,
  "processInstanceId" : 881,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2716"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504012659"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "881"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "\"local_store\""
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "881_2716",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\\\"local_store\\\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:26:59.657 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2716, processInstanceId=881, startTime=1714757219653, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.660 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.660 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}] successfully
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.661 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:""local_store""
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.662 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""local_store"" == "local_storage" successfully
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.662 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""local_store"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^ in <eval> at line number 1 at column number 2
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:2 Expected ; but found local_store
""local_store"" == "local_storage"
  ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.663 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.663 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.663 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.663 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.663 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.664 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:59 GMT+08:00 2024, endTime=Sat May 04 01:26:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.666 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.666 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-881][TI-2716] - [INFO] 2024-05-04 01:26:59.666 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.560 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:27:00.571 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=230), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2716] - [ERROR] 2024-05-04 01:27:00.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:26:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:59 GMT+08:00 2024, endTime=Sat May 04 01:26:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:27:00.577 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=231), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-881][TI-2716] - [WARN] 2024-05-04 01:27:00.579 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2716
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.579 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2716, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2716, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:26:59 GMT+08:00 2024, endTime=Sat May 04 01:26:59 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2716.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.580 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2716, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:00.580 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.580 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.580 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.581 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.581 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.585 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.586 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:881, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2716] - [INFO] 2024-05-04 01:27:00.588 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2717, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:881, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-881][TI-0] - [INFO] 2024-05-04 01:27:00.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:26:59 GMT+08:00 2024
Submit Time:            Sat May 04 01:26:59 GMT+08:00 2024
Start Time:             Sat May 04 01:26:59 GMT+08:00 2024
End Time:               Sat May 04 01:26:59 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:27:00.599 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:00.603 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2717, processInstanceId=881, startTime=1714757220599, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.577 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2717, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.577 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.578 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.583 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:01.583 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.626 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=Sat May 04 01:27:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2717, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, processId=968, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2717, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:01.638 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:02.403 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.586 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=Sat May 04 01:27:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2717, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, processId=968, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.595 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=881, taskInstanceId=2717, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.596 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2717, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:27:00 GMT+08:00 2024, endTime=Sat May 04 01:27:01 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_3/881/2717, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/3/881/2717.log, processId=968, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"\"local_store\""}], cacheTaskInstanceId=0, processInstanceId=881)
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:02.596 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-881] persist events succeeded
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=881, taskInstanceId=2717, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.689 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.689 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.689 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.694 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.697 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.697 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-881][TI-2717] - [INFO] 2024-05-04 01:27:02.697 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-3-20240504012654804
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:27:00 GMT+08:00 2024
Submit Time:            Sat May 04 01:27:00 GMT+08:00 2024
Start Time:             Sat May 04 01:27:00 GMT+08:00 2024
End Time:               Sat May 04 01:27:01 GMT+08:00 2024

[WI-881][TI-null] - [INFO] 2024-05-04 01:27:02.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=881, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-881][TI-null] - [INFO] 2024-05-04 01:27:02.698 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-881][TI-null] - [INFO] 2024-05-04 01:27:02.699 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-3-20240504012654804
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:26:54 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:26:54 GMT+08:00 2024
End Time:                  Sat May 04 01:27:02 GMT+08:00 2024

[WI-881][TI-0] - [INFO] 2024-05-04 01:27:02.699 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:04.976 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7869318181818182 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:27:04.976 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:05.490 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7869318181818182 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:05.977 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7309941520467835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:27:05.977 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:06.565 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7309941520467835 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:06.978 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7940298507462686 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:27:06.980 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:07.455 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:07.568 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7940298507462686 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:12.518 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:17.543 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:22.582 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:27.615 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:32.691 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:37.739 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:42.765 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:47.778 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:52.791 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:54.689 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7299035369774919 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:27:54.693 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:54.951 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7299035369774919 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:57.718 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8242424242424242 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:27:57.718 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:57.807 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:27:57.984 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8242424242424242 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:02.830 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:07.846 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:12.928 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:17.980 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:23.009 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:23.801 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7005988023952097 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:23.802 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:24.205 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7005988023952097 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:24.420 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:24.803 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:25.853 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:26.880 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:27.882 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:28.033 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:28.884 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:29.885 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:30.887 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:31.888 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:32.894 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:33.048 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:28:33.895 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:34.429 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:38.067 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:43.116 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:48.132 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:53.147 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:28:58.163 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:03.175 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:08.195 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:13.249 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:18.275 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:23.295 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:28.307 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:33.345 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:38.381 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:43.436 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:48.457 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:53.468 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:29:58.480 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:03.498 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:08.515 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:13.547 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:18.560 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:23.576 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:28.595 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:33.605 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:38.618 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:43.633 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:48.664 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:53.700 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:54.909 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7371601208459215 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:30:54.909 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:55.011 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7371601208459215 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:30:58.755 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:03.873 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:08.940 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:13.959 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:18.990 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:21.151 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7448680351906158 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:21.152 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:21.163 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7448680351906158 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:24.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:29.117 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:34.214 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:39.236 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:43.469 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8163265306122449 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:43.479 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:43.487 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8163265306122449 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:44.285 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:44.491 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8713450292397661 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:44.492 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:44.505 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8713450292397661 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:44.879 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757503686, cpuUsage=0.7685459940652819, jvmMemoryUsage=0.03435945510864258, memoryUsage=0.5295116033207848, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:44.884 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:45.493 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7853107344632769 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:45.494 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:45.505 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7853107344632769 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:46.507 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7342465753424657 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:46.499 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7342465753424657 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:46.507 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:47.511 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:48.513 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:49.321 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:49.514 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:50.520 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:51.524 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:52.526 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:53.527 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:54.369 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:31:54.528 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:54.897 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:31:59.382 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:04.424 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:08.623 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7060606060606059 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:08.624 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:08.747 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7060606060606059 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:09.448 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:14.462 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:19.498 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 23/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:24.515 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:29.585 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:34.620 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:39.772 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:39.786 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7037037037037037 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:39.786 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:39.945 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7037037037037037 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:40.789 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774566473988439 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:40.789 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:41.030 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7774566473988439 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:42.792 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134502923976608 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:42.792 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:43.042 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7134502923976608 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:43.808 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7665706051873199 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:43.823 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:44.068 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7665706051873199 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:44.849 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7603833865814696 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:44.849 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:44.917 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:45.081 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7603833865814696 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:45.129 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757563194, cpuUsage=0.7617647058823529, jvmMemoryUsage=0.03435945510864258, memoryUsage=0.5237640757856025, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:45.189 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:45.850 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9662921348314606 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:45.850 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:46.082 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9662921348314606 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:46.851 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9208211143695014 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:46.852 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:47.083 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9208211143695014 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:47.853 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:48.854 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:49.856 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:49.971 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:50.858 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:51.859 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:52.861 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:53.883 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:32:54.895 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:54.986 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:32:55.200 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:00.004 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:04.921 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7183908045977011 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:04.930 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:05.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:05.186 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7183908045977011 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:05.233 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:05.938 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:06.941 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:07.957 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:08.958 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:09.961 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:10.151 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:10.962 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7874251497005988 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:10.962 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:11.221 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7874251497005988 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:11.964 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7422360248447205 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:11.964 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:12.273 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7422360248447205 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:12.965 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:13.967 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:14.968 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.757486157253599 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:14.969 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:15.187 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:15.248 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:15.306 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.757486157253599 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:18.007 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8444303776382203 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:18.012 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:18.348 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8444303776382203 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:19.013 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:19.014 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:19.379 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:20.022 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7453987730061349 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:20.026 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:20.280 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:20.384 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7453987730061349 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:21.030 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:21.052 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=882)
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.052 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=882)
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.052 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=882)
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.053 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=882)
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.060 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.060 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.062 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:882, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.065 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2718, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:882, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:21.088 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.088 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.088 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:21.088 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:21.088 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:21.099 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:21.108 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2718, processInstanceId=882, startTime=1714757601102, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.084 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.096 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.097 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.105 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=882, taskInstanceId=2718, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.105 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.106 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.119 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:22.119 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-882] persist events succeeded
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.130 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=Sat May 04 01:33:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2718, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, processId=1058, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=882, taskInstanceId=2718, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:22.142 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.088 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=Sat May 04 01:33:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2718, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, processId=1058, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.096 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=882, taskInstanceId=2718, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.096 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2718, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:21 GMT+08:00 2024, endTime=Sat May 04 01:33:22 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2718, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2718.log, processId=1058, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:23.096 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-882] persist events succeeded
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.183 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=882, taskInstanceId=2718, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.183 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.183 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.183 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.183 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.201 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.201 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.202 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.203 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:882, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-2718] - [INFO] 2024-05-04 01:33:23.205 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2719, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:882, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:23.210 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-4-20240504013321035
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:33:21 GMT+08:00 2024
Submit Time:            Sat May 04 01:33:21 GMT+08:00 2024
Start Time:             Sat May 04 01:33:21 GMT+08:00 2024
End Time:               Sat May 04 01:33:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:33:23.212 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2719, taskName=switch, firstSubmitTime=1714757603204, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=4, appIds=null, processInstanceId=882, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2719'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013323'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='882'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_store''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.214 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.214 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.222 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.224 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.224 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:23.221 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.224 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757603224
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.224 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 882_2719
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.225 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2719,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757603204,
  "startTime" : 1714757603224,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 4,
  "processInstanceId" : 882,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2719"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013323"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "882"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_store'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "882_2719",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_store'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.226 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.226 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.226 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:23.230 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2719, processInstanceId=882, startTime=1714757603224, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.242 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.244 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.244 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.244 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}] successfully
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.244 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.245 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.245 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.245 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.245 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_store'"
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.245 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"'local_store'" == "local_storage" successfully
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.255 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "'local_store'" == "local_storage" successfully: false
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.256 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.256 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.256 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.256 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.258 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:23 GMT+08:00 2024, endTime=Sat May 04 01:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.260 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.260 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:23.261 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.096 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.101 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.102 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:33:24.112 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=243), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-882][TI-2719] - [ERROR] 2024-05-04 01:33:24.114 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.115 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:23 GMT+08:00 2024, endTime=Sat May 04 01:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:33:24.122 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=244), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 120, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-882][TI-2719] - [WARN] 2024-05-04 01:33:24.125 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2719
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.125 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=882, taskInstanceId=2719, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.125 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2719, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:23 GMT+08:00 2024, endTime=Sat May 04 01:33:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2719.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:24.125 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-882] persist events succeeded
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.205 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=882, taskInstanceId=2719, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.205 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.206 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.206 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.206 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.265 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.266 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.267 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.284 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:882, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-2719] - [INFO] 2024-05-04 01:33:24.289 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2720, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:882, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:24.312 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.312 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.313 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.313 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.313 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.313 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-882][TI-0] - [INFO] 2024-05-04 01:33:24.313 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-4-20240504013321035
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:33:23 GMT+08:00 2024
Submit Time:            Sat May 04 01:33:23 GMT+08:00 2024
Start Time:             Sat May 04 01:33:23 GMT+08:00 2024
End Time:               Sat May 04 01:33:23 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:33:24.370 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:24.382 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2720, processInstanceId=882, startTime=1714757604361, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:25.094 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8219584569732937 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:25.095 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.097 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.107 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.109 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.128 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=882, taskInstanceId=2720, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.129 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.130 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.139 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:25.139 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-882] persist events succeeded
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.224 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=882, taskInstanceId=2720, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.224 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:25.255 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757604778, cpuUsage=0.911504424778761, jvmMemoryUsage=0.03435945510864258, memoryUsage=0.5235207016175037, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=1)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:25.329 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:25.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8219584569732937 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:25.440 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=Sat May 04 01:33:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2720, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, processId=1069, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.102 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=Sat May 04 01:33:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2720, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, processId=1069, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.151 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=882, taskInstanceId=2720, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.152 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2720, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:33:24 GMT+08:00 2024, endTime=Sat May 04 01:33:25 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_4/882/2720, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/4/882/2720.log, processId=1069, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_store'"}], cacheTaskInstanceId=0, processInstanceId=882)
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:26.152 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-882] persist events succeeded
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=882, taskInstanceId=2720, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.242 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.242 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.242 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.242 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.251 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.252 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.257 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.257 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-882][TI-2720] - [INFO] 2024-05-04 01:33:26.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-4-20240504013321035
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:33:24 GMT+08:00 2024
Submit Time:            Sat May 04 01:33:24 GMT+08:00 2024
Start Time:             Sat May 04 01:33:24 GMT+08:00 2024
End Time:               Sat May 04 01:33:25 GMT+08:00 2024

[WI-882][TI-null] - [INFO] 2024-05-04 01:33:26.258 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=882, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-882][TI-null] - [INFO] 2024-05-04 01:33:26.258 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-882][TI-null] - [INFO] 2024-05-04 01:33:26.261 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-4-20240504013321035
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:33:21 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:33:21 GMT+08:00 2024
End Time:                  Sat May 04 01:33:26 GMT+08:00 2024

[WI-882][TI-0] - [INFO] 2024-05-04 01:33:26.261 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:27.126 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7781065088757397 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:27.127 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:27.470 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7781065088757397 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:28.128 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8271604938271604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:28.128 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:28.546 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8271604938271604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:29.129 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7383720930232558 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:29.130 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:29.551 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7383720930232558 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:30.348 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:31.142 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.728613569321534 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:31.143 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:31.603 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.728613569321534 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:32.153 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7301587301587301 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:32.157 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:32.637 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7301587301587301 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:35.367 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:38.209 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194029850746269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:38.209 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:38.661 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7194029850746269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:40.217 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8170731707317074 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:40.221 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:40.421 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:40.695 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8170731707317074 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:41.226 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7188405797101449 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:41.228 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:41.711 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7188405797101449 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:43.233 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7594202898550724 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:43.234 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:43.787 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7594202898550724 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:45.470 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:48.363 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8742690058479533 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:33:48.364 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:48.851 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8742690058479533 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:50.486 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:33:55.515 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:00.535 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:05.565 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:09.936 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7406250000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:09.939 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7406250000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:09.940 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:10.619 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:13.958 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7463556851311953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:13.958 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:13.983 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7463556851311953 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:14.960 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7923976608187134 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:14.966 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:15.024 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7923976608187134 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:15.339 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757654385, cpuUsage=0.7559523809523809, jvmMemoryUsage=0.03435945510864258, memoryUsage=0.5336789882792671, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:15.368 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:15.737 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 59/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:15.977 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8530259365994236 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:15.979 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:16.035 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8530259365994236 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:16.980 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:17.982 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7869822485207101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:17.983 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:18.083 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7869822485207101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:18.989 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:20.002 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:20.784 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:21.006 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8984615384615385 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:21.006 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:21.120 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8984615384615385 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:22.007 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:23.032 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:24.034 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:25.038 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:25.449 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:25.872 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:26.043 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9382352941176471 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:26.044 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:26.182 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9382352941176471 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:27.045 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.829059829059829 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:27.045 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:27.228 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.829059829059829 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.049 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.126 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=883)
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.126 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=883)
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.127 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=883)
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.127 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=883)
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.129 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.129 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.129 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.133 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.134 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.137 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.139 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2721, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.147 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.148 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.148 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:28.148 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.149 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.157 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.181 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2721, processInstanceId=883, startTime=1714757668166, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.297 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.303 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.304 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.318 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2721, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.318 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.319 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.331 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:28.331 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.417 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2721, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:28.418 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.216 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2721, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, processId=1091, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.321 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2721, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, processId=1091, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.330 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2721, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.330 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2721, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:28 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2721, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2721.log, processId=1091, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:29.330 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.347 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2721, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.347 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.348 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.348 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.360 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.361 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2721] - [INFO] 2024-05-04 01:34:29.362 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2722, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.367 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.370 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:29.370 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:28 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:28 GMT+08:00 2024
Start Time:             Sat May 04 01:34:28 GMT+08:00 2024
End Time:               Sat May 04 01:34:29 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:34:29.373 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2722, taskName=check file existence , firstSubmitTime=1714757669361, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=27, appIds=null, processInstanceId=883, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir}=null","nextNode":13475238524224}],"nextNode":13475238524227}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2722'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013429'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='883'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.374 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.375 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.383 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.383 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.383 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.383 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757669383
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.384 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 883_2722
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.384 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2722,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714757669361,
  "startTime" : 1714757669383,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 27,
  "processInstanceId" : 883,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir}=null\",\"nextNode\":13475238524224}],\"nextNode\":13475238524227}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2722"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013429"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "883"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "883_2722",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.384 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.385 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.385 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:29.386 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:29.387 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2722, processInstanceId=883, startTime=1714757669383, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.389 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524227 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir}=null",
    "nextNode" : [ 13475238524224 ]
  } ]
}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir}=null 
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.390 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-883][TI-2722] - [ERROR] 2024-05-04 01:34:29.391 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.391 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2722] - [ERROR] 2024-05-04 01:34:29.391 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2722] - [WARN] 2024-05-04 01:34:29.391 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.398 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:29 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.400 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.404 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.410 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:29.411 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.322 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.329 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.329 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:30.346 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=256), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2722] - [ERROR] 2024-05-04 01:34:30.351 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.351 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:29 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:30.358 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=257), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2722] - [WARN] 2024-05-04 01:34:30.359 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2722
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.359 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2722, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.360 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2722, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:29 GMT+08:00 2024, endTime=Sat May 04 01:34:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2722.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:30.360 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2722, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.461 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.461 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.462 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.464 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.464 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.465 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.465 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.465 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.470 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2722] - [INFO] 2024-05-04 01:34:30.472 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2723, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.482 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:30.483 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:30.483 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:30.483 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:30.484 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2723, taskName=check file existence , firstSubmitTime=1714757670470, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=27, appIds=null, processInstanceId=883, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir}=null","nextNode":13475238524224}],"nextNode":13475238524227}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2723'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013430'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='883'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.485 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.485 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:30.487 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.534 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:30.483 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:29 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:29 GMT+08:00 2024
Start Time:             Sat May 04 01:34:29 GMT+08:00 2024
End Time:               Sat May 04 01:34:29 GMT+08:00 2024

[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.541 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.541 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.541 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757670541
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.541 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 883_2723
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.542 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2723,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714757670470,
  "startTime" : 1714757670541,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 27,
  "processInstanceId" : 883,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir}=null\",\"nextNode\":13475238524224}],\"nextNode\":13475238524227}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2723"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013430"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "883"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "883_2723",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.544 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.544 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:30.545 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2723, processInstanceId=883, startTime=1714757670541, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.546 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.547 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524227 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir}=null",
    "nextNode" : [ 13475238524224 ]
  } ]
}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.547 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.548 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.549 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.550 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir}=null 
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.550 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-883][TI-2723] - [ERROR] 2024-05-04 01:34:30.551 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.551 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.551 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.551 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2723] - [ERROR] 2024-05-04 01:34:30.551 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2723] - [WARN] 2024-05-04 01:34:30.552 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.570 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:30 GMT+08:00 2024, endTime=Sat May 04 01:34:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.573 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.574 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.574 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:30.574 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:30.973 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.324 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.329 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.330 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:31.334 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=261), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2723] - [ERROR] 2024-05-04 01:34:31.336 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.337 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:30 GMT+08:00 2024, endTime=Sat May 04 01:34:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:31.340 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=262), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2723] - [WARN] 2024-05-04 01:34:31.341 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2723
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.341 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2723, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.341 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2723, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:30 GMT+08:00 2024, endTime=Sat May 04 01:34:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2723.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:31.342 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.376 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2723, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.376 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.377 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.379 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2723] - [INFO] 2024-05-04 01:34:31.381 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2724, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.402 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:31.403 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2724, taskName=check file existence , firstSubmitTime=1714757671379, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=27, appIds=null, processInstanceId=883, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir}=null","nextNode":13475238524224}],"nextNode":13475238524227}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2724'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013431'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='883'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.404 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.405 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.411 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:31.403 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757671412
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 883_2724
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:30 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:30 GMT+08:00 2024
Start Time:             Sat May 04 01:34:30 GMT+08:00 2024
End Time:               Sat May 04 01:34:30 GMT+08:00 2024

[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2724,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714757671379,
  "startTime" : 1714757671412,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 27,
  "processInstanceId" : 883,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir}=null\",\"nextNode\":13475238524224}],\"nextNode\":13475238524227}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2724"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013431"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "883"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "883_2724",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.412 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:31.415 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:31.416 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2724, processInstanceId=883, startTime=1714757671412, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.417 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.418 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524227 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir}=null",
    "nextNode" : [ 13475238524224 ]
  } ]
}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.418 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.418 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.419 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.420 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.420 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir}=null 
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.420 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-883][TI-2724] - [ERROR] 2024-05-04 01:34:31.421 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.421 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.421 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.421 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2724] - [ERROR] 2024-05-04 01:34:31.421 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2724] - [WARN] 2024-05-04 01:34:31.421 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.422 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:31 GMT+08:00 2024, endTime=Sat May 04 01:34:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.424 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.424 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.424 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:31.424 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.332 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.340 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.340 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:32.363 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=266), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2724] - [ERROR] 2024-05-04 01:34:32.366 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.366 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:31 GMT+08:00 2024, endTime=Sat May 04 01:34:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:32.372 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=267), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2724] - [WARN] 2024-05-04 01:34:32.373 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2724
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.374 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2724, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.375 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2724, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:31 GMT+08:00 2024, endTime=Sat May 04 01:34:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2724.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:32.375 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.387 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2724, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.393 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.394 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.395 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.396 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.397 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence , task id:null, task code:13481487039552
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.399 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481487039552, dependTaskCodes: [13475238524226]
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.400 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence  is success, so ready to submit to execute
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.403 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence , processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2724] - [INFO] 2024-05-04 01:34:32.407 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2725, taskInstanceName: check file existence , taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.419 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:32.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:32.420 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:32.421 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:32.421 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:31 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:31 GMT+08:00 2024
Start Time:             Sat May 04 01:34:31 GMT+08:00 2024
End Time:               Sat May 04 01:34:31 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:34:32.423 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2725, taskName=check file existence , firstSubmitTime=1714757672404, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=27, appIds=null, processInstanceId=883, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir}=null","nextNode":13475238524224}],"nextNode":13475238524227}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence '}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2725'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481487039552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013432'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='883'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.427 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence  to MasterTaskExecutorThreadPool success
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.428 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.433 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.434 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.434 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.434 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757672434
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.437 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 883_2725
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.440 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2725,
  "taskName" : "check file existence ",
  "firstSubmitTime" : 1714757672404,
  "startTime" : 1714757672434,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 27,
  "processInstanceId" : 883,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir}=null\",\"nextNode\":13475238524224}],\"nextNode\":13475238524227}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence "
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2725"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481487039552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013432"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "883"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "883_2725",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.441 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.441 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.441 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:32.437 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence  to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:32.454 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2725, processInstanceId=883, startTime=1714757672434, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.457 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.458 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524227 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir}=null",
    "nextNode" : [ 13475238524224 ]
  } ]
}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.458 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.458 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.459 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.460 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.460 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.460 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir}=null 
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.461 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-883][TI-2725] - [ERROR] 2024-05-04 01:34:32.462 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.462 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.463 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-883][TI-2725] - [ERROR] 2024-05-04 01:34:32.463 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir}=null
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2725] - [WARN] 2024-05-04 01:34:32.463 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.465 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:32 GMT+08:00 2024, endTime=Sat May 04 01:34:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.480 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.481 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.481 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:32.481 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.176 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7977207977207977 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:33.177 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.266 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7977207977207977 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.334 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.349 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.350 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:33.354 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=271), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2725] - [ERROR] 2024-05-04 01:34:33.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.357 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:32 GMT+08:00 2024, endTime=Sat May 04 01:34:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:34:33.367 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=272), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-883][TI-2725] - [WARN] 2024-05-04 01:34:33.371 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2725
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.371 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2725, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.372 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2725, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:34:32 GMT+08:00 2024, endTime=Sat May 04 01:34:32 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2725.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.372 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.386 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.400 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2725, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.404 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.404 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.404 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.404 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.411 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:end workflow, task id:null, task code:13475238524224
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524224, dependTaskCodes: [13481487039552, 13475238524226]
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task end workflow is success, so ready to submit to execute
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.417 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : end workflow, processInstance id:883, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2725] - [INFO] 2024-05-04 01:34:33.420 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2726, taskInstanceName: end workflow, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:883, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:33.439 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.440 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.440 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.440 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481487039552 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.440 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.440 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.441 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence 
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:32 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:32 GMT+08:00 2024
Start Time:             Sat May 04 01:34:32 GMT+08:00 2024
End Time:               Sat May 04 01:34:32 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.447 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task end workflow to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.463 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2726, processInstanceId=883, startTime=1714757673449, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.490 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 5 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511, 883]
[WI-448][TI-0] - [INFO] 2024-05-04 01:34:33.496 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:34:33.497 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:34:33.497 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-883][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[184] - The workflowInstance is newly created, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:33.498 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:45ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:34.179 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9124293785310734 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:34.179 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.345 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:34.351 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9124293785310734 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.355 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.378 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2726, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.378 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.378 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.386 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:34.386 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.439 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2726, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.440 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:34.521 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=Sat May 04 01:34:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2726, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, processId=1105, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:35.180 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8096590909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:35.181 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.346 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=Sat May 04 01:34:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2726, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, processId=1105, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:35.354 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8096590909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.397 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=883, taskInstanceId=2726, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.397 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2726, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:34:33 GMT+08:00 2024, endTime=Sat May 04 01:34:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_27/883/2726, logPath=/opt/dolphinscheduler/logs/20240504/13475238524230/27/883/2726.log, processId=1105, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=883)
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:35.399 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-883] persist events succeeded
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=883, taskInstanceId=2726, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.459 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524224 state:TaskExecutionStatus{code=7, desc='success'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.459 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.459 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524224 state:TaskExecutionStatus{code=7, desc='success'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.480 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-883][TI-2726] - [INFO] 2024-05-04 01:34:35.480 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              end workflow
Workflow Instance Name: preprocess_gnews_article-27-20240504013428051
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:34:33 GMT+08:00 2024
Submit Time:            Sat May 04 01:34:33 GMT+08:00 2024
Start Time:             Sat May 04 01:34:33 GMT+08:00 2024
End Time:               Sat May 04 01:34:34 GMT+08:00 2024

[WI-883][TI-null] - [INFO] 2024-05-04 01:34:35.481 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=883, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-883][TI-null] - [INFO] 2024-05-04 01:34:35.481 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-883][TI-null] - [INFO] 2024-05-04 01:34:35.486 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-27-20240504013428051
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:34:28 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:34:28 GMT+08:00 2024
End Time:                  Sat May 04 01:34:35 GMT+08:00 2024

[WI-883][TI-0] - [INFO] 2024-05-04 01:34:35.488 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:35.497 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757673637, cpuUsage=0.8142857142857143, jvmMemoryUsage=0.034361712137858075, memoryUsage=0.5380969054696157, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=1)
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:35.508 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:36.052 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:36.183 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8871473354231976 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:36.184 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:36.375 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8871473354231976 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:37.184 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7275641025641025 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:37.185 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:37.381 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7275641025641025 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:38.190 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8352435054149226 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:38.190 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:38.382 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8352435054149226 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:39.192 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:40.194 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:41.152 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:41.196 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:42.198 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8761329305135951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:42.198 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:42.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8761329305135951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:43.199 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7755681818181818 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:43.200 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:43.426 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7755681818181818 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:44.206 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8092307692307692 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:44.207 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:44.429 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8092307692307692 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:45.209 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:45.538 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:46.209 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:47.214 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7891373801916933 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:47.214 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:47.450 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7891373801916933 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:51.302 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 69/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:56.439 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 25/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:58.373 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8051948051948051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:34:58.373 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:34:58.517 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8051948051948051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:01.460 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:06.519 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:11.547 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:13.478 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7106741573033707 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:35:13.478 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:13.680 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7106741573033707 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:16.659 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:21.681 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:26.701 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:31.722 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:36.780 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:39.812 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7596439169139466 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:35:39.812 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:40.085 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7596439169139466 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:41.825 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:45.825 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230769230769231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:35:45.830 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:46.110 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7230769230769231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:46.898 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 30/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:48.841 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8110749185667753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:35:48.841 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:49.185 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8110749185667753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:51.942 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:35:56.961 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:01.973 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:06.988 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:12.100 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:17.152 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:18.983 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7897539330375151 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:18.989 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:19.354 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7897539330375151 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:21.017 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7878787878787878 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:21.017 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:21.382 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7878787878787878 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:22.165 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:25.051 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8076923076923077 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:25.052 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:25.438 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8076923076923077 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:25.832 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757784969, cpuUsage=0.7634730538922155, jvmMemoryUsage=0.034361712137858075, memoryUsage=0.5392921032837021, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:25.838 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:26.064 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8427672955974843 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:26.065 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:26.455 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8427672955974843 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:27.074 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7803468208092486 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:27.074 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:27.213 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:27.457 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7803468208092486 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:28.083 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7042682926829269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:28.083 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:28.460 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7042682926829269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:29.085 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:30.086 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8035714285714286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:30.086 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:30.481 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8035714285714286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:31.097 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:32.100 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:32.230 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:33.256 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:34.272 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:35.275 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:35.863 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:37.277 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:37.280 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8643067846607669 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:37.280 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:37.515 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8643067846607669 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:38.305 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7804154302670623 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:38.332 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:38.526 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7804154302670623 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:39.388 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7777469990766389 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:39.388 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:39.532 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7777469990766389 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:40.392 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7073263966584621 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:40.402 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:40.537 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7073263966584621 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:42.323 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:42.478 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7934131736526946 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:42.478 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:42.570 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7934131736526946 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:43.480 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8226744186046512 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:43.480 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:43.594 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8226744186046512 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:44.482 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7428571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:44.482 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:44.598 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7428571428571429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:45.486 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7669902912621359 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:45.486 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:45.606 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7669902912621359 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:45.897 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757802395, cpuUsage=0.7272727272727273, jvmMemoryUsage=0.034361712137858075, memoryUsage=0.5419982490580684, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:45.907 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:46.487 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7120253164556962 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:46.487 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:46.606 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7120253164556962 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:47.393 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:47.488 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8939828080229226 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:47.488 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:47.608 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8939828080229226 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:48.490 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:48.491 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:48.608 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:49.492 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:50.493 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:51.495 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:52.419 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:52.496 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:53.500 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:54.501 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:36:55.505 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:55.919 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:36:57.480 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:02.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:04.748 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.2380952380952381 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:07.540 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:08.781 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7621951219512195 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:08.772 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7621951219512195 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:08.782 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:12.935 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:18.015 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:23.032 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:28.068 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:30.037 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8338762214983714 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:30.061 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8338762214983714 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:30.063 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:31.066 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7222222222222221 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:31.073 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:31.074 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7222222222222221 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:32.075 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7682926829268293 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:32.076 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:33.098 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:35.085 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8924418604651163 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:35.086 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:35.093 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8924418604651163 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:35.981 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714757854963, cpuUsage=0.8761061946902655, jvmMemoryUsage=0.034361712137858075, memoryUsage=0.546844258228741, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:35.988 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:36.094 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:37.096 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:38.097 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7395209580838323 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:38.097 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:38.129 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7395209580838323 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:38.146 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:39.099 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:40.106 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8805031446540881 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:40.107 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:40.165 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8805031446540881 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:41.152 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:42.158 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:43.166 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:43.171 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:44.169 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:45.171 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:46.000 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:46.174 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7264437689969604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:46.174 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:46.234 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7264437689969604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:47.175 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7201166180758017 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:47.176 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:47.261 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7201166180758017 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.186 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 9ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.196 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.221 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.221 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.221 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.222 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.235 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.236 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.238 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.242 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2727, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.252 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:48.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.253 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.263 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.298 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2727, processInstanceId=884, startTime=1714757868282, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.724 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.732 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.732 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.745 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2727, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.746 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.764 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:48.765 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2727, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:48.804 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:49.224 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7381615598885793 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:49.224 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:49.339 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7381615598885793 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.453 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=Sat May 04 01:37:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2727, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, processId=1158, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.734 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=Sat May 04 01:37:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2727, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, processId=1158, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.798 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2727, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.798 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2727, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:48 GMT+08:00 2024, endTime=Sat May 04 01:37:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2727, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2727.log, processId=1158, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:49.798 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2727, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.837 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.837 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.837 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.895 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.895 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.896 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.898 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2727] - [INFO] 2024-05-04 01:37:49.901 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2728, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:49.907 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.907 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.907 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.908 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.908 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.908 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:49.915 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2728, taskName=switch, firstSubmitTime=1714757869898, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=5, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2728'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504013749'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='local_storage'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:49.918 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:49.936 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714757870002
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2728
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:49.996 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:49.922 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:37:48 GMT+08:00 2024
Submit Time:            Sat May 04 01:37:48 GMT+08:00 2024
Start Time:             Sat May 04 01:37:48 GMT+08:00 2024
End Time:               Sat May 04 01:37:49 GMT+08:00 2024

[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.002 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2728,
  "taskName" : "switch",
  "firstSubmitTime" : 1714757869898,
  "startTime" : 1714757870002,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 5,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2728"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504013749"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "local_storage"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2728",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"local_storage\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.008 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.008 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.008 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.041 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2728, processInstanceId=884, startTime=1714757870002, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.045 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.046 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.046 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}] successfully
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"local_storage"
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.047 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"local_storage" == "local_storage" successfully
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.050 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "local_storage" == "local_storage" successfully: true
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.050 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:0
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.050 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.050 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.051 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.051 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.085 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.100 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.100 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.100 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.228 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0357142857142856 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:50.228 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.408 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0357142857142856 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.734 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.740 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.741 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:37:50.746 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=284), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2728] - [ERROR] 2024-05-04 01:37:50.753 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.753 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:37:50.758 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=285), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2728] - [WARN] 2024-05-04 01:37:50.759 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2728
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.759 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2728, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.759 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2728, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2728.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.760 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2728, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.800 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.800 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.800 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.809 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.812 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2728] - [INFO] 2024-05-04 01:37:50.817 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2729, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:50.821 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.822 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.822 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.823 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.823 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.823 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:37:50.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:37:49 GMT+08:00 2024
Submit Time:            Sat May 04 01:37:49 GMT+08:00 2024
Start Time:             Sat May 04 01:37:50 GMT+08:00 2024
End Time:               Sat May 04 01:37:50 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.835 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2729, processInstanceId=884, startTime=1714757870832, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:50.840 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.737 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2729, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [WARN] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.752 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:51.752 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.833 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2729, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.833 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:51.903 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2729, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, processId=1169, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.743 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2729, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, processId=1169, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.759 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2729, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.760 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2729, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:37:50 GMT+08:00 2024, endTime=Sat May 04 01:37:51 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_5/884/2729, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/5/884/2729.log, processId=1169, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"local_storage"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:52.760 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.851 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2729, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.855 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.858 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.859 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.859 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.875 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.875 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.884 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2729] - [INFO] 2024-05-04 01:37:52.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:37:50 GMT+08:00 2024
Submit Time:            Sat May 04 01:37:50 GMT+08:00 2024
Start Time:             Sat May 04 01:37:50 GMT+08:00 2024
End Time:               Sat May 04 01:37:51 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:37:52.885 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:37:52.886 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:37:52.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              START_PROCESS
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:37:48 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:37:48 GMT+08:00 2024
End Time:                  Sat May 04 01:37:52 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:37:52.889 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:53.239 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:53.246 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7111801242236024 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:53.246 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:53.419 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7111801242236024 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:54.247 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7317073170731708 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:37:54.248 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:54.432 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7317073170731708 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:37:58.261 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:01.269 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.770392749244713 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:38:01.270 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:01.525 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.770392749244713 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:02.271 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7057057057057057 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:38:02.271 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:02.551 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7057057057057057 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:03.276 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:08.304 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:13.469 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:18.582 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:23.609 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:28.628 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:33.644 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:38.659 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:43.672 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:48.710 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:53.727 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:38:58.740 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:03.756 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:08.800 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:13.841 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:18.890 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:23.912 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:28.927 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:33.971 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:38.991 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:44.001 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:49.014 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:54.040 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:39:59.049 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:04.064 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:09.093 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:14.105 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:19.117 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:24.130 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:29.156 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:31.478 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.764872521246459 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:40:31.485 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:31.589 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.764872521246459 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:34.174 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:39.281 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 86/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:44.397 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:49.414 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:54.490 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:40:59.512 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:04.530 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:05.668 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8141592920353983 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:05.669 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:05.802 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8141592920353983 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:06.390 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758065776, cpuUsage=0.8071041551779979, jvmMemoryUsage=0.034363969167073564, memoryUsage=0.5465372568271525, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:06.426 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:06.673 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7003058103975535 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:06.674 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:06.861 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7003058103975535 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:07.674 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7146892655367231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:07.675 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:07.867 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7146892655367231 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:08.675 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:09.615 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:09.678 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8686567164179104 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:09.683 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:09.882 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8686567164179104 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:10.684 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:10.684 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:10.932 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8029411764705883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:11.685 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:12.689 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:13.696 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8035714285714286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:13.696 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:13.997 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8035714285714286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:14.664 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:14.706 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7053571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:14.706 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:15.047 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7053571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:15.707 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7560975609756098 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:15.707 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:16.048 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7560975609756098 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:16.466 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:16.708 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:17.711 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:18.716 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:19.687 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:19.720 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7129727368689258 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:19.725 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:20.062 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7129727368689258 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:20.770 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:21.778 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:22.784 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7970149253731343 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:22.788 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:23.115 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7970149253731343 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:23.793 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8455056179775281 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:23.793 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:24.182 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8455056179775281 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:24.746 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:24.795 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:25.797 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.479 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.800 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.904 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.904 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.904 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.904 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.910 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.910 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.916 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.918 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.924 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.926 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.928 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.930 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2730, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:26.938 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.939 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.940 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:26.941 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.941 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.951 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:26.964 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2730, processInstanceId=884, startTime=1714758086953, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.630 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.636 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.636 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.645 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2730, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.645 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.646 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.653 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:27.654 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.724 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2730, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:27.725 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.085 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2730, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, processId=1220, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.631 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2730, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, processId=1220, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.640 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2730, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.640 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2730, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:26 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2730, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2730.log, processId=1220, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:28.640 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.740 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2730, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.741 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.741 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.741 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.741 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.777 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2730] - [INFO] 2024-05-04 01:41:28.779 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2731, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.807 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.807 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:26 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:26 GMT+08:00 2024
Start Time:             Sat May 04 01:41:26 GMT+08:00 2024
End Time:               Sat May 04 01:41:28 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:41:28.815 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2731, taskName=switch, firstSubmitTime=1714758088777, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=6, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2731'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014128'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.827 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.839 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:28.854 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.896 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.896 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.896 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.896 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758088896
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.896 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2731
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.897 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2731,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758088777,
  "startTime" : 1714758088896,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 6,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2731"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014128"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2731",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:28.902 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2731, processInstanceId=884, startTime=1714758088896, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.906 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.908 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2731] - [ERROR] 2024-05-04 01:41:28.909 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.909 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.909 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.909 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2731] - [ERROR] 2024-05-04 01:41:28.909 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2731] - [WARN] 2024-05-04 01:41:28.909 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.915 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:28 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.923 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.926 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.927 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:28.927 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:28.943 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7732919254658386 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:28.943 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.207 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7732919254658386 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.656 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.662 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.663 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:29.673 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=297), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2731] - [ERROR] 2024-05-04 01:41:29.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.677 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:28 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:29.685 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=298), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2731] - [WARN] 2024-05-04 01:41:29.687 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2731
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.687 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2731, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.687 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2731, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:28 GMT+08:00 2024, endTime=Sat May 04 01:41:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2731.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.688 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2731, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.757 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.757 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.758 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.761 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.762 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.762 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.765 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2731] - [INFO] 2024-05-04 01:41:29.770 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2732, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.813 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 48/ms
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.832 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:29.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:29.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:29.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:29.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:28 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:28 GMT+08:00 2024
Start Time:             Sat May 04 01:41:28 GMT+08:00 2024
End Time:               Sat May 04 01:41:28 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.839 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2732, taskName=switch, firstSubmitTime=1714758089765, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=6, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2732'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014129'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.840 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.840 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.850 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758089851
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2732
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2732,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758089765,
  "startTime" : 1714758089851,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 6,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2732"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014129"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2732",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.857 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.857 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.856 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:29.858 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2732, processInstanceId=884, startTime=1714758089851, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.860 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.860 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.860 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.860 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2732] - [ERROR] 2024-05-04 01:41:29.861 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.861 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2732] - [ERROR] 2024-05-04 01:41:29.861 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2732] - [WARN] 2024-05-04 01:41:29.866 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.873 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:29 GMT+08:00 2024, endTime=Sat May 04 01:41:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.888 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.889 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:29.890 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.667 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.675 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:30.707 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=302), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2732] - [ERROR] 2024-05-04 01:41:30.708 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.709 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:29 GMT+08:00 2024, endTime=Sat May 04 01:41:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:30.715 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=303), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2732] - [WARN] 2024-05-04 01:41:30.718 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2732
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.718 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2732, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.719 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2732, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:29 GMT+08:00 2024, endTime=Sat May 04 01:41:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2732.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:30.719 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2732, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.803 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.803 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.804 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.804 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.804 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.811 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.811 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.813 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2732] - [INFO] 2024-05-04 01:41:30.816 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2733, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.836 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:30.843 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:30.846 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:30.846 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:30.846 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:29 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:29 GMT+08:00 2024
Start Time:             Sat May 04 01:41:29 GMT+08:00 2024
End Time:               Sat May 04 01:41:29 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:41:30.843 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2733, taskName=switch, firstSubmitTime=1714758090814, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=6, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2733'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014130'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.848 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.848 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.857 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.862 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:30.862 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.862 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758090863
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2733
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.865 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2733,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758090814,
  "startTime" : 1714758090863,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 6,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2733"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014130"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2733",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.865 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.866 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.866 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:30.868 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2733, processInstanceId=884, startTime=1714758090863, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.870 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.871 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.871 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.872 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.872 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.872 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.873 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2733] - [ERROR] 2024-05-04 01:41:30.873 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.873 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.873 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.873 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2733] - [ERROR] 2024-05-04 01:41:30.873 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2733] - [WARN] 2024-05-04 01:41:30.874 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.875 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:30 GMT+08:00 2024, endTime=Sat May 04 01:41:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.880 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.881 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.881 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:30.881 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.670 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:31.705 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=307), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2733] - [ERROR] 2024-05-04 01:41:31.707 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.708 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:30 GMT+08:00 2024, endTime=Sat May 04 01:41:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:31.714 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=308), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2733] - [WARN] 2024-05-04 01:41:31.716 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2733
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.716 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2733, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2733, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:30 GMT+08:00 2024, endTime=Sat May 04 01:41:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2733.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:31.716 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2733, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.717 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.718 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.718 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.718 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.718 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.719 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.722 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2733] - [INFO] 2024-05-04 01:41:31.735 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2734, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.771 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:31.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:31.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:31.788 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:31.788 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:30 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:30 GMT+08:00 2024
Start Time:             Sat May 04 01:41:30 GMT+08:00 2024
End Time:               Sat May 04 01:41:30 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:41:31.789 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2734, taskName=switch, firstSubmitTime=1714758091723, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=6, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2734'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014131'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.790 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.792 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:31.802 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.811 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758091811
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.812 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2734
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.812 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2734,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758091723,
  "startTime" : 1714758091811,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 6,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2734"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014131"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2734",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:31.816 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2734, processInstanceId=884, startTime=1714758091811, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.819 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.820 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.821 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.821 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2734] - [ERROR] 2024-05-04 01:41:31.821 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.821 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.821 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.821 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2734] - [ERROR] 2024-05-04 01:41:31.821 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2734] - [WARN] 2024-05-04 01:41:31.821 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.822 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:31 GMT+08:00 2024, endTime=Sat May 04 01:41:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.829 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.829 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.829 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:31.829 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:31.949 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7151335311572701 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:31.949 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:32.259 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7151335311572701 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.677 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:32.695 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=312), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2734] - [ERROR] 2024-05-04 01:41:32.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:31 GMT+08:00 2024, endTime=Sat May 04 01:41:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:41:32.723 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=313), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 122, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2734] - [WARN] 2024-05-04 01:41:32.725 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2734
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.725 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2734, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.725 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2734, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:41:31 GMT+08:00 2024, endTime=Sat May 04 01:41:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2734.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:32.725 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2734, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.745 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.745 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.745 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.747 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.748 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.748 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.749 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2734] - [INFO] 2024-05-04 01:41:32.758 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2735, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:32.778 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.779 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.780 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.781 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.781 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:41:32.783 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:31 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:31 GMT+08:00 2024
Start Time:             Sat May 04 01:41:31 GMT+08:00 2024
End Time:               Sat May 04 01:41:31 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:41:32.795 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2735, processInstanceId=884, startTime=1714758092790, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:32.796 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:32.955 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7564102564102565 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:32.955 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:33.272 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7564102564102565 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.726 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.768 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2735, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [WARN] 2024-05-04 01:41:33.772 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.772 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2735, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.800 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.811 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:33.811 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:33.834 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=Sat May 04 01:41:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2735, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, processId=1231, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:33.959 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9196712271211365 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:33.960 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:34.283 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9196712271211365 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.723 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=Sat May 04 01:41:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2735, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, processId=1231, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.733 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2735, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.733 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2735, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:41:32 GMT+08:00 2024, endTime=Sat May 04 01:41:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_6/884/2735, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/6/884/2735.log, processId=1231, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:34.735 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.823 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2735, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.824 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.824 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.824 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.824 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.836 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.837 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:34.839 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.844 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2735] - [INFO] 2024-05-04 01:41:34.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:41:32 GMT+08:00 2024
Submit Time:            Sat May 04 01:41:32 GMT+08:00 2024
Start Time:             Sat May 04 01:41:32 GMT+08:00 2024
End Time:               Sat May 04 01:41:33 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:41:34.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:41:34.845 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:41:34.848 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:41:26 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:41:26 GMT+08:00 2024
End Time:                  Sat May 04 01:41:34 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:41:34.849 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:34.961 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8822337386220185 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:34.961 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:35.285 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8822337386220185 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:35.962 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7609329446064139 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:35.962 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:36.285 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7609329446064139 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:36.487 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758092292, cpuUsage=0.7784615384615384, jvmMemoryUsage=0.034363969167073564, memoryUsage=0.549428716919058, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:36.493 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:36.963 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:37.964 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:38.967 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7396449704142013 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:38.967 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:39.344 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7396449704142013 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:39.863 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 6/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:39.968 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:40.972 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:41.973 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:42.976 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:43.982 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:44.956 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:44.983 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:41:45.985 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:46.502 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:50.009 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:41:55.025 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:00.040 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:05.079 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:10.109 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:15.234 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 37/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:20.262 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:25.278 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:30.351 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:35.368 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:38.326 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8532934131736527 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:42:38.326 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:38.739 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8532934131736527 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:40.384 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:45.401 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:48.388 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7046153846153846 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:42:48.388 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:48.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7046153846153846 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:50.419 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:53.415 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8108108108108107 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:42:53.416 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:53.950 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8108108108108107 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:55.473 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:58.437 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8603988603988604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:42:58.437 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:59.015 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8603988603988604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:42:59.439 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7889908256880733 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:42:59.440 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:00.043 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7889908256880733 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:00.508 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:01.445 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7911764705882353 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:01.452 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:02.099 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7911764705882353 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:02.464 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9008498583569405 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:02.469 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:03.111 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9008498583569405 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:03.471 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9015384615384616 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:03.472 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:04.111 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9015384615384616 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:04.474 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.869942196531792 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:04.475 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:05.116 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.869942196531792 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:05.579 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:06.483 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:06.483 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:06.753 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758186577, cpuUsage=0.8450704225352113, jvmMemoryUsage=0.034363969167073564, memoryUsage=0.5554452683508397, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:07.183 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8666666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:07.490 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7530957943925233 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:07.491 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:08.199 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7530957943925233 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:10.610 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:13.541 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.606 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.607 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.608 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:13.608 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 3
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 3, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.632 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.636 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.636 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.637 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.644 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2736, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:13.655 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:13.656 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:13.657 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:13.658 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: fsed failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.200 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2736, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:13 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2736] - [WARN] 2024-05-04 01:43:14.218 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2736
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.219 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2736, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.219 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2736, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:13 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:14.219 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.221 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2736, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.226 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.226 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.226 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.226 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.227 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.231 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.231 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.234 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2736] - [INFO] 2024-05-04 01:43:14.240 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2737, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: fsed failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:14.249 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:13 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:13 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 01:43:13 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:14.641 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327823691460056 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:14.641 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.201 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2737, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:14 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2737] - [WARN] 2024-05-04 01:43:15.207 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2737
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.208 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2737, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.208 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2737, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:14 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:15.208 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2737, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.220 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.222 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.223 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2737] - [INFO] 2024-05-04 01:43:15.225 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2738, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:15.225 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327823691460056 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:14 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:14 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 01:43:14 GMT+08:00 2024

[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:15.241 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: fsed failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:15.624 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.202 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2738, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:15 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2738] - [WARN] 2024-05-04 01:43:16.207 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2738
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.208 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2738, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.208 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2738, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:15 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:16.208 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.233 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2738, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.233 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.235 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.235 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.235 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.235 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.237 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.237 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.239 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2738] - [INFO] 2024-05-04 01:43:16.240 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2739, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[58] - Dispatch task: fsed failed, worker group not found.
org.apache.dolphinscheduler.server.master.dispatch.exceptions.WorkerGroupNotFoundException: Cannot find worker group: Can not find worker group default
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.getWorkerHostWeights(LowerWeightHostManager.java:157)
	at org.apache.dolphinscheduler.server.master.dispatch.host.LowerWeightHostManager.select(LowerWeightHostManager.java:74)
	at org.apache.dolphinscheduler.server.master.runner.dispatcher.WorkerTaskDispatcher.getTaskInstanceDispatchHost(WorkerTaskDispatcher.java:78)
	at org.apache.dolphinscheduler.server.master.runner.BaseTaskDispatcher.dispatchTask(BaseTaskDispatcher.java:55)
	at org.apache.dolphinscheduler.server.master.runner.GlobalTaskDispatchWaitingQueueLooper.run(GlobalTaskDispatchWaitingQueueLooper.java:78)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:16.245 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:15 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:15 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 01:43:15 GMT+08:00 2024

[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.239 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2739, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:16 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2739] - [WARN] 2024-05-04 01:43:17.245 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2739
java.lang.NullPointerException: null
	at com.google.common.base.Preconditions.checkNotNull(Preconditions.java:889)
	at com.google.common.cache.LocalCache.get(LocalCache.java:3965)
	at com.google.common.cache.LocalCache.getOrLoad(LocalCache.java:3989)
	at com.google.common.cache.LocalCache$LocalLoadingCache.get(LocalCache.java:4950)
	at org.apache.dolphinscheduler.extract.base.client.JdkDynamicRpcClientProxyFactory.getProxyClient(JdkDynamicRpcClientProxyFactory.java:60)
	at org.apache.dolphinscheduler.extract.base.client.SingletonJdkDynamicRpcClientProxyFactory.getProxyClient(SingletonJdkDynamicRpcClientProxyFactory.java:29)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:126)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.245 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2739, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.246 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2739, workerAddress=null, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=null, endTime=Sat May 04 01:43:16 GMT+08:00 2024, executePath=null, logPath=null, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:17.246 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2739, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.253 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.253 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.254 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.254 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: switch depend result : FAILED
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.259 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2739] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   null
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:16 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:16 GMT+08:00 2024
Start Time:             null
End Time:               Sat May 04 01:43:16 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:43:17.264 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:43:17.265 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:43:17.267 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 3
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:43:13 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:43:13 GMT+08:00 2024
End Time:                  Sat May 04 01:43:17 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:43:17.267 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:20.672 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 28/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:20.743 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7537091988130564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:20.744 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:21.256 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7537091988130564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:22.752 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8407079646017699 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:22.764 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:23.331 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8407079646017699 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:23.765 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.723342939481268 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:23.766 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:24.349 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.723342939481268 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:24.771 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7755102040816326 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:24.771 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:25.350 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7755102040816326 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:25.695 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:29.789 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7685185185185186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:29.789 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:30.374 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7685185185185186 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:30.794 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327327327327328 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:30.794 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:30.831 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 33/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:31.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7327327327327328 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:32.804 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:32.843 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.848 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.848 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.852 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 4
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.868 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 4, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.881 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.882 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.911 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.916 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.919 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.926 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2740, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:32.942 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.942 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:32.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:32.943 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:32.952 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:32.958 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2740, processInstanceId=884, startTime=1714758212955, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.279 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.285 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.286 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.296 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2740, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.296 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.296 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.306 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:33.307 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.383 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2740, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:33.384 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.018 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2740, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, processId=1265, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.280 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2740, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, processId=1265, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.288 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2740, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.288 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2740, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:32 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2740, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2740.log, processId=1265, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:34.289 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2740, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.302 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.302 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.302 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.302 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.311 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.312 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.313 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2740] - [INFO] 2024-05-04 01:43:34.315 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2741, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.319 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.319 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.319 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.320 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.320 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.320 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:34.320 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:32 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:32 GMT+08:00 2024
Start Time:             Sat May 04 01:43:32 GMT+08:00 2024
End Time:               Sat May 04 01:43:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:34.321 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2741, taskName=switch, firstSubmitTime=1714758214313, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=7, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2741'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014334'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.323 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.323 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.334 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.336 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.337 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758214337
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.337 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2741
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.337 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2741,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758214313,
  "startTime" : 1714758214337,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 7,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2741"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014334"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2741",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:34.333 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:34.339 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2741, processInstanceId=884, startTime=1714758214337, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.344 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.345 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.345 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.345 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.347 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.348 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.348 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2741] - [ERROR] 2024-05-04 01:43:34.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2741] - [ERROR] 2024-05-04 01:43:34.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2741] - [WARN] 2024-05-04 01:43:34.348 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.361 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:34 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.363 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.364 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.364 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:34.364 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.280 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.285 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.285 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:35.289 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=325), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2741] - [ERROR] 2024-05-04 01:43:35.289 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.290 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:34 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:35.292 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=326), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2741] - [WARN] 2024-05-04 01:43:35.293 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2741
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.293 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2741, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.293 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2741, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:34 GMT+08:00 2024, endTime=Sat May 04 01:43:34 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2741.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:35.293 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.328 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2741, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.328 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.328 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.329 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.329 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.329 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.330 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.330 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.330 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.333 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2741] - [INFO] 2024-05-04 01:43:35.334 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2742, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.339 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:35.339 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:35.340 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:35.340 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:35.340 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:34 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:34 GMT+08:00 2024
Start Time:             Sat May 04 01:43:34 GMT+08:00 2024
End Time:               Sat May 04 01:43:34 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:35.340 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2742, taskName=switch, firstSubmitTime=1714758215334, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=7, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2742'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014335'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.341 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.347 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.347 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.347 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758215347
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2742
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:35.343 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.348 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2742,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758215334,
  "startTime" : 1714758215347,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 7,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2742"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014335"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2742",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.348 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:35.350 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2742, processInstanceId=884, startTime=1714758215347, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.352 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.352 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.366 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.366 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.366 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.366 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2742] - [ERROR] 2024-05-04 01:43:35.367 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2742] - [ERROR] 2024-05-04 01:43:35.368 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2742] - [WARN] 2024-05-04 01:43:35.368 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.369 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:35 GMT+08:00 2024, endTime=Sat May 04 01:43:35 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:35.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:35.947 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.287 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.292 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.292 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:36.296 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=330), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2742] - [ERROR] 2024-05-04 01:43:36.297 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:35 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.297 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:35 GMT+08:00 2024, endTime=Sat May 04 01:43:35 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:36.300 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=331), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2742] - [WARN] 2024-05-04 01:43:36.301 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2742
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.301 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2742, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.301 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2742, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:35 GMT+08:00 2024, endTime=Sat May 04 01:43:35 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2742.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:36.301 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2742, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.348 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.350 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.351 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.351 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.352 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2742] - [INFO] 2024-05-04 01:43:36.354 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2743, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.359 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:36.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:36.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:36.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:36.359 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:35 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:35 GMT+08:00 2024
Start Time:             Sat May 04 01:43:35 GMT+08:00 2024
End Time:               Sat May 04 01:43:35 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:36.361 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2743, taskName=switch, firstSubmitTime=1714758216352, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=7, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2743'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014336'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.362 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.362 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.365 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.367 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.367 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.367 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758216367
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.367 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2743
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.367 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2743,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758216352,
  "startTime" : 1714758216367,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 7,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2743"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014336"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2743",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.368 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.368 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.368 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:36.369 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:36.369 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2743, processInstanceId=884, startTime=1714758216367, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.370 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2743] - [ERROR] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.371 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2743] - [ERROR] 2024-05-04 01:43:36.371 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2743] - [WARN] 2024-05-04 01:43:36.372 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.375 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:36 GMT+08:00 2024, endTime=Sat May 04 01:43:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.376 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.377 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.377 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:36.377 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.288 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.294 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.294 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:37.297 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=335), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2743] - [ERROR] 2024-05-04 01:43:37.298 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.299 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:36 GMT+08:00 2024, endTime=Sat May 04 01:43:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:37.303 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=336), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2743] - [WARN] 2024-05-04 01:43:37.303 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2743
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.304 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2743, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.304 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2743, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:36 GMT+08:00 2024, endTime=Sat May 04 01:43:36 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2743.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:37.304 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2743, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.305 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.307 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.308 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2743] - [INFO] 2024-05-04 01:43:37.310 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2744, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.315 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:37.315 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:37.315 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:37.315 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:37.316 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:36 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:36 GMT+08:00 2024
Start Time:             Sat May 04 01:43:36 GMT+08:00 2024
End Time:               Sat May 04 01:43:36 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:37.317 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2744, taskName=switch, firstSubmitTime=1714758217309, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=7, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2744'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014337'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.318 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.318 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.323 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.325 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.325 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.325 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758217325
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:37.323 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.325 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2744
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.326 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2744,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758217309,
  "startTime" : 1714758217325,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 7,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2744"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014337"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2744",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.326 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.326 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.326 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:37.328 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2744, processInstanceId=884, startTime=1714758217325, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.329 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.329 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.329 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-884][TI-2744] - [ERROR] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.330 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2744] - [ERROR] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2744] - [WARN] 2024-05-04 01:43:37.330 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.332 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:37 GMT+08:00 2024, endTime=Sat May 04 01:43:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.333 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.334 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.334 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:37.334 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.288 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.295 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.295 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:38.300 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=340), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2744] - [ERROR] 2024-05-04 01:43:38.302 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:37 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.303 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:37 GMT+08:00 2024, endTime=Sat May 04 01:43:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:43:38.307 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=341), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2744] - [WARN] 2024-05-04 01:43:38.308 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2744
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.308 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2744, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.308 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2744, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:43:37 GMT+08:00 2024, endTime=Sat May 04 01:43:37 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2744.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:38.309 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.362 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2744, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.363 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.363 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.363 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.363 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.367 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.368 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.368 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2744] - [INFO] 2024-05-04 01:43:38.370 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2745, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:38.375 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.375 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.375 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.376 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.376 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.376 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:43:38.376 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:37 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:37 GMT+08:00 2024
Start Time:             Sat May 04 01:43:37 GMT+08:00 2024
End Time:               Sat May 04 01:43:37 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:43:38.381 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:38.385 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2745, processInstanceId=884, startTime=1714758218381, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.289 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.310 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.316 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.366 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2745, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.367 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.367 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.378 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:39.378 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.389 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2745, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.390 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:39.413 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=Sat May 04 01:43:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2745, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, processId=1276, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:39.962 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7008547008547008 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:39.962 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.295 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=Sat May 04 01:43:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2745, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, processId=1276, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.309 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2745, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.327 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2745, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:43:38 GMT+08:00 2024, endTime=Sat May 04 01:43:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_7/884/2745, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/7/884/2745.log, processId=1276, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.328 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2745, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:40.327 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.329 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.329 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.329 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.329 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.346 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.366 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.382 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.387 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2745] - [INFO] 2024-05-04 01:43:40.387 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:43:38 GMT+08:00 2024
Submit Time:            Sat May 04 01:43:38 GMT+08:00 2024
Start Time:             Sat May 04 01:43:38 GMT+08:00 2024
End Time:               Sat May 04 01:43:39 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:43:40.388 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:43:40.389 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:43:40.415 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 4
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:43:32 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:43:32 GMT+08:00 2024
End Time:                  Sat May 04 01:43:40 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:43:40.416 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:40.519 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7008547008547008 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:40.986 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:45.013 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7334794696321643 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:45.013 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:45.589 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7334794696321643 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:46.031 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:51.060 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7212121212121213 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:51.063 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:51.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:51.625 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7212121212121213 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:53.068 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7945619335347431 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:53.068 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:53.705 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7945619335347431 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:54.070 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7994269340974212 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:43:54.070 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:54.713 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7994269340974212 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:43:56.086 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:01.126 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:06.184 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:11.209 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:16.223 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:21.236 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:26.257 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:31.274 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:33.559 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:33.585 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 01:44:33.585 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:44:33.585 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:44:33.585 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:44:33.585 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:44:33.586 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:44:33.586 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:44:33.586 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:44:33.586 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:33.586 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:6ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:36.293 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:41.349 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:46.450 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:51.492 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:44:56.527 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:01.567 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:06.598 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:11.642 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:16.764 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:21.781 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:26.794 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:31.836 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:36.851 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:41.865 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:46.882 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:51.893 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:45:56.908 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:01.924 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:06.939 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:11.972 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:17.047 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:22.063 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:27.082 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:32.096 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:37.113 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:42.134 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:47.151 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:52.181 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:46:57.206 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:02.259 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:07.277 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:12.392 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:17.421 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:22.469 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:27.490 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:32.512 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:37.524 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:42.570 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 19/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:47.630 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:52.658 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:47:57.676 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:02.718 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:04.136 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.851963746223565 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:04.151 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:04.283 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.851963746223565 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:07.742 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:12.782 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:17.808 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:22.833 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:27.865 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:32.890 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:36.276 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9570200573065902 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:36.278 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:36.605 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9570200573065902 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:37.282 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7213335626648321 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:37.282 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:37.338 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758516406, cpuUsage=0.9544235924932976, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5585733422172858, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:37.389 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:37.632 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7213335626648321 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:37.939 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 26/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:38.283 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8886123618501842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:38.283 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:38.635 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8886123618501842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:39.284 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:40.290 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:41.334 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:42.336 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7382352941176471 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:42.336 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:42.654 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7382352941176471 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:42.981 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:43.339 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:44.355 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:45.356 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:46.359 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:47.366 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:47.397 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:47.997 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.370 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.409 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.409 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.410 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.412 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 5
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.412 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 5, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.416 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.416 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.420 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.422 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2746, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.426 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:48.427 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.427 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.460 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.467 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2746, processInstanceId=884, startTime=1714758528461, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.940 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.944 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.944 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.950 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2746, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.950 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.951 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:48.956 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:48.956 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.047 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2746, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.047 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.506 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2746, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, processId=1348, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.943 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2746, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, processId=1348, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.951 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2746, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.951 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2746, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:48 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2746, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2746.log, processId=1348, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:49.952 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.958 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2746, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.958 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.958 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.958 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.958 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.964 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.964 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.964 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.965 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2746] - [INFO] 2024-05-04 01:48:49.967 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2747, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.969 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.970 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.970 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.970 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.970 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.970 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:49.971 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:48 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:48 GMT+08:00 2024
Start Time:             Sat May 04 01:48:48 GMT+08:00 2024
End Time:               Sat May 04 01:48:49 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:48:49.972 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2747, taskName=switch, firstSubmitTime=1714758529965, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=8, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2747'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014849'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.973 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.979 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.979 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758529979
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.980 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2747
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.980 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2747,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758529965,
  "startTime" : 1714758529979,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 8,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2747"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014849"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2747",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.980 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.981 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.981 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.973 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:49.984 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2747, processInstanceId=884, startTime=1714758529979, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:49.989 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.989 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.990 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.991 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.991 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}] successfully
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.992 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.992 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.992 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/"
[WI-884][TI-2747] - [ERROR] 2024-05-04 01:48:49.993 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.993 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.993 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.993 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2747] - [ERROR] 2024-05-04 01:48:49.993 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2747] - [WARN] 2024-05-04 01:48:49.994 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.995 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:49 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.997 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.997 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.997 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:49.997 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:50.945 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:50.953 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=353), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2747] - [ERROR] 2024-05-04 01:48:50.955 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:50.956 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:50.971 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:50.971 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:49 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:51.002 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=354), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2747] - [WARN] 2024-05-04 01:48:51.014 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2747
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.014 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2747, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.015 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2747, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:49 GMT+08:00 2024, endTime=Sat May 04 01:48:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2747.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:51.015 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2747, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.067 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.068 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.069 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.069 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.070 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2747] - [INFO] 2024-05-04 01:48:51.072 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2748, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.080 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:51.080 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:51.080 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:51.083 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2748, taskName=switch, firstSubmitTime=1714758531070, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=8, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2748'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014851'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:51.081 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.102 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:51.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:49 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:49 GMT+08:00 2024
Start Time:             Sat May 04 01:48:49 GMT+08:00 2024
End Time:               Sat May 04 01:48:49 GMT+08:00 2024

[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:51.115 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758531119
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2748
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.119 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2748,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758531070,
  "startTime" : 1714758531119,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 8,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2748"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014851"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2748",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:51.122 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2748, processInstanceId=884, startTime=1714758531119, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.147 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}] successfully
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/"
[WI-884][TI-2748] - [ERROR] 2024-05-04 01:48:51.149 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.149 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2748] - [ERROR] 2024-05-04 01:48:51.150 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2748] - [WARN] 2024-05-04 01:48:51.150 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.153 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:51 GMT+08:00 2024, endTime=Sat May 04 01:48:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.156 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.157 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.945 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.948 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.948 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:51.951 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=358), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2748] - [ERROR] 2024-05-04 01:48:51.952 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.952 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:51 GMT+08:00 2024, endTime=Sat May 04 01:48:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:51.957 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=359), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2748] - [WARN] 2024-05-04 01:48:51.957 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2748
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.957 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2748, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.957 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2748, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:51 GMT+08:00 2024, endTime=Sat May 04 01:48:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2748.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:51.958 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2748, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.988 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.988 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.988 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.988 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.988 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.991 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.994 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2748] - [INFO] 2024-05-04 01:48:51.999 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2749, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.019 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:52.019 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:52.019 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:52.019 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:52.020 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:51 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:51 GMT+08:00 2024
Start Time:             Sat May 04 01:48:51 GMT+08:00 2024
End Time:               Sat May 04 01:48:51 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:48:52.024 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2749, taskName=switch, firstSubmitTime=1714758531994, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=8, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2749'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014852'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.027 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.028 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.054 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:52.031 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.054 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758532054
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.056 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2749
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.056 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2749,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758531994,
  "startTime" : 1714758532054,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 8,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2749"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014852"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2749",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.056 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.056 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.056 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:52.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2749, processInstanceId=884, startTime=1714758532054, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.061 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.062 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.062 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.062 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}] successfully
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.062 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.064 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.064 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/"
[WI-884][TI-2749] - [ERROR] 2024-05-04 01:48:52.064 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.065 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.065 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2749] - [ERROR] 2024-05-04 01:48:52.065 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2749] - [WARN] 2024-05-04 01:48:52.065 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.067 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:52 GMT+08:00 2024, endTime=Sat May 04 01:48:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.075 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.076 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.076 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.076 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.946 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.954 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.954 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:52.959 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=363), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2749] - [ERROR] 2024-05-04 01:48:52.960 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.961 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:52 GMT+08:00 2024, endTime=Sat May 04 01:48:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:52.968 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=364), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 48, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2749] - [WARN] 2024-05-04 01:48:52.969 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2749
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.970 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2749, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:52.970 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2749, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:52 GMT+08:00 2024, endTime=Sat May 04 01:48:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2749.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:52.970 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.003 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2749, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.004 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.004 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.004 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.004 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.004 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.009 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.010 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.010 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.014 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2749] - [INFO] 2024-05-04 01:48:53.016 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2750, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:53.016 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.024 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:53.025 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2750, taskName=switch, firstSubmitTime=1714758533015, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=8, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2750'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504014853'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:53.025 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:53.027 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.027 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:53.027 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:53.034 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:51 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:51 GMT+08:00 2024
Start Time:             Sat May 04 01:48:52 GMT+08:00 2024
End Time:               Sat May 04 01:48:52 GMT+08:00 2024

[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.027 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:53.035 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.044 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.044 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.044 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758533044
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.045 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2750
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.047 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2750,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758533015,
  "startTime" : 1714758533044,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 8,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2750"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504014853"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2750",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.049 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:53.051 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2750, processInstanceId=884, startTime=1714758533044, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.052 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}] successfully
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.053 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"/local_storage/gnews/"
[WI-884][TI-2750] - [ERROR] 2024-05-04 01:48:53.057 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.058 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.060 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.060 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2750] - [ERROR] 2024-05-04 01:48:53.060 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2750] - [WARN] 2024-05-04 01:48:53.060 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.062 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:53 GMT+08:00 2024, endTime=Sat May 04 01:48:53 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.064 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.065 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.065 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.065 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.948 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.955 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.955 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:53.961 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=368), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2750] - [ERROR] 2024-05-04 01:48:53.962 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.963 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:53 GMT+08:00 2024, endTime=Sat May 04 01:48:53 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:48:53.977 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=369), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2750] - [WARN] 2024-05-04 01:48:53.980 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2750
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.981 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2750, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:53.981 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2750, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:48:53 GMT+08:00 2024, endTime=Sat May 04 01:48:53 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2750.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:53.981 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.077 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2750, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.078 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.078 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.078 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.078 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.083 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.083 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.084 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.087 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2750] - [INFO] 2024-05-04 01:48:54.099 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2751, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.113 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:48:54.114 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:53 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:53 GMT+08:00 2024
Start Time:             Sat May 04 01:48:53 GMT+08:00 2024
End Time:               Sat May 04 01:48:53 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:48:54.122 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:54.132 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2751, processInstanceId=884, startTime=1714758534126, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:54.964 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:54.975 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:54.975 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.002 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2751, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.002 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.003 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.013 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:55.014 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2751, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.093 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.197 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=Sat May 04 01:48:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2751, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, processId=1365, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:55.951 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=Sat May 04 01:48:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2751, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, processId=1365, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.024 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2751, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.025 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2751, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:48:54 GMT+08:00 2024, endTime=Sat May 04 01:48:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_8/884/2751, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/8/884/2751.log, processId=1365, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:56.025 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.125 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2751, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.125 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.126 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.126 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.126 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.135 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.136 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.143 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2751] - [INFO] 2024-05-04 01:48:56.148 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:48:54 GMT+08:00 2024
Submit Time:            Sat May 04 01:48:54 GMT+08:00 2024
Start Time:             Sat May 04 01:48:54 GMT+08:00 2024
End Time:               Sat May 04 01:48:55 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:48:56.149 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:48:56.149 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:48:56.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 5
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:48:48 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:48:48 GMT+08:00 2024
End Time:                  Sat May 04 01:48:56 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:48:56.174 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:57.436 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.734870317002882 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:48:57.436 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:57.721 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.734870317002882 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:48:58.035 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:03.049 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:08.066 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:13.097 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:18.114 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:22.647 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7876106194690266 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:22.647 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:23.050 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7876106194690266 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:23.210 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:23.653 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7764350453172206 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:23.654 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:24.084 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7764350453172206 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:24.656 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7447447447447448 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:24.656 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:25.086 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7447447447447448 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:25.657 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7088948787061994 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:25.657 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:26.087 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7088948787061994 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:27.500 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758567111, cpuUsage=0.7028753993610224, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5645340209846593, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:28.305 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:33.321 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:38.335 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:43.357 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:45.405 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:45.406 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:48.370 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:53.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:54.457 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.877245508982036 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:54.457 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:54.469 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.877245508982036 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:55.459 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7563739376770539 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:49:55.459 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:55.526 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7563739376770539 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:49:58.441 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:03.471 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:08.508 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:13.550 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:18.571 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:23.584 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:28.599 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:33.640 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:33.750 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7668918918918919 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:33.775 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7668918918918919 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:33.776 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:35.804 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.835195530726257 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:35.804 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:35.856 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.835195530726257 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:36.807 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.813953488372093 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:36.807 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:36.873 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.813953488372093 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:37.652 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758635901, cpuUsage=0.8230337078651685, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5648475839447016, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:37.656 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:37.817 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.828522272696454 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:37.818 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:37.887 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.828522272696454 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:38.682 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:38.821 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7421203438395415 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:38.821 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:38.889 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7421203438395415 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:39.824 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:40.827 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7620481927710844 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:40.827 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:40.907 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7620481927710844 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:41.828 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:42.830 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.743202416918429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:42.830 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:42.962 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.743202416918429 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:43.715 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:43.834 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:43.836 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:44.041 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7142857142857142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:44.838 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7125748502994013 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:44.839 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:45.051 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7125748502994013 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:45.847 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:46.849 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.673 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.855 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.879 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.879 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.880 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.880 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.880 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 6
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.880 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 6, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.888 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.892 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.892 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.893 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.895 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2752, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:47.902 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.902 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.902 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:47.903 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.903 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.903 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:47.910 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2752, processInstanceId=884, startTime=1714758647907, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.710 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.722 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2752, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.722 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.723 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:48.727 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.729 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:48.729 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2752, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.816 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:48.925 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=Sat May 04 01:50:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2752, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, processId=1394, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.710 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=Sat May 04 01:50:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2752, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, processId=1394, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.719 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2752, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.720 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2752, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:47 GMT+08:00 2024, endTime=Sat May 04 01:50:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2752, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2752.log, processId=1394, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:49.720 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2752, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.736 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.736 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.736 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.736 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.747 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2752] - [INFO] 2024-05-04 01:50:49.749 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2753, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.753 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:49.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:47 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:47 GMT+08:00 2024
Start Time:             Sat May 04 01:50:47 GMT+08:00 2024
End Time:               Sat May 04 01:50:48 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:50:49.755 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2753, taskName=switch, firstSubmitTime=1714758649748, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=9, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2753'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015049'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.755 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.756 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758649766
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:49.766 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.766 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2753
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.768 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2753,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758649748,
  "startTime" : 1714758649766,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 9,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2753"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015049"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2753",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:49.771 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2753, processInstanceId=884, startTime=1714758649766, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.772 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}] successfully
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.773 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/'"
[WI-884][TI-2753] - [ERROR] 2024-05-04 01:50:49.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.774 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2753] - [ERROR] 2024-05-04 01:50:49.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2753] - [WARN] 2024-05-04 01:50:49.774 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.776 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:49 GMT+08:00 2024, endTime=Sat May 04 01:50:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.778 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.778 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.779 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:49.779 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.714 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.720 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.721 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:50.725 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=381), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2753] - [ERROR] 2024-05-04 01:50:50.727 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.727 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:49 GMT+08:00 2024, endTime=Sat May 04 01:50:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:50.732 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=382), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 77, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2753] - [WARN] 2024-05-04 01:50:50.737 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2753
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.737 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2753, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.737 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2753, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:49 GMT+08:00 2024, endTime=Sat May 04 01:50:49 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2753.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:50.737 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2753, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.756 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.756 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.756 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.761 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.762 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2753] - [INFO] 2024-05-04 01:50:50.767 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2754, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.774 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:50.775 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:50.776 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:50.776 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:50.776 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:49 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:49 GMT+08:00 2024
Start Time:             Sat May 04 01:50:49 GMT+08:00 2024
End Time:               Sat May 04 01:50:49 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:50:50.777 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2754, taskName=switch, firstSubmitTime=1714758650762, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=9, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2754'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015050'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.778 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.778 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:50.783 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.786 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.787 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.788 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.788 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758650788
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.789 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2754
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.789 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2754,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758650762,
  "startTime" : 1714758650788,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 9,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2754"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015050"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2754",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:50.802 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2754, processInstanceId=884, startTime=1714758650788, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.803 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.803 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}] successfully
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.804 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/'"
[WI-884][TI-2754] - [ERROR] 2024-05-04 01:50:50.805 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2754] - [ERROR] 2024-05-04 01:50:50.806 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2754] - [WARN] 2024-05-04 01:50:50.806 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.809 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:50 GMT+08:00 2024, endTime=Sat May 04 01:50:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.814 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.815 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.815 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:50.815 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.736 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.745 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:51.748 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=386), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2754] - [ERROR] 2024-05-04 01:50:51.748 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:50 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.748 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:50 GMT+08:00 2024, endTime=Sat May 04 01:50:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:51.752 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=387), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2754] - [WARN] 2024-05-04 01:50:51.752 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2754
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.753 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2754, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.753 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2754, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:50 GMT+08:00 2024, endTime=Sat May 04 01:50:50 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2754.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:51.753 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.786 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2754, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.787 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.790 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.790 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.790 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.790 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.800 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.802 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2754] - [INFO] 2024-05-04 01:50:51.803 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2755, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.815 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:51.815 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:51.815 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:51.815 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:51.816 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2755, taskName=switch, firstSubmitTime=1714758651802, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=9, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2755'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015051'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:51.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:50 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:50 GMT+08:00 2024
Start Time:             Sat May 04 01:50:50 GMT+08:00 2024
End Time:               Sat May 04 01:50:50 GMT+08:00 2024

[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.817 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.817 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.834 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:51.833 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.835 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.835 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.835 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758651835
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.835 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2755
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.844 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2755,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758651802,
  "startTime" : 1714758651835,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 9,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2755"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015051"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2755",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:51.846 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2755, processInstanceId=884, startTime=1714758651835, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.847 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}] successfully
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.848 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.849 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/'"
[WI-884][TI-2755] - [ERROR] 2024-05-04 01:50:51.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2755] - [ERROR] 2024-05-04 01:50:51.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2755] - [WARN] 2024-05-04 01:50:51.849 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.850 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:51 GMT+08:00 2024, endTime=Sat May 04 01:50:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.851 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.852 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:51.852 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.753 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.762 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.763 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:52.767 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=391), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2755] - [ERROR] 2024-05-04 01:50:52.768 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.768 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:51 GMT+08:00 2024, endTime=Sat May 04 01:50:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:52.772 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=392), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2755] - [WARN] 2024-05-04 01:50:52.773 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2755
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.773 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2755, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.774 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2755, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:51 GMT+08:00 2024, endTime=Sat May 04 01:50:51 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2755.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:52.774 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.839 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2755, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.840 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.840 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.840 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.840 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.840 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.843 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2755] - [INFO] 2024-05-04 01:50:52.843 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2756, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.849 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:52.849 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:52.849 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:52.849 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:52.849 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:51 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:51 GMT+08:00 2024
Start Time:             Sat May 04 01:50:51 GMT+08:00 2024
End Time:               Sat May 04 01:50:51 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:50:52.852 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2756, taskName=switch, firstSubmitTime=1714758652843, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=9, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2756'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015052'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.852 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.853 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758652855
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2756
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.855 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2756,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758652843,
  "startTime" : 1714758652855,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 9,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2756"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015052"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2756",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:52.856 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:52.857 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2756, processInstanceId=884, startTime=1714758652855, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.857 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}] successfully
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/'"
[WI-884][TI-2756] - [ERROR] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.858 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2756] - [ERROR] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: '${raw_file_dir}' == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2756] - [WARN] 2024-05-04 01:50:52.858 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.861 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:52 GMT+08:00 2024, endTime=Sat May 04 01:50:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:52.863 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.787 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.860 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.860 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:53.867 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=396), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2756] - [ERROR] 2024-05-04 01:50:53.871 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.879 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:52 GMT+08:00 2024, endTime=Sat May 04 01:50:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:53.878 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 11/ms
[WI-0][TI-0] - [ERROR] 2024-05-04 01:50:53.889 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=397), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2756] - [WARN] 2024-05-04 01:50:53.891 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2756
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.898 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2756, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.899 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2756, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:50:52 GMT+08:00 2024, endTime=Sat May 04 01:50:52 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2756.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:53.900 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.980 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2756, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.980 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.980 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.980 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.980 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.984 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.985 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.985 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.986 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2756] - [INFO] 2024-05-04 01:50:53.989 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2757, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:53.996 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.996 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.997 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.997 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.997 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.998 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:50:53.998 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:52 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:52 GMT+08:00 2024
Start Time:             Sat May 04 01:50:52 GMT+08:00 2024
End Time:               Sat May 04 01:50:52 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:50:54.002 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:54.011 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2757, processInstanceId=884, startTime=1714758654004, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.775 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.806 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.806 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.815 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2757, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.815 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.816 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2757, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.818 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:54.823 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:54.824 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.101 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=Sat May 04 01:50:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2757, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, processId=1412, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.778 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=Sat May 04 01:50:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2757, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, processId=1412, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.793 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2757, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.793 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2757, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:50:54 GMT+08:00 2024, endTime=Sat May 04 01:50:55 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_9/884/2757, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/9/884/2757.log, processId=1412, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:55.793 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2757, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.842 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.842 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.842 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.850 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.850 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.862 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.863 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2757] - [INFO] 2024-05-04 01:50:55.864 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:50:53 GMT+08:00 2024
Submit Time:            Sat May 04 01:50:53 GMT+08:00 2024
Start Time:             Sat May 04 01:50:54 GMT+08:00 2024
End Time:               Sat May 04 01:50:55 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:50:55.868 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:50:55.868 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:50:55.883 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 6
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:50:47 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:50:47 GMT+08:00 2024
End Time:                  Sat May 04 01:50:55 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:50:55.887 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:55.916 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8441558441558441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:50:55.917 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:56.131 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8441558441558441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:50:58.911 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:03.931 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:08.956 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:13.973 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:18.994 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:24.014 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:24.439 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8198198198198198 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:24.452 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:24.443 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8198198198198198 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:25.468 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8502824858757062 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:25.469 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:25.512 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8502824858757062 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:26.474 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9313432835820896 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:26.481 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:26.517 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9313432835820896 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:27.483 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8109756097560975 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:27.484 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:27.518 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8109756097560975 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:27.710 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758684454, cpuUsage=0.8100890207715132, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5552945513415106, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:27.713 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:28.485 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:29.086 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 34/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:29.486 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:30.488 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:31.490 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:32.492 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:33.494 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:34.116 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:34.528 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:35.529 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:36.530 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:51:37.534 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:37.719 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:39.137 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:44.161 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:49.183 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:54.219 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:51:59.262 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:04.329 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 12/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:09.361 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:14.389 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:17.874 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7113702623906705 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:17.874 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:18.855 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7113702623906705 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:19.424 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:23.898 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8313253012048193 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:24.442 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:24.912 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7130177514792898 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:24.912 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:24.916 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7130177514792898 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:25.918 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7763157894736842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:25.929 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:25.924 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7763157894736842 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:26.931 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9572649572649572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:26.932 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:26.937 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9572649572649572 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:27.758 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758745989, cpuUsage=0.7961783439490446, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5610379033394952, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:27.762 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:27.933 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:28.943 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:29.532 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:29.946 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:30.948 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:31.950 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8695652173913044 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:31.950 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:31.964 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8695652173913044 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:32.952 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:33.954 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:34.572 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:34.957 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:35.959 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.758513931888545 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:35.959 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:36.002 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.758513931888545 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:36.960 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:37.767 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:37.970 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.985 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.986 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.986 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.986 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 7
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 7, recover flag: NO
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:37.986 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.992 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.994 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.995 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.996 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:37.998 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2758, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.004 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:38.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:38.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:38.005 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:38.006 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:38.011 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:38.015 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2758, processInstanceId=884, startTime=1714758758013, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.644 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.649 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.649 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.653 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2758, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.653 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.653 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.657 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:38.658 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.691 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2758, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:38.692 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.044 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2758, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, processId=1440, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:39.599 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.645 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2758, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, processId=1440, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.653 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2758, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.654 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2758, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:38 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2758, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2758.log, processId=1440, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:39.654 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.775 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2758, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.776 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.776 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.777 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.777 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.786 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.787 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.788 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2758] - [INFO] 2024-05-04 01:52:39.790 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2759, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:39.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:37 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:37 GMT+08:00 2024
Start Time:             Sat May 04 01:52:38 GMT+08:00 2024
End Time:               Sat May 04 01:52:39 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:52:39.799 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2759, taskName=switch, firstSubmitTime=1714758759789, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=10, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2759'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015239'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.799 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.809 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758759810
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2759
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2759,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758759789,
  "startTime" : 1714758759810,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 10,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2759"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015239"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2759",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.810 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:39.808 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:39.811 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2759, processInstanceId=884, startTime=1714758759810, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.812 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}] successfully
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.813 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.814 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/'"
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.814 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""'local_storage/'"" == "local_storage" successfully
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.815 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""'local_storage/'"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^ in <eval> at line number 1 at column number 3
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.815 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.816 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.816 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.817 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:39 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.818 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.818 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:39.818 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.647 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.658 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.658 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:40.664 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=409), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2759] - [ERROR] 2024-05-04 01:52:40.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:39 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:39 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:40.670 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=410), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 49, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2759] - [WARN] 2024-05-04 01:52:40.672 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2759
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.672 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2759, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2759, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:39 GMT+08:00 2024, endTime=Sat May 04 01:52:39 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2759.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:40.672 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.771 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2759, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.772 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.772 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.772 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.772 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.772 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.774 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.775 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2759] - [INFO] 2024-05-04 01:52:40.776 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2760, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.788 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:40.788 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:40.788 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:40.788 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:40.789 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:39 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:39 GMT+08:00 2024
Start Time:             Sat May 04 01:52:39 GMT+08:00 2024
End Time:               Sat May 04 01:52:39 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:52:40.789 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2760, taskName=switch, firstSubmitTime=1714758760775, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=10, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2760'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015240'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.790 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758760798
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2760
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2760,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758760775,
  "startTime" : 1714758760798,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 10,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2760"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015240"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2760",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:40.795 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:40.801 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2760, processInstanceId=884, startTime=1714758760798, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.802 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.802 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.802 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.802 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}] successfully
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.803 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.803 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.804 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/'"
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""'local_storage/'"" == "local_storage" successfully
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.804 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""'local_storage/'"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^ in <eval> at line number 1 at column number 3
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.805 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.805 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.805 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.807 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:40 GMT+08:00 2024, endTime=Sat May 04 01:52:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.808 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.808 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:40.808 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.647 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.660 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.660 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:41.664 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=414), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2760] - [ERROR] 2024-05-04 01:52:41.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:40 GMT+08:00 2024, endTime=Sat May 04 01:52:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:41.669 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=415), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2760] - [WARN] 2024-05-04 01:52:41.670 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2760
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.670 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2760, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.670 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2760, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:40 GMT+08:00 2024, endTime=Sat May 04 01:52:40 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2760.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:41.670 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2760, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.757 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2760] - [INFO] 2024-05-04 01:52:41.759 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2761, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.765 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:41.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:41.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:41.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:41.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:40 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:40 GMT+08:00 2024
Start Time:             Sat May 04 01:52:40 GMT+08:00 2024
End Time:               Sat May 04 01:52:40 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:52:41.766 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2761, taskName=switch, firstSubmitTime=1714758761758, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=10, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2761'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015241'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.767 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.767 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.771 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758761774
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.774 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2761
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:41.772 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.775 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2761,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758761758,
  "startTime" : 1714758761774,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 10,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2761"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015241"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2761",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.776 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.776 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.776 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:41.779 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2761, processInstanceId=884, startTime=1714758761774, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}] successfully
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.780 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.781 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.781 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.781 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/'"
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.781 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""'local_storage/'"" == "local_storage" successfully
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.782 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""'local_storage/'"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^ in <eval> at line number 1 at column number 3
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.783 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.783 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.784 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:41 GMT+08:00 2024, endTime=Sat May 04 01:52:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.785 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.786 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:41.786 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.659 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:42.668 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=419), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2761] - [ERROR] 2024-05-04 01:52:42.669 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.669 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:41 GMT+08:00 2024, endTime=Sat May 04 01:52:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:42.672 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=420), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2761] - [WARN] 2024-05-04 01:52:42.674 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2761
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.674 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2761, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.674 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2761, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:41 GMT+08:00 2024, endTime=Sat May 04 01:52:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2761.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:42.674 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2761, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.698 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.698 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.698 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.699 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.699 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.701 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.703 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2761] - [INFO] 2024-05-04 01:52:42.704 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2762, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.711 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:42.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:42.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:42.711 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:42.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:41 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:41 GMT+08:00 2024
Start Time:             Sat May 04 01:52:41 GMT+08:00 2024
End Time:               Sat May 04 01:52:41 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:52:42.713 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2762, taskName=switch, firstSubmitTime=1714758762703, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=10, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"'${raw_file_dir}' == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2762'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015242'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.713 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.713 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.718 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.723 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.723 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758762723
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.723 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2762
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.724 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2762,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758762703,
  "startTime" : 1714758762723,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 10,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"'${raw_file_dir}' == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2762"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015242"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2762",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:42.725 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2762, processInstanceId=884, startTime=1714758762723, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:42.725 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.727 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.727 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "'${raw_file_dir}' == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.728 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.728 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}] successfully
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.730 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: '${raw_file_dir}' == 'local_storage' 
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.730 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/'"
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.730 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::""'local_storage/'"" == "local_storage" successfully
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.732 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[116] - Execute condition sentence: ""'local_storage/'"" == "local_storage" failed
javax.script.ScriptException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^ in <eval> at line number 1 at column number 3
	at jdk.nashorn.api.scripting.NashornScriptEngine.throwAsScriptException(NashornScriptEngine.java:470)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:537)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:524)
	at jdk.nashorn.api.scripting.NashornScriptEngine.evalImpl(NashornScriptEngine.java:402)
	at jdk.nashorn.api.scripting.NashornScriptEngine.eval(NashornScriptEngine.java:155)
	at javax.script.AbstractScriptEngine.eval(AbstractScriptEngine.java:264)
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.evaluate(SwitchTaskUtils.java:61)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:113)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: jdk.nashorn.internal.runtime.ParserException: <eval>:1:3 Expected ; but found local_storage/
""'local_storage/'"" == "local_storage"
   ^
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:294)
	at jdk.nashorn.internal.parser.AbstractParser.error(AbstractParser.java:279)
	at jdk.nashorn.internal.parser.AbstractParser.expectDontAdvance(AbstractParser.java:350)
	at jdk.nashorn.internal.parser.AbstractParser.expect(AbstractParser.java:337)
	at jdk.nashorn.internal.parser.Parser.endOfLine(Parser.java:3372)
	at jdk.nashorn.internal.parser.Parser.expressionStatement(Parser.java:1160)
	at jdk.nashorn.internal.parser.Parser.statement(Parser.java:967)
	at jdk.nashorn.internal.parser.Parser.sourceElements(Parser.java:773)
	at jdk.nashorn.internal.parser.Parser.program(Parser.java:709)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:283)
	at jdk.nashorn.internal.parser.Parser.parse(Parser.java:249)
	at jdk.nashorn.internal.runtime.Context.compile(Context.java:1284)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:1251)
	at jdk.nashorn.internal.runtime.Context.compileScript(Context.java:627)
	at jdk.nashorn.api.scripting.NashornScriptEngine.compileImpl(NashornScriptEngine.java:535)
	... 12 common frames omitted
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.732 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:FAILED, switch branch:1
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.732 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: FAILED, task status is: FAILURE
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.733 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.734 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:42 GMT+08:00 2024, endTime=Sat May 04 01:52:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.736 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.737 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is FAILURE
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:42.737 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.668 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:43.680 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=424), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2762] - [ERROR] 2024-05-04 01:52:43.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.689 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.689 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:42 GMT+08:00 2024, endTime=Sat May 04 01:52:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:52:43.695 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=425), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 77, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2762] - [WARN] 2024-05-04 01:52:43.696 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2762
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.696 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2762, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.696 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2762, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:52:42 GMT+08:00 2024, endTime=Sat May 04 01:52:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2762.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:43.696 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.721 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2762, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.722 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.722 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.722 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.722 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.760 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2762] - [INFO] 2024-05-04 01:52:43.763 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2763, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:43.774 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:52:43.785 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:42 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:42 GMT+08:00 2024
Start Time:             Sat May 04 01:52:42 GMT+08:00 2024
End Time:               Sat May 04 01:52:42 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:52:43.787 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:43.793 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2763, processInstanceId=884, startTime=1714758763786, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:44.613 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.669 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.707 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2763, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.707 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.708 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.716 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:44.717 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.744 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2763, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.744 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:44.853 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=Sat May 04 01:52:44 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2763, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, processId=1451, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.673 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=Sat May 04 01:52:44 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2763, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, processId=1451, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.686 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2763, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.687 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2763, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:52:43 GMT+08:00 2024, endTime=Sat May 04 01:52:44 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_10/884/2763, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/10/884/2763.log, processId=1451, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:45.688 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2763, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.845 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.845 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.846 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.846 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.865 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.943 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2763] - [INFO] 2024-05-04 01:52:45.944 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:52:43 GMT+08:00 2024
Submit Time:            Sat May 04 01:52:43 GMT+08:00 2024
Start Time:             Sat May 04 01:52:43 GMT+08:00 2024
End Time:               Sat May 04 01:52:44 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:52:45.945 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:52:45.946 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:52:45.953 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 7
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:52:37 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:52:37 GMT+08:00 2024
End Time:                  Sat May 04 01:52:45 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:52:45.953 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:49.650 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:54.683 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:59.102 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8088235294117647 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:59.103 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8088235294117647 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:52:59.103 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:52:59.704 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:00.104 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7074626865671642 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:00.114 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:00.138 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7074626865671642 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:01.117 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7478991596638656 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:01.117 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:01.142 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7478991596638656 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:04.740 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:09.856 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:14.898 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:18.190 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7921686746987951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:18.192 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7921686746987951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:18.193 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:19.918 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:24.949 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:29.966 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:35.022 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:37.288 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7177177177177178 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:37.288 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:37.304 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7177177177177178 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:37.975 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714754045029, reportTime=1714758817550, cpuUsage=0.7439024390243902, jvmMemoryUsage=0.03436594009399414, memoryUsage=0.5624935751406808, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:37.980 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:38.293 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7650602409638554 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:38.295 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:38.335 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7650602409638554 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:39.297 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7053571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:39.297 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:39.336 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7053571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:40.048 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:40.298 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:41.302 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:42.308 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:43.325 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:44.327 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:45.140 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:45.333 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.853329377281473 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:45.348 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:45.361 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.853329377281473 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:46.353 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7267267267267267 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:46.353 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:46.403 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7267267267267267 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:47.356 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:47.991 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:50.203 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:51.367 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7370030581039755 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:53:51.367 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:51.423 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7370030581039755 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.378 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 9ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.412 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.412 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.413 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 8
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.413 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 8, recover flag: NO
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.413 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.413 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.424 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.429 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.444 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.447 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.452 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.455 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2764, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.473 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:52.477 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.477 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.491 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.495 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2764, processInstanceId=884, startTime=1714758832492, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.924 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.931 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.934 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.972 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2764, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.973 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.973 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:52.986 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:52.994 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.042 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2764, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.050 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.598 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=Sat May 04 01:53:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2764, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, processId=1474, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.926 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=Sat May 04 01:53:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2764, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, processId=1474, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.934 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2764, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.934 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2764, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:52 GMT+08:00 2024, endTime=Sat May 04 01:53:53 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2764, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2764.log, processId=1474, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:53.934 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.981 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2764, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.981 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.981 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.981 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.981 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.987 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.988 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2764] - [INFO] 2024-05-04 01:53:53.989 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2765, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:53.992 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:53.993 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:53.993 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:53.993 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2765, taskName=switch, firstSubmitTime=1714758833988, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=11, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2765'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015353'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:53.994 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:53.994 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.012 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.012 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.012 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758834013
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2765
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2765,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758833988,
  "startTime" : 1714758834013,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 11,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2765"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015353"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2765",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.013 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:54.014 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2765, processInstanceId=884, startTime=1714758834013, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:53.993 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:54.010 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:53:52 GMT+08:00 2024
Submit Time:            Sat May 04 01:53:52 GMT+08:00 2024
Start Time:             Sat May 04 01:53:52 GMT+08:00 2024
End Time:               Sat May 04 01:53:53 GMT+08:00 2024

[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}] successfully
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.016 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.016 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.016 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/'"
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.016 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"'local_storage/'" == "local_storage" successfully
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.021 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "'local_storage/'" == "local_storage" successfully: false
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.021 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.021 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.021 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.023 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:54 GMT+08:00 2024, endTime=Sat May 04 01:53:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.023 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.11:5678 successfully
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.024 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.024 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.928 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:53:54.935 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=437), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2765] - [ERROR] 2024-05-04 01:53:54.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:54 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.942 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.942 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:54 GMT+08:00 2024, endTime=Sat May 04 01:53:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:53:54.947 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=438), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2765] - [WARN] 2024-05-04 01:53:54.948 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2765
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.948 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2765, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:54.948 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2765, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:54 GMT+08:00 2024, endTime=Sat May 04 01:53:54 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2765.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:54.948 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.013 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2765, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.014 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.014 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.014 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.014 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.024 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:zxc, task id:null, task code:13481652501568
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.025 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481652501568, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.025 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task zxc is success, so ready to submit to execute
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.026 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : zxc, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2765] - [INFO] 2024-05-04 01:53:55.027 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2766, taskInstanceName: zxc, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.031 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:53:55.032 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:53:53 GMT+08:00 2024
Submit Time:            Sat May 04 01:53:53 GMT+08:00 2024
Start Time:             Sat May 04 01:53:54 GMT+08:00 2024
End Time:               Sat May 04 01:53:54 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:53:55.035 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task zxc to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:55.043 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2766, processInstanceId=884, startTime=1714758835036, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:55.221 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.928 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.932 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.932 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.941 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2766, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.941 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.941 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.944 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2766, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.944 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:55.947 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:55.947 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:56.062 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=Sat May 04 01:53:56 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2766, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, processId=1491, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:56.928 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=Sat May 04 01:53:56 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2766, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, processId=1491, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:56.938 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2766, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:56.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2766, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:53:55 GMT+08:00 2024, endTime=Sat May 04 01:53:56 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_11/884/2766, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/11/884/2766.log, processId=1491, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:53:56.938 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.033 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2766, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.033 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.033 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.034 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.034 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.041 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.041 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481652501568 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2766] - [INFO] 2024-05-04 01:53:57.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              zxc
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:53:55 GMT+08:00 2024
Submit Time:            Sat May 04 01:53:55 GMT+08:00 2024
Start Time:             Sat May 04 01:53:55 GMT+08:00 2024
End Time:               Sat May 04 01:53:56 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:53:57.046 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:53:57.046 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:53:57.047 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 8
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:53:52 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:53:52 GMT+08:00 2024
End Time:                  Sat May 04 01:53:57 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:53:57.048 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:00.294 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:05.308 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:10.370 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:10.659 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.827485380116959 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:10.666 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.827485380116959 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:54:10.667 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:11.668 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7623188405797101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:54:11.669 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:11.688 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7623188405797101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:12.671 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.722840909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:54:12.671 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:12.690 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.722840909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:14.675 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8376068376068376 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:54:14.675 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:14.707 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8376068376068376 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:15.436 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:20.556 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:25.652 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:30.677 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:33.603 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.11:5678 begin to failover hosts:[172.18.0.11:5678]
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:33.637 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.11:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-04 01:54:33.638 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-04 01:54:33.638 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-04 01:54:33.638 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-04 01:54:33.639 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-04 01:54:33.641 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-04 01:54:33.641 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-04 01:54:33.642 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-04 01:54:33.643 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:33.644 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.11:5678] failover finished, useTime:12ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:35.701 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:40.725 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:45.740 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:50.753 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:54:55.766 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:00.777 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:06.481 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:11.565 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:16.588 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:21.604 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:26.620 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:31.642 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:36.667 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:41.683 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:46.712 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:51.734 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:55:56.747 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:01.766 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:04.569 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7515337423312883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:04.573 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:04.721 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7515337423312883 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:05.589 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7637475739575369 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:05.593 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:05.756 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7637475739575369 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:06.785 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:09.613 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8134556574923547 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:09.614 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:09.785 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8134556574923547 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:10.618 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8538011695906432 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:10.618 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:10.865 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8538011695906432 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:11.621 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7506925207756232 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:11.621 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:11.824 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:11.866 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7506925207756232 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:16.664 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7777777777777777 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:16.665 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:16.846 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:16.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7777777777777777 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:19.700 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7560423512230742 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:19.709 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:19.921 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7560423512230742 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:20.716 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.737 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:20.737 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.737 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.738 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 9
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 9, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.741 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.742 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.745 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.746 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.748 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.751 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2767, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:20.756 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:20.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:20.758 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:20.765 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:20.776 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2767, processInstanceId=884, startTime=1714758980770, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.550 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.555 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.555 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.562 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2767, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.562 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.568 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2767, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.568 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.568 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:21.569 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:21.815 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=Sat May 04 01:56:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2767, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, processId=1525, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:21.867 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.552 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=Sat May 04 01:56:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2767, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, processId=1525, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.562 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2767, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2767, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:20 GMT+08:00 2024, endTime=Sat May 04 01:56:21 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2767, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2767.log, processId=1525, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:22.563 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.605 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2767, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.606 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.606 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.606 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.606 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.650 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2767] - [INFO] 2024-05-04 01:56:22.654 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2768, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.659 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:22.661 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2768, taskName=switch, firstSubmitTime=1714758982651, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=12, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2768'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015622'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.662 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.663 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:22.660 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:20 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:20 GMT+08:00 2024
Start Time:             Sat May 04 01:56:20 GMT+08:00 2024
End Time:               Sat May 04 01:56:21 GMT+08:00 2024

[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.673 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.673 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.673 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758982673
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.673 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2768
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.674 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2768,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758982651,
  "startTime" : 1714758982673,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 12,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2768"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015622"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2768",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.674 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:22.679 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:22.679 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2768, processInstanceId=884, startTime=1714758982673, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.680 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.681 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.681 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.682 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.683 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.683 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.683 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.684 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.691 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2768] - [ERROR] 2024-05-04 01:56:22.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2768] - [ERROR] 2024-05-04 01:56:22.692 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2768] - [WARN] 2024-05-04 01:56:22.692 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.709 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:22 GMT+08:00 2024, endTime=Sat May 04 01:56:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.718 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.719 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.719 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:22.721 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.552 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.557 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.557 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:23.562 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=450), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2768] - [ERROR] 2024-05-04 01:56:23.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:22 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.564 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:22 GMT+08:00 2024, endTime=Sat May 04 01:56:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:23.575 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=451), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2768] - [WARN] 2024-05-04 01:56:23.579 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2768
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.580 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2768, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2768, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:22 GMT+08:00 2024, endTime=Sat May 04 01:56:22 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2768.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:23.580 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.665 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2768, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.665 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.666 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.666 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.666 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.666 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.668 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.669 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.669 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.671 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2768] - [INFO] 2024-05-04 01:56:23.672 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2769, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.678 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:23.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:23.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:23.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:23.678 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:22 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:22 GMT+08:00 2024
Start Time:             Sat May 04 01:56:22 GMT+08:00 2024
End Time:               Sat May 04 01:56:22 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:56:23.680 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2769, taskName=switch, firstSubmitTime=1714758983671, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=12, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2769'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015623'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.682 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.682 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:23.686 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.689 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.690 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758983691
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2769
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2769,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758983671,
  "startTime" : 1714758983691,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 12,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2769"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015623"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2769",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:23.693 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2769, processInstanceId=884, startTime=1714758983691, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.694 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.695 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.696 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2769] - [ERROR] 2024-05-04 01:56:23.696 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2769] - [ERROR] 2024-05-04 01:56:23.696 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2769] - [WARN] 2024-05-04 01:56:23.697 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.698 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:23 GMT+08:00 2024, endTime=Sat May 04 01:56:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.699 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.699 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.700 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:23.700 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.566 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.580 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.582 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:24.589 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=455), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2769] - [ERROR] 2024-05-04 01:56:24.593 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:23 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.593 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:23 GMT+08:00 2024, endTime=Sat May 04 01:56:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:24.600 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=456), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 50, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2769] - [WARN] 2024-05-04 01:56:24.603 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2769
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.603 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2769, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.603 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2769, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:23 GMT+08:00 2024, endTime=Sat May 04 01:56:23 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2769.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:24.603 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2769, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.689 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.689 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.690 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.690 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.690 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.692 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.694 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2769] - [INFO] 2024-05-04 01:56:24.696 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2770, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.702 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:24.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:24.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:24.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:24.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:23 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:23 GMT+08:00 2024
Start Time:             Sat May 04 01:56:23 GMT+08:00 2024
End Time:               Sat May 04 01:56:23 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:56:24.704 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2770, taskName=switch, firstSubmitTime=1714758984694, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=12, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2770'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015624'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.704 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.706 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:24.708 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758984712
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2770
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.712 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2770,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758984694,
  "startTime" : 1714758984712,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 12,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2770"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015624"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2770",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.713 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.713 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:24.718 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2770, processInstanceId=884, startTime=1714758984712, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.719 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.720 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.720 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.720 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.720 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.721 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.721 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.721 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.721 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2770] - [ERROR] 2024-05-04 01:56:24.722 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.722 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2770] - [ERROR] 2024-05-04 01:56:24.723 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2770] - [WARN] 2024-05-04 01:56:24.724 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.725 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:24 GMT+08:00 2024, endTime=Sat May 04 01:56:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.726 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.726 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.726 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:24.726 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.577 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.577 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:25.582 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=460), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2770] - [ERROR] 2024-05-04 01:56:25.585 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:24 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.585 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:24 GMT+08:00 2024, endTime=Sat May 04 01:56:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:25.588 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=461), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2770] - [WARN] 2024-05-04 01:56:25.589 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2770
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.589 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2770, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.589 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2770, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:24 GMT+08:00 2024, endTime=Sat May 04 01:56:24 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2770.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:25.590 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.717 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2770, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.718 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.718 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.718 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.718 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.718 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.720 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.723 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2770] - [INFO] 2024-05-04 01:56:25.725 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2771, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.738 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:25.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:25.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:25.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:25.738 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:24 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:24 GMT+08:00 2024
Start Time:             Sat May 04 01:56:24 GMT+08:00 2024
End Time:               Sat May 04 01:56:24 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:56:25.742 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2771, taskName=switch, firstSubmitTime=1714758985723, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=12, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2771'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015625'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''/local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.743 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.744 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.750 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.750 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714758985750
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.750 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2771
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.755 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2771,
  "taskName" : "switch",
  "firstSubmitTime" : 1714758985723,
  "startTime" : 1714758985750,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 12,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2771"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015625"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'/local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2771",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'/local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.755 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.755 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.755 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:25.756 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:25.757 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2771, processInstanceId=884, startTime=1714758985750, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.758 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.759 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.759 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'/local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2771] - [ERROR] 2024-05-04 01:56:25.760 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.760 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2771] - [ERROR] 2024-05-04 01:56:25.761 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2771] - [WARN] 2024-05-04 01:56:25.761 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.762 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:25 GMT+08:00 2024, endTime=Sat May 04 01:56:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.764 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.764 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.764 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:25.765 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.567 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.573 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:26.592 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=465), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2771] - [ERROR] 2024-05-04 01:56:26.596 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:25 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.596 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:25 GMT+08:00 2024, endTime=Sat May 04 01:56:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:56:26.602 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=466), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 77, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2771] - [WARN] 2024-05-04 01:56:26.604 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2771
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.604 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2771, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.604 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2771, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:56:25 GMT+08:00 2024, endTime=Sat May 04 01:56:25 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2771.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:26.604 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.637 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2771, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.637 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.637 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.637 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.637 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.642 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2771] - [INFO] 2024-05-04 01:56:26.644 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2772, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:26.662 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.662 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:56:26.663 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:25 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:25 GMT+08:00 2024
Start Time:             Sat May 04 01:56:25 GMT+08:00 2024
End Time:               Sat May 04 01:56:25 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:56:26.678 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:26.689 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2772, processInstanceId=884, startTime=1714758986682, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:26.910 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.600 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.600 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.613 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2772, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.613 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.614 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.624 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:27.647 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.648 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2772, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.649 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:27.760 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=Sat May 04 01:56:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2772, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, processId=1543, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.581 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=Sat May 04 01:56:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2772, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, processId=1543, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.608 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2772, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.608 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2772, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:56:26 GMT+08:00 2024, endTime=Sat May 04 01:56:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_12/884/2772, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/12/884/2772.log, processId=1543, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'/local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:28.608 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.695 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2772, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.696 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.696 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.696 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.696 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.707 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2772] - [INFO] 2024-05-04 01:56:28.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:56:26 GMT+08:00 2024
Submit Time:            Sat May 04 01:56:26 GMT+08:00 2024
Start Time:             Sat May 04 01:56:26 GMT+08:00 2024
End Time:               Sat May 04 01:56:27 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:56:28.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:56:28.714 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:56:28.719 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 9
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:56:20 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:56:20 GMT+08:00 2024
End Time:                  Sat May 04 01:56:28 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:56:28.719 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:28.803 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7694610778443113 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:28.803 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:28.968 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7694610778443113 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:31.924 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:36.967 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:41.855 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7023121387283237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:41.855 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:42.052 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 25/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:42.063 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7023121387283237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:42.863 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8383233532934132 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:56:42.863 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:43.098 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8383233532934132 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:47.094 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:52.151 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:56:57.164 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:02.178 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:07.194 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:12.223 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:17.237 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:22.288 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:24.044 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7405247813411079 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:24.045 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:24.413 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7405247813411079 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:25.048 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9076923076923077 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:25.049 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:25.501 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.9076923076923077 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:27.320 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:32.356 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:37.376 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:42.391 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:44.156 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8069164265129684 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:44.156 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:44.627 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8069164265129684 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:45.168 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7653958944281525 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:45.177 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:45.645 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7653958944281525 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:47.196 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7817679558011049 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:47.196 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:47.466 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:47.654 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7817679558011049 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:48.562 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:49.200 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:50.202 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:51.204 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:52.213 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8301282051282051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:52.213 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:52.487 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:52.732 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8301282051282051 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:53.214 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:54.237 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:55.238 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:56.239 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:57.244 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.75 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:57.245 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:57.505 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:57:57.775 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.75 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:58.246 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:58.569 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-04 01:57:59.249 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:00.251 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:01.255 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:02.262 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:02.524 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:03.264 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:04.265 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:05.267 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:06.268 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:07.270 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:07.541 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:08.281 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:08.607 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.327 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 43ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.413 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.414 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.435 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.435 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=884)
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 10
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.436 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 10, recover flag: NO
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.444 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.444 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.449 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:fsed, task id:null, task code:13481631725760
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.450 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task fsed is success, so ready to submit to execute
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.456 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : fsed, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.459 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2773, taskInstanceName: fsed, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.468 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:09.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.468 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.473 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task fsed to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.483 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2773, processInstanceId=884, startTime=1714759089479, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.917 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.937 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.947 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2773, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.947 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.947 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:09.958 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:09.959 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2773, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.039 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:10.415 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7386666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:10.416 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.604 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=Sat May 04 01:58:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2773, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, processId=1571, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:10.852 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7386666666666667 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.918 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=Sat May 04 01:58:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2773, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, processId=1571, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.927 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2773, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.927 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2773, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:09 GMT+08:00 2024, endTime=Sat May 04 01:58:10 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2773, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2773.log, processId=1571, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:10.928 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.969 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2773, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.971 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.972 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.972 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:10.972 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:11.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:11.015 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:11.016 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:11.024 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2773] - [INFO] 2024-05-04 01:58:11.026 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2774, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.053 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481631725760 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.054 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:11.055 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2774, taskName=switch, firstSubmitTime=1714759091024, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=13, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2774'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015811'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:11.055 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              fsed
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:09 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:09 GMT+08:00 2024
Start Time:             Sat May 04 01:58:09 GMT+08:00 2024
End Time:               Sat May 04 01:58:10 GMT+08:00 2024

[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.055 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.056 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.083 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.083 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.083 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.084 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759091084
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.084 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2774
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.084 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2774,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759091024,
  "startTime" : 1714759091084,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 13,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2774"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015811"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2774",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.084 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.084 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.085 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:11.081 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:11.086 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2774, processInstanceId=884, startTime=1714759091084, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.088 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.088 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.089 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.093 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.094 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.094 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2774] - [ERROR] 2024-05-04 01:58:11.094 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.097 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.098 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.098 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2774] - [ERROR] 2024-05-04 01:58:11.098 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2774] - [WARN] 2024-05-04 01:58:11.098 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.099 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:11 GMT+08:00 2024, endTime=Sat May 04 01:58:11 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.100 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.100 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.100 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.101 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.919 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.929 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.930 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:11.938 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=478), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2774] - [ERROR] 2024-05-04 01:58:11.941 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:11 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.941 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:11 GMT+08:00 2024, endTime=Sat May 04 01:58:11 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:11.960 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=479), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2774] - [WARN] 2024-05-04 01:58:11.962 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2774
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.963 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2774, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:11.963 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2774, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:11 GMT+08:00 2024, endTime=Sat May 04 01:58:11 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2774.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:11.963 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.089 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2774, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.090 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.090 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.090 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.090 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.090 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.092 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.096 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2774] - [INFO] 2024-05-04 01:58:12.104 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2775, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.116 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:12.117 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:12.117 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:12.118 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:12.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:11 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:11 GMT+08:00 2024
Start Time:             Sat May 04 01:58:11 GMT+08:00 2024
End Time:               Sat May 04 01:58:11 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:58:12.119 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2775, taskName=switch, firstSubmitTime=1714759092097, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=13, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2775'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015812'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.120 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.133 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.143 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.144 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.144 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759092144
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.144 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2775
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.144 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2775,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759092097,
  "startTime" : 1714759092144,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 13,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2775"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015812"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2775",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.145 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.145 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.145 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:12.146 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2775, processInstanceId=884, startTime=1714759092144, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.146 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.146 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2775] - [ERROR] 2024-05-04 01:58:12.147 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.147 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.148 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2775] - [ERROR] 2024-05-04 01:58:12.148 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2775] - [WARN] 2024-05-04 01:58:12.148 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:12.131 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.150 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:12 GMT+08:00 2024, endTime=Sat May 04 01:58:12 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.154 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.154 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.154 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:12.582 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.921 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:12 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:12.927 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=483), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2775] - [ERROR] 2024-05-04 01:58:12.929 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:12 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.930 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.934 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.935 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:12 GMT+08:00 2024, endTime=Sat May 04 01:58:12 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:12.942 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=484), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2775] - [WARN] 2024-05-04 01:58:12.960 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2775
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.961 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2775, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:12.961 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2775, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:12 GMT+08:00 2024, endTime=Sat May 04 01:58:12 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2775.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:12.961 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.021 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2775, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.021 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.021 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.022 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.022 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.022 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.023 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.024 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.024 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.027 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2775] - [INFO] 2024-05-04 01:58:13.030 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2776, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.061 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:13.062 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:13.062 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:13.062 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:13.062 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:12 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:12 GMT+08:00 2024
Start Time:             Sat May 04 01:58:12 GMT+08:00 2024
End Time:               Sat May 04 01:58:12 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:58:13.064 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2776, taskName=switch, firstSubmitTime=1714759093029, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=13, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2776'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015813'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.065 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.065 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.074 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:13.071 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.117 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.118 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759093118
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.118 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2776
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.119 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2776,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759093029,
  "startTime" : 1714759093118,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 13,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2776"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015813"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2776",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.120 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.128 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:13.132 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2776, processInstanceId=884, startTime=1714759093118, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.136 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.137 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.137 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.138 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.138 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.140 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.141 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.142 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.142 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2776] - [ERROR] 2024-05-04 01:58:13.143 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.143 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.143 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.143 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2776] - [ERROR] 2024-05-04 01:58:13.143 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2776] - [WARN] 2024-05-04 01:58:13.144 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.146 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:13 GMT+08:00 2024, endTime=Sat May 04 01:58:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.922 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.928 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.929 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:13.935 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=488), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2776] - [ERROR] 2024-05-04 01:58:13.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:13 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.939 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:13 GMT+08:00 2024, endTime=Sat May 04 01:58:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:13.945 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=489), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2776] - [WARN] 2024-05-04 01:58:13.947 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2776
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.947 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2776, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:13.948 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2776, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:13 GMT+08:00 2024, endTime=Sat May 04 01:58:13 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2776.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:13.948 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2776, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.035 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.037 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:switch, task id:null, task code:13481646211264
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.038 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481646211264, dependTaskCodes: [13481631725760]
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.039 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task switch is success, so ready to submit to execute
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.041 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : switch, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2776] - [INFO] 2024-05-04 01:58:14.043 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2777, taskInstanceName: switch, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.056 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:14.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:14.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:14.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:14.057 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:13 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:13 GMT+08:00 2024
Start Time:             Sat May 04 01:58:13 GMT+08:00 2024
End Time:               Sat May 04 01:58:13 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:58:14.059 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2777, taskName=switch, firstSubmitTime=1714759094041, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.11:5678, host=172.18.0.11:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13481656603328, processDefineVersion=13, appIds=null, processInstanceId=884, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} == 'local_storage'","nextNode":13481650245952}],"nextNode":13481652501568}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='switch'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240504'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2777'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13481646211264'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240504015814'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='884'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value=''local_storage/gnews/in/830-20240503110322.json''}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240503'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='sd'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13481656603328'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.061 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: switch to MasterTaskExecutorThreadPool success
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.061 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.069 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:14.070 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task switch to 172.18.0.11:5678.
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.070 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.071 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.071 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714759094071
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.072 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 884_2777
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.073 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2777,
  "taskName" : "switch",
  "firstSubmitTime" : 1714759094041,
  "startTime" : 1714759094071,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.11:5678",
  "host" : "172.18.0.11:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log",
  "processId" : 0,
  "processDefineCode" : 13481656603328,
  "processDefineVersion" : 13,
  "processInstanceId" : 884,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} == 'local_storage'\",\"nextNode\":13481650245952}],\"nextNode\":13481652501568}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "switch"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2777"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481646211264"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240504015814"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "884"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "'local_storage/gnews/in/830-20240503110322.json'"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "sd"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13481656603328"
    }
  },
  "taskAppId" : "884_2777",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"'local_storage/gnews/in/830-20240503110322.json'\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.074 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.075 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.075 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:14.084 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2777, processInstanceId=884, startTime=1714759094071, taskInstanceHost=172.18.0.11:5678, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.087 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.11:5678
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.088 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13481652501568 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} == 'local_storage'",
    "nextNode" : [ 13481650245952 ]
  } ]
}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.088 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.089 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}] successfully
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.089 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.090 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.090 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} == 'local_storage' 
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.091 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirparamValue:"'local_storage/gnews/in/830-20240503110322.json'"
[WI-884][TI-2777] - [ERROR] 2024-05-04 01:58:14.092 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.093 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.094 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-884][TI-2777] - [ERROR] 2024-05-04 01:58:14.094 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} == 'local_storage'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2777] - [WARN] 2024-05-04 01:58:14.094 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.099 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:14 GMT+08:00 2024, endTime=Sat May 04 01:58:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.102 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.11:5678 successfully
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.102 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.102 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.103 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.929 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.937 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.938 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:14 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:14.944 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=493), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2777] - [ERROR] 2024-05-04 01:58:14.946 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:14 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.946 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:14 GMT+08:00 2024, endTime=Sat May 04 01:58:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [ERROR] 2024-05-04 01:58:14.950 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=494), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 99, 51, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-884][TI-2777] - [WARN] 2024-05-04 01:58:14.952 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2777
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.952 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2777, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.952 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2777, workerAddress=172.18.0.11:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Sat May 04 01:58:14 GMT+08:00 2024, endTime=Sat May 04 01:58:14 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2777.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:14.953 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.962 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2777, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.963 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.963 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.963 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.963 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.967 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:ds, task id:null, task code:13481650245952
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.967 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13481650245952, dependTaskCodes: [13481646211264, 13481631725760]
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.967 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task ds is success, so ready to submit to execute
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.969 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : ds, processInstance id:884, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2777] - [INFO] 2024-05-04 01:58:14.987 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2778, taskInstanceName: ds, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:884, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:14.999 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481646211264 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-884][TI-0] - [INFO] 2024-05-04 01:58:15.000 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              switch
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.11:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:14 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:14 GMT+08:00 2024
Start Time:             Sat May 04 01:58:14 GMT+08:00 2024
End Time:               Sat May 04 01:58:14 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-04 01:58:15.005 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task ds to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:15.013 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2778, processInstanceId=884, startTime=1714759095007, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.11:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.931 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.940 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.941 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.950 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2778, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.950 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.950 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:15.962 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=null, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:15.962 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.007 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2778, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.008 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.057 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=Sat May 04 01:58:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2778, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, processId=1582, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.933 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=Sat May 04 01:58:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2778, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, processId=1582, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.943 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=884, taskInstanceId=2778, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:16.943 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2778, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Sat May 04 01:58:15 GMT+08:00 2024, endTime=Sat May 04 01:58:16 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13481656603328_13/884/2778, logPath=/opt/dolphinscheduler/logs/20240504/13481656603328/13/884/2778.log, processId=1582, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"'local_storage/gnews/in/830-20240503110322.json'"}], cacheTaskInstanceId=0, processInstanceId=884)
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:16.943 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-884] persist events succeeded
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.029 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=884, taskInstanceId=2778, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.029 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.029 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.029 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.029 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.036 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.037 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.043 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13481650245952 state:TaskExecutionStatus{code=7, desc='success'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.043 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-2778] - [INFO] 2024-05-04 01:58:17.044 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              ds
Workflow Instance Name: sd-5-20240504013748190
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Sat May 04 01:58:14 GMT+08:00 2024
Submit Time:            Sat May 04 01:58:14 GMT+08:00 2024
Start Time:             Sat May 04 01:58:15 GMT+08:00 2024
End Time:               Sat May 04 01:58:16 GMT+08:00 2024

[WI-884][TI-null] - [INFO] 2024-05-04 01:58:17.045 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=884, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-884][TI-null] - [INFO] 2024-05-04 01:58:17.045 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-884][TI-null] - [INFO] 2024-05-04 01:58:17.048 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             sd
Workflow Instance Name:    sd-5-20240504013748190
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.11:5678
Is Sub Process:            no
Run Times:                 10
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Sat May 04 01:58:09 GMT+08:00 2024
Work Group:                default
Start Time:                Sat May 04 01:58:09 GMT+08:00 2024
End Time:                  Sat May 04 01:58:17 GMT+08:00 2024

[WI-884][TI-0] - [INFO] 2024-05-04 01:58:17.048 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:17.601 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:22.484 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8012422360248447 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:22.485 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:22.625 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:22.965 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8012422360248447 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:27.644 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:29.543 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8774373259052924 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-04 01:58:29.544 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:30.074 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8774373259052924 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:32.671 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:37.689 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:42.708 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:47.739 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:52.750 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:58:57.799 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:02.836 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:07.861 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:12.941 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:17.965 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:22.986 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:28.002 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:33.024 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:38.116 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:43.138 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:48.149 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:53.224 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-04 01:59:58.283 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 13/ms
