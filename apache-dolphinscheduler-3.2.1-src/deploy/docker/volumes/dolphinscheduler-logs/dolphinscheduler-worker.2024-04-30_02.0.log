[WI-0][TI-2082] - [INFO] 2024-04-30 02:00:00.362 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2082, success=true)
[WI-0][TI-2082] - [INFO] 2024-04-30 02:00:00.410 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2082, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:01.473 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2083, taskName=Persist in postgresql, firstSubmitTime=1714413601454, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=10, appIds=null, processInstanceId=782, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2083'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020001'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='782'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@4c4d0680, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.483 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.483 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.486 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.486 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714413601486
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 782_2083
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2083,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714413601454,
  "startTime" : 1714413601486,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2083.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 10,
  "processInstanceId" : 782,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2083"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020001"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "782"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "782_2083",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.496 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_10/782/2083 check successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.499 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.500 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.500 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.501 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.501 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.501 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.502 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.502 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.502 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.503 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.504 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.504 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:(VARCHAR)
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.504 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-782][TI-2083] - [WARN] 2024-04-30 02:00:01.505 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.531 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=''}}
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.532 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-782][TI-2083] - [ERROR] 2024-04-30 02:00:01.537 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-782][TI-2083] - [ERROR] 2024-04-30 02:00:01.538 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-782][TI-2083] - [ERROR] 2024-04-30 02:00:01.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.538 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2083.log
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.539 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2083.log, fetch way: log 
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.540 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.550 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-782][TI-2083] - [INFO] 2024-04-30 02:00:01.550 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2083] - [INFO] 2024-04-30 02:00:02.365 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2083, success=true)
[WI-0][TI-2083] - [INFO] 2024-04-30 02:00:02.387 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2083, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:03.538 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2084, taskName=Persist in postgresql, firstSubmitTime=1714413603483, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=10, appIds=null, processInstanceId=782, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2084'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020003'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='782'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@30ccb6fe, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.543 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.546 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.556 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.557 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714413603558
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 782_2084
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2084,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714413603483,
  "startTime" : 1714413603558,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2084.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 10,
  "processInstanceId" : 782,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2084"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020003"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "782"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "782_2084",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.562 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.570 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.571 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_10/782/2084 check successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.575 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.576 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.577 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.578 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.578 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.578 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.578 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.578 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.579 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.579 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.580 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.581 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.582 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:(VARCHAR)
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.582 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-782][TI-2084] - [WARN] 2024-04-30 02:00:03.583 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.612 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=''}}
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.613 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-782][TI-2084] - [ERROR] 2024-04-30 02:00:03.619 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-782][TI-2084] - [ERROR] 2024-04-30 02:00:03.620 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-782][TI-2084] - [ERROR] 2024-04-30 02:00:03.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.622 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2084.log
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.623 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/10/782/2084.log, fetch way: log 
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.624 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.630 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-782][TI-2084] - [INFO] 2024-04-30 02:00:03.630 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2084] - [INFO] 2024-04-30 02:00:04.359 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2084, success=true)
[WI-0][TI-2084] - [INFO] 2024-04-30 02:00:04.373 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2084, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:26.459 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7537091988130564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:27.470 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8722222222222222 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:28.474 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8642659279778393 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:29.476 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8725761772853184 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:00:30.481 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7828418230563003 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:34.557 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7308781869688386 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:46.890 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2085, taskName=consume_filtered_data, firstSubmitTime=1714413946875, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2085'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020546'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.905 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.914 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.991 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.997 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.998 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714413946998
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.999 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2085
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:46.999 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2085,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714413946875,
  "startTime" : 1714413946998,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2085.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2085"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020546"
    }
  },
  "taskAppId" : "783_2085",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.000 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.001 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.001 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.010 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.010 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.011 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2085 check successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.014 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.014 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.014 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.014 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.015 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.017 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.019 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.019 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.019 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.020 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2085/783_2085.sh
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:47.031 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 454
[WI-0][TI-2085] - [INFO] 2024-04-30 02:05:47.659 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2085, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:47.662 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7251461988304093 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2085] - [INFO] 2024-04-30 02:05:47.676 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2085)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:48.049 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.060 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2085, processId:454 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.062 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.062 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.063 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.064 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.074 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.075 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.076 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2085
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.077 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2085
[WI-783][TI-2085] - [INFO] 2024-04-30 02:05:48.078 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2085] - [INFO] 2024-04-30 02:05:48.653 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2085, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:48.721 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2086, taskName=process the the sql script with messages, firstSubmitTime=1714413948711, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='process the the sql script with messages'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2086'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020548'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.722 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: process the the sql script with messages to wait queue success
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.723 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714413948724
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2086
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2086,
  "taskName" : "process the the sql script with messages",
  "firstSubmitTime" : 1714413948711,
  "startTime" : 1714413948724,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2086.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\nprint(query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "process the the sql script with messages"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2086"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020548"
    }
  },
  "taskAppId" : "783_2086",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.734 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086 check successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.736 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.737 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)",
  "resourceList" : [ ]
}
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.738 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.739 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086/py_783_2086.py
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.739 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.739 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.740 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.740 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086/py_783_2086.py
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.740 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.740 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086/783_2086.sh
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:48.749 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 465
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:48.750 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-2086] - [INFO] 2024-04-30 02:05:49.680 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2086, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:49.758 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	 INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-0][TI-2086] - [INFO] 2024-04-30 02:05:49.759 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2086)
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.798 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086, processId:465 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.801 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.802 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.802 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.803 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.819 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2086
[WI-783][TI-2086] - [INFO] 2024-04-30 02:05:49.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2086] - [INFO] 2024-04-30 02:05:50.665 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2086, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:50.687 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.825214899713467 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:50.822 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2087, taskName=print query, firstSubmitTime=1714413950798, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2087'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020550'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.825 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.825 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.827 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.828 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714413950828
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2087
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.829 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2087,
  "taskName" : "print query",
  "firstSubmitTime" : 1714413950798,
  "startTime" : 1714413950828,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2087.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2087"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020550"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2087",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.844 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.845 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2087 check successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.847 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.848 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.849 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.850 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.852 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.853 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.855 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.856 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.856 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo 
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.856 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.856 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2087/783_2087.sh
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:50.861 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 476
[WI-0][TI-2087] - [INFO] 2024-04-30 02:05:51.683 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2087, success=true)
[WI-0][TI-2087] - [INFO] 2024-04-30 02:05:51.723 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2087)
[WI-0][TI-0] - [INFO] 2024-04-30 02:05:51.864 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.868 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2087, processId:476 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.870 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.876 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2087
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2087
[WI-783][TI-2087] - [INFO] 2024-04-30 02:05:51.877 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2087] - [INFO] 2024-04-30 02:05:52.676 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2087, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:06:33.008 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7730061349693251 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:21.795 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8184357541899441 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:22.909 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8055555555555556 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:35.010 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8230337078651685 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:36.031 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8388059701492537 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:37.071 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7614942528735633 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:38.084 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7593123209169055 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:39.088 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8304093567251462 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:39.966 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2092, taskName=consume_filtered_data, firstSubmitTime=1714414119953, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2092'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020839'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.968 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.969 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.974 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414119974
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.974 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2092
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.975 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2092,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714414119953,
  "startTime" : 1714414119974,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2092.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2092"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020839"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2092",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.976 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.981 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.983 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2092 check successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.989 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.990 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.990 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.990 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.991 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.992 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.993 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.993 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.993 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.994 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2092/783_2092.sh
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:39.998 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 522
[WI-0][TI-2092] - [INFO] 2024-04-30 02:08:40.862 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2092, success=true)
[WI-0][TI-2092] - [INFO] 2024-04-30 02:08:40.872 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2092)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:41.009 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.011 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2092, processId:522 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.013 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.014 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.014 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.015 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.021 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.024 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2092
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2092
[WI-783][TI-2092] - [INFO] 2024-04-30 02:08:41.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2092] - [INFO] 2024-04-30 02:08:41.870 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2092, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:41.925 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2093, taskName=process the the sql script with messages, firstSubmitTime=1714414121903, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='process the the sql script with messages'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2093'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020841'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.930 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: process the the sql script with messages to wait queue success
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.932 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.934 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.934 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414121935
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2093
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2093,
  "taskName" : "process the the sql script with messages",
  "firstSubmitTime" : 1714414121903,
  "startTime" : 1714414121935,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2093.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\nprint(query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "process the the sql script with messages"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2093"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020841"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2093",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.936 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.936 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.937 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.941 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.942 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.942 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093 check successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.943 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.943 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.944 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)",
  "resourceList" : [ ]
}
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.945 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.945 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.945 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.945 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.945 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.946 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.946 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.946 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093/py_783_2093.py
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.947 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.947 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.947 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.948 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093/py_783_2093.py
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.948 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.948 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093/783_2093.sh
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:41.951 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 533
[WI-0][TI-2093] - [INFO] 2024-04-30 02:08:42.864 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2093, success=true)
[WI-0][TI-2093] - [INFO] 2024-04-30 02:08:42.876 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2093)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:42.952 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	 INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.957 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093, processId:533 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.961 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.962 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.962 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.976 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2093
[WI-783][TI-2093] - [INFO] 2024-04-30 02:08:42.979 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2093] - [INFO] 2024-04-30 02:08:43.863 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2093, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:43.939 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2094, taskName=print query, firstSubmitTime=1714414123910, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2094'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020843'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.946 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.952 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.953 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414123953
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.953 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2094
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.955 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2094,
  "taskName" : "print query",
  "firstSubmitTime" : 1714414123910,
  "startTime" : 1714414123953,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2094.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2094"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020843"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2094",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.959 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.960 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.960 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.965 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2094 check successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.968 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.969 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.969 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.970 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.970 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo 
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.970 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.970 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2094/783_2094.sh
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:43.973 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 544
[WI-0][TI-2094] - [INFO] 2024-04-30 02:08:44.870 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2094, success=true)
[WI-0][TI-2094] - [INFO] 2024-04-30 02:08:44.877 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2094)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:44.974 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.976 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2094, processId:544 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.977 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.981 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.981 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2094
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2094
[WI-783][TI-2094] - [INFO] 2024-04-30 02:08:44.982 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2094] - [INFO] 2024-04-30 02:08:45.872 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2094, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:45.966 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2095, taskName=Persist in postgresql, firstSubmitTime=1714414125953, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2095'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020845'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6d8c715c, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.967 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.968 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.969 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.970 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414125970
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2095
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2095,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714414125953,
  "startTime" : 1714414125970,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2095.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2095"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020845"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2095",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.972 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.976 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.976 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2095 check successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.977 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.978 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.978 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.979 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.979 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.979 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.980 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.980 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.980 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2095] - [WARN] 2024-04-30 02:08:45.981 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:45.997 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.001 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2095] - [ERROR] 2024-04-30 02:08:46.004 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2095] - [ERROR] 2024-04-30 02:08:46.004 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2095] - [ERROR] 2024-04-30 02:08:46.005 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.007 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2095.log
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.008 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2095.log, fetch way: log 
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.009 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.009 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.012 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2095] - [INFO] 2024-04-30 02:08:46.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2095] - [INFO] 2024-04-30 02:08:46.877 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2095, success=true)
[WI-0][TI-2095] - [INFO] 2024-04-30 02:08:46.886 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2095, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:47.979 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2096, taskName=Persist in postgresql, firstSubmitTime=1714414127965, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2096'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020847'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@41ef323d, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.981 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.982 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.986 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.986 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414127986
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.986 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2096
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.987 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2096,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714414127965,
  "startTime" : 1714414127986,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2096.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2096"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020847"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2096",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.987 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.992 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.992 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.993 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2096 check successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.993 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.993 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.994 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.994 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.995 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.995 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.995 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.996 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.996 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:47.996 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2096] - [WARN] 2024-04-30 02:08:47.996 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.012 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.012 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2096] - [ERROR] 2024-04-30 02:08:48.014 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2096] - [ERROR] 2024-04-30 02:08:48.015 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2096] - [ERROR] 2024-04-30 02:08:48.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.017 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2096.log
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.017 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2096.log, fetch way: log 
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.018 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.019 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.022 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2096] - [INFO] 2024-04-30 02:08:48.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2096] - [INFO] 2024-04-30 02:08:48.924 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2096, success=true)
[WI-0][TI-2096] - [INFO] 2024-04-30 02:08:48.945 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2096, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:50.097 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2097, taskName=Persist in postgresql, firstSubmitTime=1714414130030, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2097'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020850'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1f852bea, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.105 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.109 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.130 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.130 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414130131
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2097
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2097,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714414130030,
  "startTime" : 1714414130131,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2097.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2097"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020850"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2097",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.132 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.134 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.146 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.147 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.147 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2097 check successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.149 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.150 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.151 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.151 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.152 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.152 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.152 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2097] - [WARN] 2024-04-30 02:08:50.153 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.197 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.198 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2097] - [ERROR] 2024-04-30 02:08:50.200 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2097] - [ERROR] 2024-04-30 02:08:50.206 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2097] - [ERROR] 2024-04-30 02:08:50.206 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.207 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2097.log
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.207 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2097.log, fetch way: log 
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.208 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.208 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.217 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2097] - [INFO] 2024-04-30 02:08:50.218 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2097] - [INFO] 2024-04-30 02:08:50.897 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2097, success=true)
[WI-0][TI-2097] - [INFO] 2024-04-30 02:08:50.915 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2097, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:08:52.084 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2098, taskName=Persist in postgresql, firstSubmitTime=1714414132011, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2098'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430020852'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1fa1dfd2, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.097 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.099 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.113 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.114 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.115 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714414132115
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2098
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.141 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2098,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714414132011,
  "startTime" : 1714414132115,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2098.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2098"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430020852"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2098",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.145 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.145 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.168 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.169 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2098 check successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.170 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.172 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.177 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.187 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.190 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.190 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.190 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.191 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.191 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.191 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.191 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.195 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.198 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.198 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.199 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2098] - [WARN] 2024-04-30 02:08:52.201 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.231 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.231 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2098] - [ERROR] 2024-04-30 02:08:52.235 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2098] - [ERROR] 2024-04-30 02:08:52.235 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2098] - [ERROR] 2024-04-30 02:08:52.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.236 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2098.log
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.236 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2098.log, fetch way: log 
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.242 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.251 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.280 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2098] - [INFO] 2024-04-30 02:08:52.281 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2098] - [INFO] 2024-04-30 02:08:52.921 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2098, success=true)
[WI-0][TI-2098] - [INFO] 2024-04-30 02:08:52.980 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2098, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:00.185 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7331378299120235 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:08.719 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7395209580838323 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:09.798 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8163205220020688 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:10.800 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7869822485207101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:12.815 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7265415549597856 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:17.880 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7064220183486238 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:18.920 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.861963190184049 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:09:23.975 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7098765432098766 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:10:57.883 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8227513227513228 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:10:58.897 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8935483870967742 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:49.624 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2099, taskName=consume_filtered_data, firstSubmitTime=1714415629591, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2099'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023349'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.644 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.644 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.711 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415629712
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2099
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.714 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2099,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714415629591,
  "startTime" : 1714415629712,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2099.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2099"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023349"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2099",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.733 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2099 check successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.737 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.738 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.739 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.739 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.740 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.741 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.741 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2099/783_2099.sh
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:49.762 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 860
[WI-0][TI-2099] - [INFO] 2024-04-30 02:33:50.619 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2099, success=true)
[WI-0][TI-2099] - [INFO] 2024-04-30 02:33:50.631 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2099)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:50.688 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7492795389048991 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:50.763 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.768 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2099, processId:860 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.771 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.773 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.774 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.779 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2099
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2099
[WI-783][TI-2099] - [INFO] 2024-04-30 02:33:50.780 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2099] - [INFO] 2024-04-30 02:33:51.621 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2099, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:51.740 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2100, taskName=process the the sql script with messages, firstSubmitTime=1714415631729, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='process the the sql script with messages'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2100'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023351'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.743 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: process the the sql script with messages to wait queue success
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.745 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.745 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415631745
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.746 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2100
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.746 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2100,
  "taskName" : "process the the sql script with messages",
  "firstSubmitTime" : 1714415631729,
  "startTime" : 1714415631745,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2100.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\nprint(query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "process the the sql script with messages"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2100"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023351"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2100",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.746 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.746 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.747 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.754 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.754 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.755 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100 check successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.755 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.755 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.755 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.756 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.756 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\nprint(query)",
  "resourceList" : [ ]
}
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.758 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.761 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.762 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100/py_783_2100.py
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.762 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'
print(query)
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.763 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.763 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.763 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100/py_783_2100.py
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.763 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.763 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100/783_2100.sh
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:51.773 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 871
[WI-0][TI-2100] - [INFO] 2024-04-30 02:33:52.644 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2100, success=true)
[WI-0][TI-2100] - [INFO] 2024-04-30 02:33:52.708 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2100)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:52.778 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	 INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.795 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100, processId:871 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.801 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2100
[WI-783][TI-2100] - [INFO] 2024-04-30 02:33:52.813 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2100] - [INFO] 2024-04-30 02:33:53.646 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2100, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:53.731 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7285714285714285 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:53.756 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2101, taskName=print query, firstSubmitTime=1714415633701, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2101'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023353'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.763 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.763 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.766 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415633766
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.766 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2101
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.767 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2101,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415633701,
  "startTime" : 1714415633766,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2101.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2101"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023353"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2101",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.769 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.785 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2101 check successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.786 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.787 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.787 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.787 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.790 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.791 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.792 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.792 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.792 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo 
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.792 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.792 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2101/783_2101.sh
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:53.835 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 882
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:53.836 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-2101] - [INFO] 2024-04-30 02:33:54.863 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2101, success=true)
[WI-0][TI-2101] - [INFO] 2024-04-30 02:33:54.873 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2101)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:54.877 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.879 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2101, processId:882 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.879 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.880 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.880 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.893 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2101
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2101
[WI-783][TI-2101] - [INFO] 2024-04-30 02:33:54.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2101] - [INFO] 2024-04-30 02:33:55.682 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2101, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:55.790 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2102, taskName=Persist in postgresql, firstSubmitTime=1714415635776, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2102'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023355'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@102443c8, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.866 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:55.866 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7459893048128341 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.868 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.870 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.871 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.871 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415635874
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2102
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.875 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2102,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714415635776,
  "startTime" : 1714415635874,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2102.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2102"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023355"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2102",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.878 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.878 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.878 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.902 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2102 check successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.913 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.917 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.927 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.932 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.932 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.947 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.947 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.947 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.958 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.959 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:55.960 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2102] - [WARN] 2024-04-30 02:33:55.961 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.011 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.013 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2102] - [ERROR] 2024-04-30 02:33:56.015 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2102] - [ERROR] 2024-04-30 02:33:56.016 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2102] - [ERROR] 2024-04-30 02:33:56.016 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.016 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2102.log
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.016 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2102.log, fetch way: log 
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.017 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.017 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2102] - [INFO] 2024-04-30 02:33:56.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2102] - [INFO] 2024-04-30 02:33:56.718 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2102, success=true)
[WI-0][TI-2102] - [INFO] 2024-04-30 02:33:56.743 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2102, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:56.883 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8603988603988604 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:33:57.848 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2103, taskName=Persist in postgresql, firstSubmitTime=1714415637837, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2103'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023357'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@5d8ec0f2, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.850 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415637855
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2103
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.855 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2103,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714415637837,
  "startTime" : 1714415637855,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2103.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2103"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023357"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2103",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.856 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.873 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.873 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2103 check successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.874 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.875 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.875 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.890 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.895 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.895 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.895 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2103] - [WARN] 2024-04-30 02:33:57.896 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.944 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.945 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2103] - [ERROR] 2024-04-30 02:33:57.949 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2103] - [ERROR] 2024-04-30 02:33:57.950 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2103] - [ERROR] 2024-04-30 02:33:57.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.951 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2103.log
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.952 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2103.log, fetch way: log 
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.953 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.954 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2103] - [INFO] 2024-04-30 02:33:57.958 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2103] - [INFO] 2024-04-30 02:33:58.836 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2103, success=true)
[WI-0][TI-2103] - [INFO] 2024-04-30 02:33:58.847 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2103, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:00.030 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2104, taskName=Persist in postgresql, firstSubmitTime=1714415639979, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2104'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023400'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@70214f9f, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.032 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.033 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.035 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.035 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415640036
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.036 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2104
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2104,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714415639979,
  "startTime" : 1714415640036,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2104.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2104"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023400"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2104",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.039 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.048 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.049 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.050 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2104 check successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.050 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.051 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.051 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.051 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.052 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.053 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.053 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.054 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2104] - [WARN] 2024-04-30 02:34:00.054 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.087 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.087 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2104] - [ERROR] 2024-04-30 02:34:00.090 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2104] - [ERROR] 2024-04-30 02:34:00.090 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2104] - [ERROR] 2024-04-30 02:34:00.090 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.090 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2104.log
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.091 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2104.log, fetch way: log 
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.092 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.092 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.099 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2104] - [INFO] 2024-04-30 02:34:00.100 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2104] - [INFO] 2024-04-30 02:34:00.819 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2104, success=true)
[WI-0][TI-2104] - [INFO] 2024-04-30 02:34:00.827 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2104, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:02.007 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2105, taskName=Persist in postgresql, firstSubmitTime=1714415641909, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=11, appIds=null, processInstanceId=783, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=''}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2105'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023401'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='783'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@34826a8b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":""}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415642038
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 783_2105
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.038 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2105,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714415641909,
  "startTime" : 1714415642038,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2105.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 11,
  "processInstanceId" : 783,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : ""
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2105"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023401"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "783"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "783_2105",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.029 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.051 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.054 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.055 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.139 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.144 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_11/783/2105 check successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.148 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.148 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.154 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":""}] successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.156 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.156 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT * , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=''}] ,query max result limit  0
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.159 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.159 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.159 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-783][TI-2105] - [WARN] 2024-04-30 02:34:02.195 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.244 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *, sql parameters : {}
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.247 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
[WI-783][TI-2105] - [ERROR] 2024-04-30 02:34:02.251 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: SELECT * with no tables specified is not valid
  Position: 8
[WI-783][TI-2105] - [ERROR] 2024-04-30 02:34:02.251 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-783][TI-2105] - [ERROR] 2024-04-30 02:34:02.252 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: SELECT * with no tables specified is not valid
  Position: 8
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.252 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2105.log
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.252 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/11/783/2105.log, fetch way: log 
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.253 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.253 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.297 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-783][TI-2105] - [INFO] 2024-04-30 02:34:02.298 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2105] - [INFO] 2024-04-30 02:34:02.851 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2105, success=true)
[WI-0][TI-2105] - [INFO] 2024-04-30 02:34:02.908 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2105, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:02.932 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7222222222222221 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:19.027 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9777777777777779 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:50.189 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7327586206896551 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:51.229 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7131147540983607 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:53.258 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8444444444444443 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:55.347 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8911174785100286 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:56.500 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7528409090909091 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:57.511 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8051575420587397 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:34:58.527 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8090046340379611 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:04.594 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8953846153846154 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:05.625 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7707736389684814 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:06.628 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9047619047619048 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:08.652 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7828571428571428 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:28.735 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.828080229226361 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:29.769 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7906808710848233 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:30.771 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9111111111111111 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:35.791 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7129909365558912 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:41.854 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7764350453172205 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:35:59.971 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7042682926829269 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:36:57.366 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7077363896848137 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:36:58.422 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7204301075268817 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:04.682 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2106, taskName=consume_filtered_data, firstSubmitTime=1714415824671, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2106'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023704'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.683 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.685 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.712 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.713 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.714 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415824714
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.714 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2106
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.715 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2106,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714415824671,
  "startTime" : 1714415824714,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2106.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2106"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023704"
    }
  },
  "taskAppId" : "784_2106",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.715 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.719 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2106 check successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.725 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.725 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.726 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.726 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.727 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.728 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.729 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.730 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2106/784_2106.sh
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:04.734 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 930
[WI-0][TI-2106] - [INFO] 2024-04-30 02:37:05.483 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2106, success=true)
[WI-0][TI-2106] - [INFO] 2024-04-30 02:37:05.489 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2106)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:05.737 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.742 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2106, processId:930 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.742 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.743 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2106
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.754 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2106
[WI-784][TI-2106] - [INFO] 2024-04-30 02:37:05.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2106] - [INFO] 2024-04-30 02:37:06.478 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2106, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:06.568 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2107, taskName=process the the sql script with messages, firstSubmitTime=1714415826560, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='process the the sql script with messages'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2107'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023706'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.570 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: process the the sql script with messages to wait queue success
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.572 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.572 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415826572
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2107
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2107,
  "taskName" : "process the the sql script with messages",
  "firstSubmitTime" : 1714415826560,
  "startTime" : 1714415826572,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2107.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\n\\n\\nprint('#{setValue(query=%s)}' % query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "process the the sql script with messages"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2107"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023706"
    }
  },
  "taskAppId" : "784_2107",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.574 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.579 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.579 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.580 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107 check successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.580 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.580 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.581 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.581 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)",
  "resourceList" : [ ]
}
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.582 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.583 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.583 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107/py_784_2107.py
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.583 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.584 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.585 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.585 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107/py_784_2107.py
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.585 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.585 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107/784_2107.sh
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:06.592 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 941
[WI-0][TI-2107] - [INFO] 2024-04-30 02:37:07.492 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2107, success=true)
[WI-0][TI-2107] - [INFO] 2024-04-30 02:37:07.506 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2107)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:07.597 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(query= INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');)}
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.603 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107, processId:941 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.605 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.606 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.606 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.611 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2107
[WI-784][TI-2107] - [INFO] 2024-04-30 02:37:07.613 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:08.467 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.789156626506024 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2107] - [INFO] 2024-04-30 02:37:08.495 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2107, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:08.650 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2108, taskName=print query, firstSubmitTime=1714415828635, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2108'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023708'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.653 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.653 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.654 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415828655
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2108
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2108,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415828635,
  "startTime" : 1714415828655,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2108.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2108"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023708"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "784_2108",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.655 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.656 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.656 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.680 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108 check successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.682 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.683 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.684 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.695 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.696 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.696 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.713 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.714 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.715 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.715 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.715 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.715 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.715 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108/784_2108.sh
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:08.730 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 952
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:09.482 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8681318681318682 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2108] - [INFO] 2024-04-30 02:37:09.514 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2108, success=true)
[WI-0][TI-2108] - [INFO] 2024-04-30 02:37:09.531 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2108)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:09.731 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108/784_2108.sh: line 5: syntax error near unexpected token `('
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108/784_2108.sh: line 5: `echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.738 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108, processId:952 ,exitStatusCode:2 ,processWaitForStatus:true ,processExitValue:2
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.739 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.740 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.757 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.758 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.760 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.762 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2108
[WI-784][TI-2108] - [INFO] 2024-04-30 02:37:09.762 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:10.484 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8083333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2108] - [INFO] 2024-04-30 02:37:10.495 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2108, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:10.567 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2109, taskName=print query, firstSubmitTime=1714415830542, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2109'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023710'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.569 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.570 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.572 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.572 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415830573
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.573 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2109
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.574 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2109,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415830542,
  "startTime" : 1714415830573,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2109.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2109"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023710"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "784_2109",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.576 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.576 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.578 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.584 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.586 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109 check successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.590 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.591 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.592 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.592 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.592 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.596 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.597 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.597 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.602 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.603 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.603 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109/784_2109.sh
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:10.634 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 962
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:11.485 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8988095238095237 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2109] - [INFO] 2024-04-30 02:37:11.520 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2109, success=true)
[WI-0][TI-2109] - [INFO] 2024-04-30 02:37:11.535 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2109)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:11.650 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109/784_2109.sh: line 5: syntax error near unexpected token `('
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109/784_2109.sh: line 5: `echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.663 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109, processId:962 ,exitStatusCode:2 ,processWaitForStatus:true ,processExitValue:2
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.664 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.665 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.672 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2109
[WI-784][TI-2109] - [INFO] 2024-04-30 02:37:11.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:12.508 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9690140845070423 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2109] - [INFO] 2024-04-30 02:37:12.532 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2109, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:12.674 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2110, taskName=print query, firstSubmitTime=1714415832651, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2110'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023712'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.675 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.675 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.678 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.679 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415832679
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2110
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.679 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2110,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415832651,
  "startTime" : 1714415832679,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2110.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2110"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023712"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "784_2110",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.680 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.680 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.680 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110 check successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.728 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.735 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.735 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.735 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.735 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.736 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.736 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.736 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.736 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.736 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.737 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110/784_2110.sh
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:12.803 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 972
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:13.509 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2110] - [INFO] 2024-04-30 02:37:13.591 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2110, success=true)
[WI-0][TI-2110] - [INFO] 2024-04-30 02:37:13.645 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2110)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:13.799 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110/784_2110.sh: line 5: syntax error near unexpected token `('
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110/784_2110.sh: line 5: `echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.801 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110, processId:972 ,exitStatusCode:2 ,processWaitForStatus:true ,processExitValue:2
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.802 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.802 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.802 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.802 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.809 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2110
[WI-784][TI-2110] - [INFO] 2024-04-30 02:37:13.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:14.511 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8132530120481928 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2110] - [INFO] 2024-04-30 02:37:14.524 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2110, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:14.689 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2111, taskName=print query, firstSubmitTime=1714415834664, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=12, appIds=null, processInstanceId=784, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo ${query}","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2111'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023714'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='784'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.690 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.692 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.693 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415834693
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.693 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 784_2111
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.693 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2111,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415834664,
  "startTime" : 1714415834693,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/12/784/2111.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 12,
  "processInstanceId" : 784,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo ${query}\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2111"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023714"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "784"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "784_2111",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.694 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.694 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.694 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.699 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.700 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.700 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111 check successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.701 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.706 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.707 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo ${query}",
  "resourceList" : [ ]
}
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.710 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.711 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.711 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.711 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.711 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111/784_2111.sh
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:14.721 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 982
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:14.762 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-2111] - [INFO] 2024-04-30 02:37:15.559 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2111, success=true)
[WI-0][TI-2111] - [INFO] 2024-04-30 02:37:15.572 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2111)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:15.774 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111/784_2111.sh: line 5: syntax error near unexpected token `('
	/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111/784_2111.sh: line 5: `echo  INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.777 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111, processId:982 ,exitStatusCode:2 ,processWaitForStatus:true ,processExitValue:2
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.778 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.778 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.778 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.778 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_12/784/2111
[WI-784][TI-2111] - [INFO] 2024-04-30 02:37:15.785 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2111] - [INFO] 2024-04-30 02:37:16.551 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2111, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:18.588 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7462686567164178 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:19.648 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7971830985915493 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:37:20.649 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9075552008512903 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:41.670 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7824773413897281 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:42.791 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8078947368421052 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:47.823 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7689969604863223 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:48.896 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7378917378917379 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:49.747 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2112, taskName=consume_filtered_data, firstSubmitTime=1714415929737, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=13, appIds=null, processInstanceId=785, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='785'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2112'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023849'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.749 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.749 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.752 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.752 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415929752
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.752 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 785_2112
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.753 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2112,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714415929737,
  "startTime" : 1714415929752,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/13/785/2112.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 13,
  "processInstanceId" : 785,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "785"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2112"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023849"
    }
  },
  "taskAppId" : "785_2112",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.757 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.757 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.757 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.762 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.763 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2112 check successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.764 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.765 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.766 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.766 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2112/785_2112.sh
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:49.774 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1010
[WI-0][TI-2112] - [INFO] 2024-04-30 02:38:50.669 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2112, success=true)
[WI-0][TI-2112] - [INFO] 2024-04-30 02:38:50.686 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2112)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:50.776 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.779 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2112, processId:1010 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.783 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.784 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.784 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.827 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.827 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.827 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2112
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2112
[WI-785][TI-2112] - [INFO] 2024-04-30 02:38:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2112] - [INFO] 2024-04-30 02:38:51.648 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2112, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:51.702 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2113, taskName=process the the sql script with messages, firstSubmitTime=1714415931692, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=13, appIds=null, processInstanceId=785, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='process the the sql script with messages'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='785'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2113'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023851'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.704 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: process the the sql script with messages to wait queue success
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.706 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415931707
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 785_2113
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2113,
  "taskName" : "process the the sql script with messages",
  "firstSubmitTime" : 1714415931692,
  "startTime" : 1714415931707,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/13/785/2113.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 13,
  "processInstanceId" : 785,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\n\\n\\nprint('#{setValue(query=%s)}' % query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "process the the sql script with messages"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "785"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2113"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023851"
    }
  },
  "taskAppId" : "785_2113",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.707 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.708 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.712 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.713 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113 check successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.720 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.721 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.722 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)",
  "resourceList" : [ ]
}
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.724 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.724 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.725 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.726 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113/py_785_2113.py
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.726 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.728 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.728 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.728 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113/py_785_2113.py
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.728 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.728 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113/785_2113.sh
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:51.732 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1027
[WI-0][TI-2113] - [INFO] 2024-04-30 02:38:52.650 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2113, success=true)
[WI-0][TI-2113] - [INFO] 2024-04-30 02:38:52.658 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2113)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:52.734 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(query= INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');)}
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.739 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113, processId:1027 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.740 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.741 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.743 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.744 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.744 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.744 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2113
[WI-785][TI-2113] - [INFO] 2024-04-30 02:38:52.745 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2113] - [INFO] 2024-04-30 02:38:53.657 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2113, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:53.792 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2114, taskName=print query, firstSubmitTime=1714415933779, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=13, appIds=null, processInstanceId=785, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"echo \"${query}\"","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='print query'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2114'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13437866193984'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023853'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='785'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.796 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: print query to wait queue success
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.796 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.798 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.798 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.799 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415933799
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.799 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 785_2114
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.799 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2114,
  "taskName" : "print query",
  "firstSubmitTime" : 1714415933779,
  "startTime" : 1714415933799,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/13/785/2114.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 13,
  "processInstanceId" : 785,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"echo \\\"${query}\\\"\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "print query"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2114"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13437866193984"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023853"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "785"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "785_2114",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.800 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.809 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2114 check successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.810 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "echo \"${query}\"",
  "resourceList" : [ ]
}
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.811 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.812 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
echo " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.813 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.813 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2114/785_2114.sh
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:53.827 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1038
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:53.828 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-2114] - [INFO] 2024-04-30 02:38:54.682 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2114, success=true)
[WI-0][TI-2114] - [INFO] 2024-04-30 02:38:54.716 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2114)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:54.834 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	 INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.836 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2114, processId:1038 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.839 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.866 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.867 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.867 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2114
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2114
[WI-785][TI-2114] - [INFO] 2024-04-30 02:38:54.868 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2114] - [INFO] 2024-04-30 02:38:55.668 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2114, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:55.714 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2115, taskName=Persist in postgresql, firstSubmitTime=1714415935706, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=13, appIds=null, processInstanceId=785, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"SELECT *\nFROM filtered_data_persistence;","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='Persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2115'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430023855'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='785'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@2a6da1a6, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.716 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: Persist in postgresql to wait queue success
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.716 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714415935718
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 785_2115
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.718 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2115,
  "taskName" : "Persist in postgresql",
  "firstSubmitTime" : 1714415935706,
  "startTime" : 1714415935718,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/13/785/2115.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 13,
  "processInstanceId" : 785,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"SELECT *\\nFROM filtered_data_persistence;\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "Persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2115"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430023855"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "785"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "785_2115",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.719 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.722 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.723 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2115 check successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.724 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.725 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.727 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.728 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "SELECT *\nFROM filtered_data_persistence;",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.729 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.729 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.730 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.731 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.731 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='SELECT *
FROM filtered_data_persistence;', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.731 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : SELECT *
FROM filtered_data_persistence; , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.734 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM filtered_data_persistence
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.734 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.735 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-785][TI-2115] - [WARN] 2024-04-30 02:38:55.735 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.754 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM filtered_data_persistence, sql parameters : {}
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.754 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM filtered_data_persistence
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.764 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 0 rows as follows:
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.772 +0800 o.a.d.p.t.s.SqlTask:[288] - sql query results is empty
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.775 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.775 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.775 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.775 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2115
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.783 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_13/785/2115
[WI-785][TI-2115] - [INFO] 2024-04-30 02:38:55.784 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2115] - [INFO] 2024-04-30 02:38:56.716 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2115, success=true)
[WI-0][TI-2115] - [INFO] 2024-04-30 02:38:56.757 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2115, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:57.468 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7042682926829268 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:38:59.520 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7790368271954674 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:39:03.625 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.850828729281768 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:39:09.684 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9203539823008849 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:39:13.715 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.719626168224299 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:48:34.604 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.836858006042296 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:48:35.659 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8267045454545454 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:48:36.660 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8005865102639296 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:51:09.448 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7847025495750708 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:01.876 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.703118235930736 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:04.026 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7172774869109947 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:07.064 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8219584569732937 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:18.100 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2116, taskName=consume_filtered_data, firstSubmitTime=1714416738089, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2116'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025218'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.105 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.106 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.114 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.114 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.114 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.115 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416738115
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.115 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2116
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.116 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2116,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714416738089,
  "startTime" : 1714416738115,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2116.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2116"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025218"
    }
  },
  "taskAppId" : "786_2116",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.116 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.117 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.120 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.122 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.124 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2116 check successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.125 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.126 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.126 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.126 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.126 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.128 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.133 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.133 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.134 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2116/786_2116.sh
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:18.146 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1206
[WI-0][TI-2116] - [INFO] 2024-04-30 02:52:18.159 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2116, success=true)
[WI-0][TI-2116] - [INFO] 2024-04-30 02:52:18.184 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2116)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:19.149 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.154 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2116, processId:1206 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.156 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.157 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:19.158 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7593123209169055 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.163 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2116
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.164 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2116
[WI-786][TI-2116] - [INFO] 2024-04-30 02:52:19.165 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2116] - [INFO] 2024-04-30 02:52:20.151 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2116, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:20.286 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2117, taskName=create sql script, firstSubmitTime=1714416740274, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='create sql script'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2117'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025220'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.289 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: create sql script to wait queue success
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.289 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.291 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.292 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.292 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.292 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416740292
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.293 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2117
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.293 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2117,
  "taskName" : "create sql script",
  "firstSubmitTime" : 1714416740274,
  "startTime" : 1714416740292,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2117.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\n\\n\\nprint('#{setValue(query=%s)}' % query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "create sql script"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2117"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025220"
    }
  },
  "taskAppId" : "786_2117",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.294 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.295 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.295 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.299 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.300 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.301 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117 check successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.318 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.319 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.319 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.320 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)",
  "resourceList" : [ ]
}
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.321 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.322 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.323 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117/py_786_2117.py
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.323 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.324 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.324 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.324 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117/py_786_2117.py
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.324 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.325 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117/786_2117.sh
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:20.331 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1217
[WI-0][TI-2117] - [INFO] 2024-04-30 02:52:21.182 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2117, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:21.183 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.709480122324159 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2117] - [INFO] 2024-04-30 02:52:21.218 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2117)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:21.334 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(query= INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');)}
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.339 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117, processId:1217 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.341 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.342 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.356 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.358 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.359 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.361 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2117
[WI-786][TI-2117] - [INFO] 2024-04-30 02:52:21.362 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:22.252 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8609825927622536 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2117] - [INFO] 2024-04-30 02:52:22.269 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2117, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:22.405 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2118, taskName=persist in postgresql, firstSubmitTime=1714416742372, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2118'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025222'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@7a941043, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.407 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.407 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.410 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.410 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.411 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.411 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416742411
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.411 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2118
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.412 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2118,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416742372,
  "startTime" : 1714416742411,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2118.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2118"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025222"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2118",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.415 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.430 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.431 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.432 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2118 check successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.433 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.433 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.434 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.434 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.435 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.437 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.437 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.437 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.437 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2118] - [WARN] 2024-04-30 02:52:22.438 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.503 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.504 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2118] - [ERROR] 2024-04-30 02:52:22.507 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2118] - [ERROR] 2024-04-30 02:52:22.508 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2118] - [ERROR] 2024-04-30 02:52:22.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.508 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2118.log
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.508 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2118.log, fetch way: log 
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.509 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.509 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2118] - [INFO] 2024-04-30 02:52:22.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2118] - [INFO] 2024-04-30 02:52:23.180 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2118, success=true)
[WI-0][TI-2118] - [INFO] 2024-04-30 02:52:23.200 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2118, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:23.262 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7271001130422495 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:24.330 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2119, taskName=persist in postgresql, firstSubmitTime=1714416744302, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2119'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025224'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@77349a4b, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.337 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416744340
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2119
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.341 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2119,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416744302,
  "startTime" : 1714416744340,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2119.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2119"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025224"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2119",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.342 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.350 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.351 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2119 check successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.352 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.353 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.354 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.354 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.355 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.355 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.355 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.355 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2119] - [WARN] 2024-04-30 02:52:24.356 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.409 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.409 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2119] - [ERROR] 2024-04-30 02:52:24.412 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2119] - [ERROR] 2024-04-30 02:52:24.413 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2119] - [ERROR] 2024-04-30 02:52:24.413 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.413 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2119.log
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.414 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2119.log, fetch way: log 
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.414 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.415 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.420 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2119] - [INFO] 2024-04-30 02:52:24.421 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2119] - [INFO] 2024-04-30 02:52:25.177 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2119, success=true)
[WI-0][TI-2119] - [INFO] 2024-04-30 02:52:25.187 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2119, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:25.341 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7891373801916932 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:26.308 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2120, taskName=persist in postgresql, firstSubmitTime=1714416746277, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2120'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025226'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6770d2f2, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.310 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.312 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.316 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.317 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416746317
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.317 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2120
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.320 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2120,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416746277,
  "startTime" : 1714416746317,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2120.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2120"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025226"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2120",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.321 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.322 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.334 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.335 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2120 check successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.336 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.336 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.337 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.344 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.345 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.345 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.350 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.358 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.359 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.359 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2120] - [WARN] 2024-04-30 02:52:26.361 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:26.411 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9549071618037136 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.407 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.424 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2120] - [ERROR] 2024-04-30 02:52:26.427 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2120] - [ERROR] 2024-04-30 02:52:26.428 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2120] - [ERROR] 2024-04-30 02:52:26.428 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.428 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2120.log
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.428 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2120.log, fetch way: log 
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.429 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.429 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.439 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2120] - [INFO] 2024-04-30 02:52:26.454 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2120] - [INFO] 2024-04-30 02:52:27.214 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2120, success=true)
[WI-0][TI-2120] - [INFO] 2024-04-30 02:52:27.223 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2120, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:27.428 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9195402298850575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:28.450 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8470588235294118 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:29.455 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8488372093023256 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:37.485 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.793002915451895 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:40.587 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8190789473684211 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:48.891 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2122, taskName=consume_filtered_data, firstSubmitTime=1714416768873, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=OUT, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2122'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025248'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"OUT","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.894 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.894 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.899 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416768900
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2122
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2122,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714416768873,
  "startTime" : 1714416768900,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2122.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2122"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025248"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2122",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.902 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.902 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.917 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2122 check successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.919 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.919 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.920 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.920 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.921 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"OUT","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.921 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.922 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.923 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.923 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.923 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.923 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2122/786_2122.sh
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:48.945 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1237
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:48.946 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:48.957 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2123, taskName=consume_filtered_data, firstSubmitTime=1714416768946, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=OUT, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2123'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025248'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"OUT","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.963 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.974 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.975 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.988 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.989 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416768989
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2123
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.991 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2123,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714416768946,
  "startTime" : 1714416768989,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2123.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "OUT",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2123"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025248"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2123",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:48.994 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.000 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.001 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.011 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.018 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2123 check successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.019 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.020 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.023 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.024 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.024 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.024 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.024 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"OUT","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.024 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.025 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.025 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.025 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.025 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.025 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.026 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.026 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2123/786_2123.sh
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:49.052 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1247
[WI-0][TI-2122] - [INFO] 2024-04-30 02:52:49.318 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2122, success=true)
[WI-0][TI-2122] - [INFO] 2024-04-30 02:52:49.325 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2122)
[WI-0][TI-2123] - [INFO] 2024-04-30 02:52:49.342 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2123, success=true)
[WI-0][TI-2123] - [INFO] 2024-04-30 02:52:49.352 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2123)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:49.659 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.884272997032641 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.955 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2122, processId:1237 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.958 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.959 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.966 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.967 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2122
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2122
[WI-786][TI-2122] - [INFO] 2024-04-30 02:52:49.974 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:50.054 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.061 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2123, processId:1247 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.062 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.064 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.065 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.152 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.153 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2123
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.171 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2123
[WI-786][TI-2123] - [INFO] 2024-04-30 02:52:50.182 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2122] - [INFO] 2024-04-30 02:52:50.326 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2122, success=true)
[WI-0][TI-2123] - [INFO] 2024-04-30 02:52:50.365 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2123, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:50.743 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2124, taskName=create sql script, firstSubmitTime=1714416770679, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='create sql script'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2124'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025250'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.754 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: create sql script to wait queue success
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.754 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.797 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.799 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.828 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.829 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416770829
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.832 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2124
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.840 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2124,
  "taskName" : "create sql script",
  "firstSubmitTime" : 1714416770679,
  "startTime" : 1714416770829,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2124.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\n\\n\\nprint('#{setValue(query=%s)}' % query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "create sql script"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2124"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025250"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2124",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.845 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.846 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.887 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124 check successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.889 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.890 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.893 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)",
  "resourceList" : [ ]
}
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.896 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.897 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.910 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124/py_786_2124.py
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.911 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.912 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.915 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.915 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124/py_786_2124.py
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.915 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.916 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124/786_2124.sh
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:50.923 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1258
[WI-0][TI-2124] - [INFO] 2024-04-30 02:52:51.360 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2124, success=true)
[WI-0][TI-2124] - [INFO] 2024-04-30 02:52:51.380 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2124)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:51.702 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9662576687116564 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:51.938 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(query= INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');)}
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.941 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124, processId:1258 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.942 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.942 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.942 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.942 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.951 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.952 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2124
[WI-786][TI-2124] - [INFO] 2024-04-30 02:52:51.953 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2124] - [INFO] 2024-04-30 02:52:52.353 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2124, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:52.499 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2125, taskName=persist in postgresql, firstSubmitTime=1714416772484, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2125'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025252'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@6bc52682, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.500 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.501 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.502 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.503 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416772503
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2125
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.503 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2125,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416772484,
  "startTime" : 1714416772503,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2125.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2125"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025252"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2125",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.505 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.514 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.515 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.516 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2125 check successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.518 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.520 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.520 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.520 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.520 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.521 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.522 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.522 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.522 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.523 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2125] - [WARN] 2024-04-30 02:52:52.524 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.574 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.575 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2125] - [ERROR] 2024-04-30 02:52:52.581 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2125] - [ERROR] 2024-04-30 02:52:52.582 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2125] - [ERROR] 2024-04-30 02:52:52.583 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.584 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2125.log
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.584 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2125.log, fetch way: log 
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.585 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.598 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2125] - [INFO] 2024-04-30 02:52:52.601 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2125] - [INFO] 2024-04-30 02:52:53.376 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2125, success=true)
[WI-0][TI-2125] - [INFO] 2024-04-30 02:52:53.407 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2125, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:54.531 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2126, taskName=persist in postgresql, firstSubmitTime=1714416774512, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2126'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025254'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@567a9ff, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.534 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.535 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.539 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.539 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416774540
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2126
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.544 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2126,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416774512,
  "startTime" : 1714416774540,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2126.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2126"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025254"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2126",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.546 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.547 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.548 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.562 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.563 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.565 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2126 check successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.566 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.567 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.567 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.568 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.570 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.571 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.572 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.573 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.574 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.574 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.575 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2126] - [WARN] 2024-04-30 02:52:54.577 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.618 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.619 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2126] - [ERROR] 2024-04-30 02:52:54.624 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2126] - [ERROR] 2024-04-30 02:52:54.625 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2126] - [ERROR] 2024-04-30 02:52:54.626 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.627 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2126.log
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.627 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2126.log, fetch way: log 
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.628 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.629 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.637 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2126] - [INFO] 2024-04-30 02:52:54.638 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2126] - [INFO] 2024-04-30 02:52:55.358 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2126, success=true)
[WI-0][TI-2126] - [INFO] 2024-04-30 02:52:55.385 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2126, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:56.562 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2127, taskName=persist in postgresql, firstSubmitTime=1714416776471, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=786, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2127'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025256'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='786'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@5d9f9e43, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.573 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.575 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416776576
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.576 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 786_2127
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.577 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2127,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416776471,
  "startTime" : 1714416776576,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2127.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 786,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2127"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025256"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "786"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "786_2127",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.588 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.573 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.663 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.663 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/786/2127 check successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.665 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.715 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.716 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.771 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.773 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:56.826 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9488054607508531 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.902 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.903 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.903 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.904 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.924 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.927 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.928 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.945 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:56.947 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-786][TI-2127] - [WARN] 2024-04-30 02:52:56.952 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.114 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.114 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-786][TI-2127] - [ERROR] 2024-04-30 02:52:57.127 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-786][TI-2127] - [ERROR] 2024-04-30 02:52:57.128 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-786][TI-2127] - [ERROR] 2024-04-30 02:52:57.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.131 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2127.log
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.131 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/786/2127.log, fetch way: log 
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.132 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.132 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.151 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-786][TI-2127] - [INFO] 2024-04-30 02:52:57.152 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2127] - [INFO] 2024-04-30 02:52:57.376 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2127, success=true)
[WI-0][TI-2127] - [INFO] 2024-04-30 02:52:57.417 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2127, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:52:58.059 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8888888888888888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:01.567 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7026239067055393 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:10.642 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7453416149068323 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:22.833 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7790368271954674 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:23.872 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7705882352941176 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:24.874 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8783382789317506 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:25.875 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7084639498432602 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:27.889 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7568832473403041 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:28.902 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8592904281527036 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:31.921 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7665815432376946 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:36.995 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7165605095541401 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:38.043 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8208092485549133 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:39.047 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.804154302670623 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:42.095 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.752112676056338 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:48.840 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2129, taskName=consume_filtered_data, firstSubmitTime=1714416888833, startTime=0, taskType=SHELL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000","resourceList":[]}, environmentConfig=export JAVA_HOME=/opt/java/openjdk, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='consume_filtered_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2129'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13433255983872'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025448'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.842 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: consume_filtered_data to wait queue success
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.842 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.850 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.851 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416888851
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.851 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2129
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.852 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2129,
  "taskName" : "consume_filtered_data",
  "firstSubmitTime" : 1714416888833,
  "startTime" : 1714416888851,
  "taskType" : "SHELL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2129.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"# /bin/kafka-console-consumer.sh \\\\\\n#     --bootstrap-server kafka:9092 \\\\\\n#     --topic reddit_post_filtered \\\\\\n#     --max-messages 10 \\\\\\n#     --from-beginning \\\\\\n#     --group filtered_data_consumer \\n#     --timeout-ms 15000\",\"resourceList\":[]}",
  "environmentConfig" : "export JAVA_HOME=/opt/java/openjdk",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "consume_filtered_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2129"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13433255983872"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025448"
    }
  },
  "taskAppId" : "787_2129",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.853 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.854 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.857 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.857 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.858 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2129 check successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.shell.ShellTaskChannel successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SHELL create successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.p.t.s.ShellTask:[70] - Initialize shell task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "# /bin/kafka-console-consumer.sh \\\n#     --bootstrap-server kafka:9092 \\\n#     --topic reddit_post_filtered \\\n#     --max-messages 10 \\\n#     --from-beginning \\\n#     --group filtered_data_consumer \n#     --timeout-ms 15000",
  "resourceList" : [ ]
}
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.859 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.860 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.860 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.860 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export JAVA_HOME=/opt/java/openjdk
# /bin/kafka-console-consumer.sh \
#     --bootstrap-server kafka:9092 \
#     --topic reddit_post_filtered \
#     --max-messages 10 \
#     --from-beginning \
#     --group filtered_data_consumer 
#     --timeout-ms 15000
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.861 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.861 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2129/787_2129.sh
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:48.864 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1297
[WI-0][TI-2129] - [INFO] 2024-04-30 02:54:49.771 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2129, success=true)
[WI-0][TI-2129] - [INFO] 2024-04-30 02:54:49.779 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2129)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:49.865 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.869 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2129, processId:1297 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.869 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.870 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.871 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.879 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2129
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2129
[WI-787][TI-2129] - [INFO] 2024-04-30 02:54:49.880 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2129] - [INFO] 2024-04-30 02:54:50.796 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2129, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:50.903 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2130, taskName=create sql script, firstSubmitTime=1714416890896, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"query","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='create sql script'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2130'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13426451158240'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025450'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.905 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: create sql script to wait queue success
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.905 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.906 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.906 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416890907
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2130
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.907 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2130,
  "taskName" : "create sql script",
  "firstSubmitTime" : 1714416890896,
  "startTime" : 1714416890907,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2130.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"query\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import re\\nimport json\\n\\n# define the table to send the data to\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# Provided JSON data as strings\\njson_data = ''' \\n{\\n  \\\"user\\\": \\\"premiumplatinum\\\",\\n  \\\"content\\\": \\\"singapore is stupid\\\",\\n  \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n  \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n  \\\"score\\\": 131,\\n  \\\"type\\\": \\\"post\\\",\\n  \\\"id\\\": \\\"1c9itat\\\",\\n  \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n{\\n        \\\"user\\\": \\\"premiumplatinum\\\",\\n        \\\"content\\\": \\\"s is stupid\\\",\\n        \\\"url\\\": \\\"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\\\",\\n        \\\"context\\\": \\\"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\\\",\\n        \\\"score\\\": 131,\\n        \\\"type\\\": \\\"post\\\",\\n        \\\"id\\\": \\\"1c9itat\\\",\\n        \\\"datetime\\\": \\\"2024-04-21 22:10:42\\\"\\n}\\n'''\\n\\n# process the kafka messages to individual JSON objects\\njson_objects = json_data.replace('}\\\\n{', '},\\\\n{').strip()\\njson_objects = re.sub(\\\" +\\\", \\\" \\\",json_objects)   \\njson_objects = '[' + json_objects + ']'\\n\\n# convert JSON string to a list of dicts\\njson_list = json.loads(json_objects)\\n\\n# convert list of dictionaries into list of tuples containing only the values\\nvalues = [tuple(message.values()) for message in json_list]\\n\\n# define the table name\\ntable_name = \\\"filtered_data_persistence\\\"\\n\\n# create the SQL Query\\nquery = f''' \\\\\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\\\\nVALUES \\\\\\n'''\\n\\nfor value in values:\\n    query += str(value) + ','\\n\\n# remove the last 1 character , and change it to ; for the query\\nquery = query[:-1] + ';'\\n\\n\\nprint('#{setValue(query=%s)}' % query)\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "create sql script"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2130"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426451158240"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025450"
    }
  },
  "taskAppId" : "787_2130",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.910 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.911 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.911 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130 check successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.911 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.912 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.912 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.912 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.912 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "query",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import re\nimport json\n\n# define the table to send the data to\ntable_name = \"filtered_data_persistence\"\n\n# Provided JSON data as strings\njson_data = ''' \n{\n  \"user\": \"premiumplatinum\",\n  \"content\": \"singapore is stupid\",\n  \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n  \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n  \"score\": 131,\n  \"type\": \"post\",\n  \"id\": \"1c9itat\",\n  \"datetime\": \"2024-04-21 22:10:42\"\n}\n{\n        \"user\": \"premiumplatinum\",\n        \"content\": \"s is stupid\",\n        \"url\": \"https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/\",\n        \"context\": \"21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist\",\n        \"score\": 131,\n        \"type\": \"post\",\n        \"id\": \"1c9itat\",\n        \"datetime\": \"2024-04-21 22:10:42\"\n}\n'''\n\n# process the kafka messages to individual JSON objects\njson_objects = json_data.replace('}\\n{', '},\\n{').strip()\njson_objects = re.sub(\" +\", \" \",json_objects)   \njson_objects = '[' + json_objects + ']'\n\n# convert JSON string to a list of dicts\njson_list = json.loads(json_objects)\n\n# convert list of dictionaries into list of tuples containing only the values\nvalues = [tuple(message.values()) for message in json_list]\n\n# define the table name\ntable_name = \"filtered_data_persistence\"\n\n# create the SQL Query\nquery = f''' \\\nINSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \\\nVALUES \\\n'''\n\nfor value in values:\n    query += str(value) + ','\n\n# remove the last 1 character , and change it to ; for the query\nquery = query[:-1] + ';'\n\n\nprint('#{setValue(query=%s)}' % query)",
  "resourceList" : [ ]
}
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.913 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.915 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.915 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130/py_787_2130.py
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.915 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import re
import json

# define the table to send the data to
table_name = "filtered_data_persistence"

# Provided JSON data as strings
json_data = ''' 
{
  "user": "premiumplatinum",
  "content": "singapore is stupid",
  "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
  "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
  "score": 131,
  "type": "post",
  "id": "1c9itat",
  "datetime": "2024-04-21 22:10:42"
}
{
        "user": "premiumplatinum",
        "content": "s is stupid",
        "url": "https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/",
        "context": "21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist",
        "score": 131,
        "type": "post",
        "id": "1c9itat",
        "datetime": "2024-04-21 22:10:42"
}
'''

# process the kafka messages to individual JSON objects
json_objects = json_data.replace('}\n{', '},\n{').strip()
json_objects = re.sub(" +", " ",json_objects)   
json_objects = '[' + json_objects + ']'

# convert JSON string to a list of dicts
json_list = json.loads(json_objects)

# convert list of dictionaries into list of tuples containing only the values
values = [tuple(message.values()) for message in json_list]

# define the table name
table_name = "filtered_data_persistence"

# create the SQL Query
query = f''' \
INSERT INTO {table_name} (user, content, url, context, score, type, id, datetime) \
VALUES \
'''

for value in values:
    query += str(value) + ','

# remove the last 1 character , and change it to ; for the query
query = query[:-1] + ';'


print('#{setValue(query=%s)}' % query)
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.916 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.916 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.916 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130/py_787_2130.py
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.917 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.917 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130/787_2130.sh
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:50.922 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1308
[WI-0][TI-2130] - [INFO] 2024-04-30 02:54:51.809 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2130, success=true)
[WI-0][TI-2130] - [INFO] 2024-04-30 02:54:51.815 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2130)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:51.960 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	#{setValue(query= INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');)}
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.963 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130, processId:1308 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.963 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.964 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.964 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.964 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.968 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2130
[WI-787][TI-2130] - [INFO] 2024-04-30 02:54:51.970 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2130] - [INFO] 2024-04-30 02:54:52.804 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2130, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:52.882 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2131, taskName=persist in postgresql, firstSubmitTime=1714416892870, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2131'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025452'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@3a31240, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.883 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.884 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.887 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.887 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416892888
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2131
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.888 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2131,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416892870,
  "startTime" : 1714416892888,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2131.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2131"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025452"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "787_2131",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.890 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.895 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2131 check successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.896 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.898 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.898 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.898 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.900 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.900 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.900 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.901 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.902 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.903 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.904 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-787][TI-2131] - [WARN] 2024-04-30 02:54:52.905 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.928 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.930 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-787][TI-2131] - [ERROR] 2024-04-30 02:54:52.933 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-787][TI-2131] - [ERROR] 2024-04-30 02:54:52.933 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-787][TI-2131] - [ERROR] 2024-04-30 02:54:52.933 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.934 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2131.log
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.934 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2131.log, fetch way: log 
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.934 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.935 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-787][TI-2131] - [INFO] 2024-04-30 02:54:52.940 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2131] - [INFO] 2024-04-30 02:54:53.806 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2131, success=true)
[WI-0][TI-2131] - [INFO] 2024-04-30 02:54:53.814 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2131, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:54.890 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2132, taskName=persist in postgresql, firstSubmitTime=1714416894877, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2132'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025454'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@4267bf67, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.892 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.892 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.893 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.894 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416894894
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2132
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.894 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2132,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416894877,
  "startTime" : 1714416894894,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2132.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2132"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025454"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "787_2132",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.895 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.899 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2132 check successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.900 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.901 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.902 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.902 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.902 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.902 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.903 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.903 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-787][TI-2132] - [WARN] 2024-04-30 02:54:54.903 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.918 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.919 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-787][TI-2132] - [ERROR] 2024-04-30 02:54:54.920 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-787][TI-2132] - [ERROR] 2024-04-30 02:54:54.922 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-787][TI-2132] - [ERROR] 2024-04-30 02:54:54.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.924 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2132.log
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.924 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2132.log, fetch way: log 
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.925 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.925 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-787][TI-2132] - [INFO] 2024-04-30 02:54:54.929 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2132] - [INFO] 2024-04-30 02:54:55.828 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2132, success=true)
[WI-0][TI-2132] - [INFO] 2024-04-30 02:54:55.838 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2132, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:56.911 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2133, taskName=persist in postgresql, firstSubmitTime=1714416896896, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2133'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025456'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@2daaa92e, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.913 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.913 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.922 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.922 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.923 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416896923
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.925 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2133
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.925 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2133,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416896896,
  "startTime" : 1714416896923,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2133.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2133"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025456"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "787_2133",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.926 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.926 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.926 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.933 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.934 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.937 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2133 check successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.939 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.943 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.944 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.950 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.951 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.951 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.951 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.951 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.952 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.952 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-787][TI-2133] - [WARN] 2024-04-30 02:54:56.954 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.995 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:56.996 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-787][TI-2133] - [ERROR] 2024-04-30 02:54:56.997 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-787][TI-2133] - [ERROR] 2024-04-30 02:54:57.001 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-787][TI-2133] - [ERROR] 2024-04-30 02:54:57.005 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.006 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2133.log
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.006 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2133.log, fetch way: log 
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.007 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.008 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.013 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-787][TI-2133] - [INFO] 2024-04-30 02:54:57.014 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2133] - [INFO] 2024-04-30 02:54:57.831 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2133, success=true)
[WI-0][TI-2133] - [INFO] 2024-04-30 02:54:57.839 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2133, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:54:59.604 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2134, taskName=persist in postgresql, firstSubmitTime=1714416899586, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.3:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13426477386080, processDefineVersion=14, appIds=null, processInstanceId=787, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":1,"sql":"${query}","sqlType":"0","preStatements":[],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='persist in postgresql'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, query=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240430'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2134'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13427698681952'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240430025459'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='787'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240429'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='es_filtered_data_persistence_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13426477386080'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@28455ae0, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.606 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: persist in postgresql to wait queue success
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.607 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714416899610
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 787_2134
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.610 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2134,
  "taskName" : "persist in postgresql",
  "firstSubmitTime" : 1714416899586,
  "startTime" : 1714416899610,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.3:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2134.log",
  "processId" : 0,
  "processDefineCode" : 13426477386080,
  "processDefineVersion" : 14,
  "processInstanceId" : 787,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":1,\"sql\":\"${query}\",\"sqlType\":\"0\",\"preStatements\":[],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "persist in postgresql"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "query" : {
      "prop" : "query",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : " INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2134"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13427698681952"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240430025459"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "787"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240429"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "es_filtered_data_persistence_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13426477386080"
    }
  },
  "taskAppId" : "787_2134",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "1" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"persistence\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/persistence\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"query\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.611 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.620 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.621 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13426477386080_14/787/2134 check successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.622 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.623 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 1,
  "sql" : "${query}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"query","direct":"IN","type":"VARCHAR","value":" INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');"}] successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=1, sql='${query}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[], postStatements=[]}
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.624 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 1, sql : ${query} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}] ,query max result limit  0
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.626 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: query put in sqlParamsMap of content ${query} successfully.
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.626 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : ?
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.626 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters: INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');(VARCHAR)
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.626 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-787][TI-2134] - [WARN] 2024-04-30 02:54:59.627 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.668 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : ?, sql parameters : {1=Property{prop='query', direct=IN, type=VARCHAR, value=' INSERT INTO filtered_data_persistence (user, content, url, context, score, type, id, datetime) VALUES ('premiumplatinum', 'singapore is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42'),('premiumplatinum', 's is stupid', 'https://www.reddit.com/r/singapore/comments/1c9itat/21apr2024_orchard_road_camcar_turning_right_into/', '21apr2024 orchard road camcar turning right into centrepoint get tbone by cyclist', 131, 'post', '1c9itat', '2024-04-21 22:10:42');'}}
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.668 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: ?
[WI-787][TI-2134] - [ERROR] 2024-04-30 02:54:59.674 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: ERROR: syntax error at or near "$1"
  Position: 1
[WI-787][TI-2134] - [ERROR] 2024-04-30 02:54:59.675 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-787][TI-2134] - [ERROR] 2024-04-30 02:54:59.675 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: ERROR: syntax error at or near "$1"
  Position: 1
	at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2676)
	at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2366)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:356)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.675 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2134.log
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.675 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240430/13426477386080/14/787/2134.log, fetch way: log 
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.676 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.676 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.683 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-787][TI-2134] - [INFO] 2024-04-30 02:54:59.684 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2134] - [INFO] 2024-04-30 02:55:00.484 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2134, success=true)
[WI-0][TI-2134] - [INFO] 2024-04-30 02:55:00.491 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2134, success=true)
[WI-0][TI-0] - [INFO] 2024-04-30 02:56:52.851 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8348623853211009 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:56:53.869 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.896551724137931 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:56:54.877 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7062314540059347 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:56:55.898 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7947976878612717 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-04-30 02:57:01.979 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7347560975609756 is over then the MaxCpuUsagePercentageThresholds 0.7
