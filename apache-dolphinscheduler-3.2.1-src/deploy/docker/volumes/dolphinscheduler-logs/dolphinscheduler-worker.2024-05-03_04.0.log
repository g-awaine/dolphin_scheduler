[WI-0][TI-0] - [INFO] 2024-05-03 04:18:36.641 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8053892215568863 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:18:37.667 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9256198347107438 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:19:08.755 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7761627906976745 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:36:52.541 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:38:02.760 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7024793388429752 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:42:22.568 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7359550561797753 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:47:07.605 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7605633802816901 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:34.985 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8168604651162791 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:40.403 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2381, taskName=hash_article_data, firstSubmitTime=1714682920154, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=2, appIds=null, processInstanceId=811, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='811'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2381'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503044840'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.445 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.470 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.489 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.490 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714682920490
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 811_2381
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.507 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2381,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714682920154,
  "startTime" : 1714682920490,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/2/811/2381.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 2,
  "processInstanceId" : 811,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlibs\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "811"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2381"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503044840"
    }
  },
  "taskAppId" : "811_2381",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.510 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.510 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.510 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.744 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.792 +0800 o.a.d.c.u.OSUtils:[231] - create linux os user: default
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:40.793 +0800 o.a.d.c.u.OSUtils:[233] - execute cmd: sudo useradd -g root
 default
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:41.049 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9609120521172638 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.215 +0800 o.a.d.c.u.OSUtils:[190] - create user default success
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.260 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381 check successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.262 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-0][TI-2381] - [INFO] 2024-05-03 04:48:41.266 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2381, success=true)
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.353 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.384 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.392 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.404 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.406 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.409 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.416 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.447 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.447 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.448 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.465 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.467 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381/py_811_2381.py
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.468 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.558 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.559 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.559 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381/py_811_2381.py
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.559 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.561 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381/811_2381.sh
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:41.567 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1327
[WI-0][TI-2381] - [INFO] 2024-05-03 04:48:42.333 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2381)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:42.571 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381/py_811_2381.py", line 3, in <module>
	    import hashlibs
	ModuleNotFoundError: No module named 'hashlibs'
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.575 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381, processId:1327 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.586 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.592 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.599 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.625 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.627 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.627 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.649 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2381
[WI-811][TI-2381] - [INFO] 2024-05-03 04:48:42.655 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2381] - [INFO] 2024-05-03 04:48:43.245 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2381, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:43.374 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2382, taskName=hash_article_data, firstSubmitTime=1714682923353, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=2, appIds=null, processInstanceId=811, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='811'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2382'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503044843'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.410 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.417 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.450 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.450 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.451 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.451 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714682923451
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.451 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 811_2382
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.455 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2382,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714682923353,
  "startTime" : 1714682923451,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/2/811/2382.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 2,
  "processInstanceId" : 811,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlibs\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "811"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2382"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503044843"
    }
  },
  "taskAppId" : "811_2382",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.462 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.462 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.462 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382 check successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.547 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.548 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.549 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.549 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.550 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.559 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.567 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.574 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.592 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382/py_811_2382.py
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.602 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.609 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.609 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.610 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382/py_811_2382.py
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.610 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.610 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382/811_2382.sh
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:43.615 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1341
[WI-0][TI-2382] - [INFO] 2024-05-03 04:48:44.264 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2382, success=true)
[WI-0][TI-2382] - [INFO] 2024-05-03 04:48:44.284 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2382)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:44.620 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382/py_811_2382.py", line 3, in <module>
	    import hashlibs
	ModuleNotFoundError: No module named 'hashlibs'
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.672 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382, processId:1341 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.672 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.673 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.691 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.692 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.692 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.694 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2382
[WI-811][TI-2382] - [INFO] 2024-05-03 04:48:44.695 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2382] - [INFO] 2024-05-03 04:48:45.250 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2382, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:45.332 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2383, taskName=hash_article_data, firstSubmitTime=1714682925311, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=2, appIds=null, processInstanceId=811, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='811'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2383'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503044845'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.335 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.336 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.339 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.340 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714682925340
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.343 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 811_2383
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.344 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2383,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714682925311,
  "startTime" : 1714682925340,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/2/811/2383.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 2,
  "processInstanceId" : 811,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlibs\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "811"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2383"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503044845"
    }
  },
  "taskAppId" : "811_2383",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.346 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.369 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.370 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383 check successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.371 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.372 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.372 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.373 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.373 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.373 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.373 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.373 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.374 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383/py_811_2383.py
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.374 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.375 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.375 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.375 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383/py_811_2383.py
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.375 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.375 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383/811_2383.sh
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:45.414 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1353
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:45.415 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
[WI-0][TI-2383] - [INFO] 2024-05-03 04:48:46.276 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2383, success=true)
[WI-0][TI-2383] - [INFO] 2024-05-03 04:48:46.300 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2383)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:46.509 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383/py_811_2383.py", line 3, in <module>
	    import hashlibs
	ModuleNotFoundError: No module named 'hashlibs'
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.510 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383, processId:1353 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.518 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.519 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2383
[WI-811][TI-2383] - [INFO] 2024-05-03 04:48:46.520 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2383] - [INFO] 2024-05-03 04:48:47.267 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2383, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:47.477 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2384, taskName=hash_article_data, firstSubmitTime=1714682927427, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=2, appIds=null, processInstanceId=811, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='811'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2384'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503044847'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.483 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.483 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.486 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.486 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714682927486
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.486 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 811_2384
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.487 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2384,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714682927427,
  "startTime" : 1714682927486,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/2/811/2384.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 2,
  "processInstanceId" : 811,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlibs\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "811"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2384"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503044847"
    }
  },
  "taskAppId" : "811_2384",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.487 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.488 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.500 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.501 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384 check successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.501 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.502 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.504 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.504 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.506 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlibs\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.508 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.517 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.517 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.518 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.518 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.518 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.519 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.519 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384/py_811_2384.py
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.520 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlibs

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.522 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.524 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.524 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384/py_811_2384.py
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.525 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.525 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384/811_2384.sh
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:47.541 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1364
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:48.251 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7355623100303951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2384] - [INFO] 2024-05-03 04:48:48.308 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2384, success=true)
[WI-0][TI-2384] - [INFO] 2024-05-03 04:48:48.338 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2384)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:48.542 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384/py_811_2384.py", line 3, in <module>
	    import hashlibs
	ModuleNotFoundError: No module named 'hashlibs'
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.550 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384, processId:1364 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.550 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.567 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.567 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.587 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.587 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.587 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_2/811/2384
[WI-811][TI-2384] - [INFO] 2024-05-03 04:48:48.588 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:49.290 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8217067666436138 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2384] - [INFO] 2024-05-03 04:48:49.293 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2384, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:51.366 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:54.956 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9246376811594202 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:58.100 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7083333333333334 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:48:59.156 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8308605341246291 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:49:00.159 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7784090909090909 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:49:06.214 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9093655589123868 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:49:07.249 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8347578347578348 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:50:52.518 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7832369942196532 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:00.578 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7116564417177913 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:04.633 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7601246105919003 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:05.716 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8347578347578347 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:09.485 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2385, taskName=hash_article_data, firstSubmitTime=1714683069469, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=3, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2385'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045109'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.491 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.492 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.496 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.497 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683069497
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.497 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2385
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.498 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2385,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683069469,
  "startTime" : 1714683069497,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/3/812/2385.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 3,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlib\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2385"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045109"
    }
  },
  "taskAppId" : "812_2385",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.504 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.504 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.504 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.525 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385 check successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.529 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.531 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.531 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.532 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.532 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.532 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.533 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.533 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.533 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.535 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.536 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385/py_812_2385.py
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.536 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.537 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.537 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.537 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385/py_812_2385.py
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.538 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.539 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385/812_2385.sh
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:09.553 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1406
[WI-0][TI-2385] - [INFO] 2024-05-03 04:51:10.154 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2385, success=true)
[WI-0][TI-2385] - [INFO] 2024-05-03 04:51:10.164 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2385)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:10.554 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385/py_812_2385.py", line 16, in <module>
	    article_data_json = json.dumps(article_data)
	                        ^^^^
	NameError: name 'json' is not defined
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.556 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385, processId:1406 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.556 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.556 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.556 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.561 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.562 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.562 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.563 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2385
[WI-812][TI-2385] - [INFO] 2024-05-03 04:51:10.563 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2385] - [INFO] 2024-05-03 04:51:11.148 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2385, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:11.216 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2386, taskName=hash_article_data, firstSubmitTime=1714683071203, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=3, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2386'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045111'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.217 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.218 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.219 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.219 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.220 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.220 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683071220
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.220 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2386
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.220 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2386,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683071203,
  "startTime" : 1714683071220,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/3/812/2386.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 3,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlib\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2386"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045111"
    }
  },
  "taskAppId" : "812_2386",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.221 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.221 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.221 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.231 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.232 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.233 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386 check successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.234 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.234 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.235 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.236 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.237 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.237 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.238 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.238 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.238 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.238 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.238 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.239 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.240 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386/py_812_2386.py
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.240 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.240 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.241 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.241 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386/py_812_2386.py
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.241 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.241 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386/812_2386.sh
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:11.249 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1418
[WI-0][TI-2386] - [INFO] 2024-05-03 04:51:12.159 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2386, success=true)
[WI-0][TI-2386] - [INFO] 2024-05-03 04:51:12.192 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2386)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:12.251 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386/py_812_2386.py", line 16, in <module>
	    article_data_json = json.dumps(article_data)
	                        ^^^^
	NameError: name 'json' is not defined
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.255 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386, processId:1418 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.257 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.258 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.258 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.259 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.269 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.269 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.269 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.270 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2386
[WI-812][TI-2386] - [INFO] 2024-05-03 04:51:12.271 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2386] - [INFO] 2024-05-03 04:51:13.980 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2386, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:14.090 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2387, taskName=hash_article_data, firstSubmitTime=1714683074076, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=3, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2387'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045114'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.092 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.092 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.095 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.095 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.095 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683074096
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2387
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.096 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2387,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683074076,
  "startTime" : 1714683074096,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/3/812/2387.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 3,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlib\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2387"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045114"
    }
  },
  "taskAppId" : "812_2387",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.097 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.098 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.098 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.101 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.102 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.107 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387 check successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.107 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.108 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.109 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.110 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.110 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.111 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.111 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.111 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.113 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.115 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387/py_812_2387.py
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.115 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.117 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.117 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.117 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387/py_812_2387.py
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.117 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.117 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387/812_2387.sh
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:14.121 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1429
[WI-0][TI-2387] - [INFO] 2024-05-03 04:51:14.982 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2387, success=true)
[WI-0][TI-2387] - [INFO] 2024-05-03 04:51:14.992 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2387)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:15.123 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387/py_812_2387.py", line 16, in <module>
	    article_data_json = json.dumps(article_data)
	                        ^^^^
	NameError: name 'json' is not defined
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.125 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387, processId:1429 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.126 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.127 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.127 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.127 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.130 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.130 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.130 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2387
[WI-812][TI-2387] - [INFO] 2024-05-03 04:51:15.131 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2387] - [INFO] 2024-05-03 04:51:15.975 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2387, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:16.012 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2388, taskName=hash_article_data, firstSubmitTime=1714683075998, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=3, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2388'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045116'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.014 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.014 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.019 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.020 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.020 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.020 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683076020
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.020 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2388
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.021 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2388,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683075998,
  "startTime" : 1714683076020,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/3/812/2388.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 3,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlib\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2388"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045116"
    }
  },
  "taskAppId" : "812_2388",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.022 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.023 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.025 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388 check successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.026 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.027 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlib\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.028 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.029 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.029 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.030 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.030 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388/py_812_2388.py
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.030 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.031 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.032 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.032 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388/py_812_2388.py
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.032 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.032 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388/812_2388.sh
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:16.043 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1440
[WI-0][TI-2388] - [INFO] 2024-05-03 04:51:16.984 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2388, success=true)
[WI-0][TI-2388] - [INFO] 2024-05-03 04:51:16.990 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2388)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:17.044 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	Traceback (most recent call last):
	  File "/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388/py_812_2388.py", line 16, in <module>
	    article_data_json = json.dumps(article_data)
	                        ^^^^
	NameError: name 'json' is not defined
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.047 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388, processId:1440 ,exitStatusCode:1 ,processWaitForStatus:true ,processExitValue:1
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.048 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.048 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.048 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.048 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.051 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: FAILURE to master : 172.18.1.1:1234
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_3/812/2388
[WI-812][TI-2388] - [INFO] 2024-05-03 04:51:17.052 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2388] - [INFO] 2024-05-03 04:51:17.982 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2388, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:24.993 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7728613569321534 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:26.005 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7529411764705882 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:27.007 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7443820224719101 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:51:32.024 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7383720930232558 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:37.434 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.8235294117647058 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:38.461 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7917888563049853 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:39.476 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.866096866096866 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:40.481 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9195402298850575 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:41.504 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.9 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:43.531 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.792507204610951 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:53:59.494 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2389, taskName=hash_article_data, firstSubmitTime=1714683239483, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=4, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2389'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045359'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.498 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.501 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683239526
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.526 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2389
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.527 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2389,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683239483,
  "startTime" : 1714683239526,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2389.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 4,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2389"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045359"
    }
  },
  "taskAppId" : "812_2389",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.535 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.536 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.537 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389 check successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.539 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.542 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.544 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.551 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.555 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.555 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.556 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.558 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389/py_812_2389.py
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.559 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.560 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.560 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.561 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389/py_812_2389.py
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.562 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.563 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389/812_2389.sh
[WI-812][TI-2389] - [INFO] 2024-05-03 04:53:59.568 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1488
[WI-0][TI-2389] - [INFO] 2024-05-03 04:54:00.243 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2389, success=true)
[WI-0][TI-2389] - [INFO] 2024-05-03 04:54:00.248 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2389)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:00.568 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.570 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389, processId:1488 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.571 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.572 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.586 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2389
[WI-812][TI-2389] - [INFO] 2024-05-03 04:54:00.586 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2389] - [INFO] 2024-05-03 04:54:01.240 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2389, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:01.501 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2390, taskName=check if it exists in the database, firstSubmitTime=1714683241343, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=4, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2390'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045401'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@14ac0349, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.508 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.512 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683241513
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.513 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2390
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.524 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2390,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714683241343,
  "startTime" : 1714683241513,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2390.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 4,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2390"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045401"
    }
  },
  "taskAppId" : "812_2390",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.533 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.534 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.534 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2390 check successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.534 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.548 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.559 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.560 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.561 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.561 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.561 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [] ,query max result limit  0
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.589 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: HANA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.590 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: HANA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.592 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SQLSERVER
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.594 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SQLSERVER
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.597 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SAGEMAKER
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.599 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SAGEMAKER
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.613 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DATABEND
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.613 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DATABEND
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.782 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: AZURESQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.782 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: AZURESQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.786 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: HIVE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.787 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: HIVE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.794 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DORIS
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.795 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DORIS
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.797 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: POSTGRESQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.797 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: POSTGRESQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.799 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: MYSQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.801 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: MYSQL
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.816 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: REDSHIFT
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.816 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: REDSHIFT
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.819 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SNOWFLAKE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.819 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SNOWFLAKE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.821 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: STARROCKS
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.822 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: STARROCKS
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.824 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SSH
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.837 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SSH
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.841 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ATHENA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.842 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ATHENA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.844 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: PRESTO
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.844 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: PRESTO
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.846 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: OCEANBASE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.847 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: OCEANBASE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.865 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ORACLE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.865 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ORACLE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.867 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: CLICKHOUSE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.868 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: CLICKHOUSE
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.871 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: VERTICA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.871 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: VERTICA
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.874 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: KYUUBI
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.874 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: KYUUBI
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.877 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DB2
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.879 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DB2
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.884 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: TRINO
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.887 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: TRINO
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.892 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: SPARK
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.892 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: SPARK
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.895 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: DAMENG
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.895 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: DAMENG
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.898 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[45] - start register processor: ZEPPELIN
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:01.898 +0800 o.a.d.p.d.a.p.DataSourceProcessorManager:[51] - done register processor: ZEPPELIN
[WI-812][TI-2390] - [ERROR] 2024-05-03 04:54:02.126 +0800 o.a.d.p.t.a.AbstractTask:[199] - setSqlParamsMap: No Property with paramName: article_data_hash is found in paramsPropsMap of task instance with id: 2390. So couldn't put Property in sqlParamsMap.
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.127 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.127 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.128 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.128 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.129 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.165 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: hive
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.169 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: hive
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.169 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: vertica
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.170 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: vertica
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.171 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: doris
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.172 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: doris
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.172 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: ssh
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.175 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: ssh
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.177 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: databend
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.177 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: databend
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.177 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: sqlserver
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.178 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: sqlserver
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.178 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: postgresql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.178 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: postgresql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.184 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: redshift
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.189 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: redshift
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.189 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: spark
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.192 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: spark
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.196 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: oceanbase
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.197 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: oceanbase
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.197 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: starrocks
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.198 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: starrocks
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.199 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: mysql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.200 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: mysql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.200 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: hana
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.201 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: hana
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.201 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: sagemaker
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.202 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: sagemaker
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.203 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: dameng
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.204 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: dameng
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.204 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: snowflake
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.205 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: snowflake
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.205 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: oracle
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.207 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: oracle
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.207 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: kyuubi
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.209 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: kyuubi
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.209 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: zeppelin
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.210 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: zeppelin
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.211 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: trino
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.212 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: trino
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.215 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: db2
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.216 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: db2
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.219 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: clickhouse
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.224 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: clickhouse
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.224 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: azuresql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.225 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: azuresql
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.226 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: athena
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.226 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: athena
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.226 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[49] - Registering datasource plugin: presto
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:02.227 +0800 o.a.d.p.d.a.p.DataSourcePluginManager:[57] - Registered datasource plugin: presto
[WI-0][TI-2390] - [INFO] 2024-05-03 04:54:02.265 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2390, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:02.623 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.0754189944134078 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:03.638 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1141141141141142 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-812][TI-2390] - [WARN] 2024-05-03 04:54:03.779 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.392 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.399 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.401 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?, sql parameters : {}
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.401 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2390] - [ERROR] 2024-05-03 04:54:04.420 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: No value specified for parameter 1.
[WI-812][TI-2390] - [ERROR] 2024-05-03 04:54:04.426 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-812][TI-2390] - [ERROR] 2024-05-03 04:54:04.428 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.429 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2390.log
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.429 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2390.log, fetch way: log 
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.432 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.433 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.437 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-812][TI-2390] - [INFO] 2024-05-03 04:54:04.438 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:04.846 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 1.1344262295081966 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2390] - [INFO] 2024-05-03 04:54:05.251 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2390, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:05.375 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2391, taskName=check if it exists in the database, firstSubmitTime=1714683245357, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=4, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2391'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045405'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@60f1bc49, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.377 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.379 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.380 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.381 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.381 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.381 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683245381
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.382 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2391
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.385 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2391,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714683245357,
  "startTime" : 1714683245381,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2391.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 4,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2391"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045405"
    }
  },
  "taskAppId" : "812_2391",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.387 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.388 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.389 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.394 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.395 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.396 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2391 check successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.396 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.397 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.397 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.398 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.402 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.402 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.403 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.403 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.403 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.403 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.403 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.404 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [] ,query max result limit  0
[WI-812][TI-2391] - [ERROR] 2024-05-03 04:54:05.406 +0800 o.a.d.p.t.a.AbstractTask:[199] - setSqlParamsMap: No Property with paramName: article_data_hash is found in paramsPropsMap of task instance with id: 2391. So couldn't put Property in sqlParamsMap.
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.407 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.408 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.410 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.410 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.411 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-812][TI-2391] - [WARN] 2024-05-03 04:54:05.413 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.453 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.455 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.456 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?, sql parameters : {}
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.456 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2391] - [ERROR] 2024-05-03 04:54:05.457 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: No value specified for parameter 1.
[WI-812][TI-2391] - [ERROR] 2024-05-03 04:54:05.457 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-812][TI-2391] - [ERROR] 2024-05-03 04:54:05.457 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.457 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2391.log
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.457 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2391.log, fetch way: log 
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.460 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.460 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.464 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-812][TI-2391] - [INFO] 2024-05-03 04:54:05.465 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:05.848 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7267441860465117 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-2391] - [INFO] 2024-05-03 04:54:06.279 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2391, success=true)
[WI-0][TI-2391] - [INFO] 2024-05-03 04:54:06.326 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2391, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:07.525 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2392, taskName=check if it exists in the database, firstSubmitTime=1714683247473, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=4, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2392'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045407'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@28b4829a, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.529 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.529 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.535 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.536 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.537 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683247538
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.538 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2392
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.539 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2392,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714683247473,
  "startTime" : 1714683247538,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2392.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 4,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2392"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045407"
    }
  },
  "taskAppId" : "812_2392",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.542 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.542 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.542 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.553 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.554 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.556 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2392 check successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.556 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.557 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.558 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.558 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.558 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.559 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.559 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.559 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.559 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [] ,query max result limit  0
[WI-812][TI-2392] - [ERROR] 2024-05-03 04:54:07.559 +0800 o.a.d.p.t.a.AbstractTask:[199] - setSqlParamsMap: No Property with paramName: article_data_hash is found in paramsPropsMap of task instance with id: 2392. So couldn't put Property in sqlParamsMap.
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.560 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.560 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.560 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.560 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.561 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-812][TI-2392] - [WARN] 2024-05-03 04:54:07.561 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.608 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.610 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.611 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?, sql parameters : {}
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.611 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2392] - [ERROR] 2024-05-03 04:54:07.611 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: No value specified for parameter 1.
[WI-812][TI-2392] - [ERROR] 2024-05-03 04:54:07.612 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-812][TI-2392] - [ERROR] 2024-05-03 04:54:07.612 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.612 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2392.log
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.612 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2392.log, fetch way: log 
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.613 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.613 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-812][TI-2392] - [INFO] 2024-05-03 04:54:07.623 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2392] - [INFO] 2024-05-03 04:54:08.257 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2392, success=true)
[WI-0][TI-2392] - [INFO] 2024-05-03 04:54:08.265 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2392, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:09.337 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2393, taskName=check if it exists in the database, firstSubmitTime=1714683249323, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=4, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2393'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045409'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@18a9a95, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=null, dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.338 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.343 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.345 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683249345
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.345 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2393
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.346 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2393,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714683249323,
  "startTime" : 1714683249345,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2393.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 4,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2393"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045409"
    }
  },
  "taskAppId" : "812_2393",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.349 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.338 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.373 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.374 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.375 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_4/812/2393 check successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.375 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.376 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.376 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.376 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.376 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: null successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.377 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [] ,query max result limit  0
[WI-812][TI-2393] - [ERROR] 2024-05-03 04:54:09.378 +0800 o.a.d.p.t.a.AbstractTask:[199] - setSqlParamsMap: No Property with paramName: article_data_hash is found in paramsPropsMap of task instance with id: 2393. So couldn't put Property in sqlParamsMap.
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.378 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.379 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.379 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.379 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.379 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-812][TI-2393] - [WARN] 2024-05-03 04:54:09.379 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.402 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.403 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.403 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?, sql parameters : {}
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.404 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2393] - [ERROR] 2024-05-03 04:54:09.412 +0800 o.a.d.p.t.s.SqlTask:[217] - execute sql error: No value specified for parameter 1.
[WI-812][TI-2393] - [ERROR] 2024-05-03 04:54:09.414 +0800 o.a.d.p.t.s.SqlTask:[165] - sql task error
org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-812][TI-2393] - [ERROR] 2024-05-03 04:54:09.422 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[181] - Task execute failed, due to meet an exception
org.apache.dolphinscheduler.plugin.task.api.TaskException: Execute sql task failed
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:166)
	at org.apache.dolphinscheduler.server.worker.runner.DefaultWorkerTaskExecutor.executeTask(DefaultWorkerTaskExecutor.java:54)
	at org.apache.dolphinscheduler.server.worker.runner.WorkerTaskExecutor.run(WorkerTaskExecutor.java:175)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.postgresql.util.PSQLException: No value specified for parameter 1.
	at org.postgresql.core.v3.SimpleParameterList.checkAllParametersSet(SimpleParameterList.java:284)
	at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:340)
	at org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:490)
	at org.postgresql.jdbc.PgStatement.execute(PgStatement.java:408)
	at org.postgresql.jdbc.PgPreparedStatement.executeWithFlags(PgPreparedStatement.java:181)
	at org.postgresql.jdbc.PgPreparedStatement.executeQuery(PgPreparedStatement.java:133)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeQuery(SqlTask.java:317)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.executeFuncAndSql(SqlTask.java:205)
	at org.apache.dolphinscheduler.plugin.task.sql.SqlTask.handle(SqlTask.java:159)
	... 5 common frames omitted
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.428 +0800 o.a.d.p.t.a.u.ProcessUtils:[182] - Get appIds from worker 172.18.1.1:1234, taskLogPath: /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2393.log
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.428 +0800 o.a.d.p.t.a.u.LogUtils:[79] - Start finding appId in /opt/dolphinscheduler/logs/20240503/13471825071552/4/812/2393.log, fetch way: log 
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.428 +0800 o.a.d.p.t.a.u.ProcessUtils:[188] - The appId is empty
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.429 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[118] - Cancel the task successfully
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.445 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[125] - Get a exception when execute the task, will send the task status: FAILURE to master: 172.18.1.1:1234
[WI-812][TI-2393] - [INFO] 2024-05-03 04:54:09.447 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2393] - [INFO] 2024-05-03 04:54:10.278 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2393, success=true)
[WI-0][TI-2393] - [INFO] 2024-05-03 04:54:10.320 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2393, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:43.006 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7763578274760383 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:44.040 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.801829268292683 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:46.063 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7439353099730458 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:51.285 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7840236686390533 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:51.840 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2394, taskName=hash_article_data, firstSubmitTime=1714683291814, startTime=0, taskType=PYTHON, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=5, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[{"prop":"article_data_hash","direct":"OUT","type":"VARCHAR","value":""}],"rawScript":"import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))","resourceList":[]}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='hash_article_data'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2394'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13471727617984'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045451'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.887 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: hash_article_data to wait queue success
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.888 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.908 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.908 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.908 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683291908
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.908 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2394
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.909 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2394,
  "taskName" : "hash_article_data",
  "firstSubmitTime" : 1714683291814,
  "startTime" : 1714683291908,
  "taskType" : "PYTHON",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/5/812/2394.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 5,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[{\"prop\":\"article_data_hash\",\"direct\":\"OUT\",\"type\":\"VARCHAR\",\"value\":\"\"}],\"rawScript\":\"import hashlib\\nimport json\\n\\narticle_data = {\\n    \\\"title\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\\\",\\n    \\\"datetime\\\": \\\"Thu, 02 May 2024 08:01:58 GMT\\\",\\n    \\\"description\\\": \\\"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\\\",\\n    \\\"url\\\": \\\"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\\\",\\n    \\\"context\\\": \\\"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\\\n\\\\nThe diplomat in question is a 55-year-old, who is a \\\\u201cformer\\\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\\\n\\\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\\\n\\\\nStaff members at the public bath in Tokyo\\\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\\\u2019s phone and found \\\\u201cmultiple naked photos of male customers\\\\u201d, according to the Asahi newspaper.\\\\n\\\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\\\n\\\\nWhen asked to delete the photos from his phone, the diplomat \\\\u201cdeleted them on the spot\\\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\\\n\\\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\\\n\\\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\\\n\\\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\\\u201ccompleted his assignment as of April 12\\\\u201d and has returned to Singapore.\\\\n\\\\nCNA has reached out to MFA for comment.\\\\n\\\\nAdditional reporting by Kyodo\\\",\\n    \\\"authors\\\": \\\"Unknown Author\\\",\\n    \\\"publisher_href\\\": \\\"https://www.scmp.com\\\"\\n}\\n\\n# convert JSON data to string\\narticle_data_json = json.dumps(article_data)\\n\\n# hash the JSON string\\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\\n\\n# pass the hash to the downstream nodes\\nprint(\\\"${setValue(article_data_hash=%s)}\\\" % str(article_data_hash))\",\"resourceList\":[]}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "hash_article_data"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2394"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471727617984"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045451"
    }
  },
  "taskAppId" : "812_2394",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.909 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.910 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.910 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.914 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.915 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.917 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394 check successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.918 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.python.PythonTaskChannel successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.919 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.928 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: PYTHON create successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.928 +0800 o.a.d.p.t.p.PythonTask:[75] - Initialize python task params {
  "localParams" : [ {
    "prop" : "article_data_hash",
    "direct" : "OUT",
    "type" : "VARCHAR",
    "value" : ""
  } ],
  "varPool" : null,
  "rawScript" : "import hashlib\nimport json\n\narticle_data = {\n    \"title\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post\",\n    \"datetime\": \"Thu, 02 May 2024 08:01:58 GMT\",\n    \"description\": \"Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post\",\n    \"url\": \"https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en\",\n    \"context\": \"The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\\n\\nThe diplomat in question is a 55-year-old, who is a \\u201cformer\\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\\n\\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\\n\\nStaff members at the public bath in Tokyo\\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\\u2019s phone and found \\u201cmultiple naked photos of male customers\\u201d, according to the Asahi newspaper.\\n\\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\\n\\nWhen asked to delete the photos from his phone, the diplomat \\u201cdeleted them on the spot\\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\\n\\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\\n\\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\\n\\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \\u201ccompleted his assignment as of April 12\\u201d and has returned to Singapore.\\n\\nCNA has reached out to MFA for comment.\\n\\nAdditional reporting by Kyodo\",\n    \"authors\": \"Unknown Author\",\n    \"publisher_href\": \"https://www.scmp.com\"\n}\n\n# convert JSON data to string\narticle_data_json = json.dumps(article_data)\n\n# hash the JSON string\narticle_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()\n\n# pass the hash to the downstream nodes\nprint(\"${setValue(article_data_hash=%s)}\" % str(article_data_hash))",
  "resourceList" : [ ]
}
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.929 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.929 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [] successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.929 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.930 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.930 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.930 +0800 o.a.d.p.t.p.PythonTask:[165] - raw python script : import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.931 +0800 o.a.d.p.t.p.PythonTask:[131] - tenantCode :default, task dir:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.931 +0800 o.a.d.p.t.p.PythonTask:[134] - generate python script file:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394/py_812_2394.py
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.932 +0800 o.a.d.p.t.p.PythonTask:[141] - #-*- encoding=utf8 -*-

import hashlib
import json

article_data = {
    "title": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse - South China Morning Post",
    "datetime": "Thu, 02 May 2024 08:01:58 GMT",
    "description": "Singapore diplomat accused of filming naked boy at Tokyo bathhouse  South China Morning Post",
    "url": "https://news.google.com/rss/articles/CBMinQFodHRwczovL3d3dy5zY21wLmNvbS9uZXdzL2FzaWEvc291dGhlYXN0LWFzaWEvYXJ0aWNsZS8zMjYxMTc4L2phcGFuLXBvbGljZS1pbnZlc3RpZ2F0ZS1zaW5nYXBvcmUtZGlwbG9tYXQtYWxsZWdlZGx5LWZpbG1pbmctbmFrZWQtc2Nob29sYm95LXRva3lvLXB1YmxpYy1iYXRo0gGdAWh0dHBzOi8vYW1wLnNjbXAuY29tL25ld3MvYXNpYS9zb3V0aGVhc3QtYXNpYS9hcnRpY2xlLzMyNjExNzgvamFwYW4tcG9saWNlLWludmVzdGlnYXRlLXNpbmdhcG9yZS1kaXBsb21hdC1hbGxlZ2VkbHktZmlsbWluZy1uYWtlZC1zY2hvb2xib3ktdG9reW8tcHVibGljLWJhdGg?oc=5&hl=en-SG&gl=SG&ceid=SG:en",
    "context": "The Yomiuri newspaper reported that on February 27, the man used his smartphone to secretly film a 13-year-old secondary school student in the changing room of a public bath. The boy was naked.\n\nThe diplomat in question is a 55-year-old, who is a \u201cformer\u201d counsellor at the embassy, according to NHK. A counsellor is a diplomatic rank for officers serving overseas, such as in an embassy.\n\nA diplomat at the Singapore embassy in Tokyo was questioned by police after being suspected of filming a male teenager at a public bath, according to Japanese media reports on Thursday.\n\nStaff members at the public bath in Tokyo\u2019s Minato ward reportedly called the police who, upon arriving, searched the diplomat\u2019s phone and found \u201cmultiple naked photos of male customers\u201d, according to the Asahi newspaper.\n\nIt added that the diplomat refused to go to the police station but told officers he had taken such photos in other public baths.\n\nWhen asked to delete the photos from his phone, the diplomat \u201cdeleted them on the spot\u201d, reported the Japanese news outlet. He allegedly deleted 700 photos from his phone, which he told police he had taken in the six months leading up to the incident.\n\nThe Tokyo police are investigating potential violations of child pornography laws and are planning to ask Singapore\u2019s Ministry of Foreign Affairs (MFA) to have the man turn himself in, said Asahi. Formal charges are also being considered.\n\nThe diplomat has been dismissed as a counsellor but is immune to arrest in accordance with the Vienna Convention on Diplomatic Relations, which states that diplomats cannot be arrested or detained in a country they have been dispatched to.\n\nWhen asked by the Asahi newspaper on Thursday, the embassy was reportedly unaware of the public bath incident. The embassy also told the paper the diplomat had \u201ccompleted his assignment as of April 12\u201d and has returned to Singapore.\n\nCNA has reached out to MFA for comment.\n\nAdditional reporting by Kyodo",
    "authors": "Unknown Author",
    "publisher_href": "https://www.scmp.com"
}

# convert JSON data to string
article_data_json = json.dumps(article_data)

# hash the JSON string
article_data_hash = hashlib.sha256(article_data_json.encode()).hexdigest()

# pass the hash to the downstream nodes
print("${setValue(article_data_hash=%s)}" % str(article_data_hash))
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.933 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[64] - Final Shell file is: 
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.933 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[65] - ****************************** Script Content *****************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.933 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[67] - #!/bin/bash
BASEDIR=$(cd `dirname $0`; pwd)
cd $BASEDIR
export PYTHON_LAUNCHER=/bin/python3.11
${PYTHON_LAUNCHER} /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394/py_812_2394.py
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.933 +0800 o.a.d.p.t.a.s.BaseLinuxShellInterceptorBuilder:[68] - ****************************** Script Content *****************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.933 +0800 o.a.d.p.t.a.s.BaseShellInterceptor:[46] - Executing shell command : sudo -u default -i /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394/812_2394.sh
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:51.943 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[154] - process start, process id is: 1517
[WI-0][TI-2394] - [INFO] 2024-05-03 04:54:52.403 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2394, success=true)
[WI-0][TI-2394] - [INFO] 2024-05-03 04:54:52.413 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionInfoEventAckListenFunction:[45] - Receive TaskInstanceExecutionInfoEventAck: TaskInstanceExecutionInfoEventAck(success=true, taskInstanceId=2394)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:52.945 +0800 o.a.d.p.t.a.AbstractTask:[169] -  -> 
	sudo: unable to change directory to /home/default: No such file or directory
	${setValue(article_data_hash=c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df)}
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.950 +0800 o.a.d.p.t.a.AbstractCommandExecutor:[204] - process has exited. execute path:/tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394, processId:1517 ,exitStatusCode:0 ,processWaitForStatus:true ,processExitValue:0
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.951 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.956 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.956 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.969 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.971 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.972 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2394
[WI-812][TI-2394] - [INFO] 2024-05-03 04:54:52.973 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2394] - [INFO] 2024-05-03 04:54:53.396 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2394, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:54:53.524 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[53] - Receive TaskInstanceDispatchRequest: TaskInstanceDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2395, taskName=check if it exists in the database, firstSubmitTime=1714683293512, startTime=0, taskType=SQL, workflowInstanceHost=172.18.0.10:5678, host=172.18.1.1:1234, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13471825071552, processDefineVersion=5, appIds=null, processInstanceId=812, scheduleTime=0, globalParams=null, executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"resourceList":[],"type":"POSTGRESQL","datasource":5,"sql":"SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}","sqlType":"0","preStatements":["CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);"],"postStatements":[],"displayRows":10}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check if it exists in the database'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2395'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13472192399424'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503045453'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='812'}, article_data_hash=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='extract_gnews_articles_hashing_subprocess'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13471825071552'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=org.apache.dolphinscheduler.plugin.task.api.parameters.resource.ResourceParametersHelper@1e313911, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.525 +0800 o.a.d.s.w.r.o.TaskInstanceDispatchOperationFunction:[79] - Submit task: check if it exists in the database to wait queue success
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.527 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.528 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[191] - Begin to initialize task
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[195] - Set task startTime: 1714683293528
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[200] - Set task appId: 812_2395
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.528 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[202] - End initialize task {
  "taskInstanceId" : 2395,
  "taskName" : "check if it exists in the database",
  "firstSubmitTime" : 1714683293512,
  "startTime" : 1714683293528,
  "taskType" : "SQL",
  "workflowInstanceHost" : "172.18.0.10:5678",
  "host" : "172.18.1.1:1234",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13471825071552/5/812/2395.log",
  "processId" : 0,
  "processDefineCode" : 13471825071552,
  "processDefineVersion" : 5,
  "processInstanceId" : 812,
  "scheduleTime" : 0,
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"resourceList\":[],\"type\":\"POSTGRESQL\",\"datasource\":5,\"sql\":\"SELECT *\\nFROM article_hashes\\nWHERE hash = ${article_data_hash}\",\"sqlType\":\"0\",\"preStatements\":[\"CREATE TABLE IF NOT EXISTS article_hashes (\\n\\t    hash TEXT NOT NULL\\n\\t);\"],\"postStatements\":[],\"displayRows\":10}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check if it exists in the database"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2395"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13472192399424"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503045453"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "812"
    },
    "article_data_hash" : {
      "prop" : "article_data_hash",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "extract_gnews_articles_hashing_subprocess"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13471825071552"
    }
  },
  "taskAppId" : "812_2395",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "resourceParametersHelper" : {
    "resourceMap" : {
      "DATASOURCE" : {
        "5" : {
          "resourceType" : "DATASOURCE",
          "type" : "POSTGRESQL",
          "connectionParams" : "{\"user\":\"root\",\"password\":\"******\",\"address\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432\",\"database\":\"gnews_article_hash_db\",\"jdbcUrl\":\"jdbc:postgresql://dolphinscheduler-postgresql:5432/gnews_article_hash_db\",\"driverClassName\":\"org.postgresql.Driver\",\"validationQuery\":\"select version()\",\"other\":{\"password\":\"root\"}}",
          "DATASOURCE" : null
        }
      }
    }
  },
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"article_data_hash\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.529 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.529 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.529 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.540 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[209] - Send task status RUNNING_EXECUTION master: 172.18.1.1:1234
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.541 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[217] - TenantCode: default check successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[220] - WorkflowInstanceExecDir: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2395 check successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[227] - Create TaskChannel: org.apache.dolphinscheduler.plugin.task.sql.SqlTaskChannel successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[232] - Download resources successfully: 
ResourceContext(resourceItemMap={})
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.542 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[235] - Download upstream files: [] successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.s.SqlTask:[99] - Initialize sql task parameter {
  "localParams" : [ ],
  "varPool" : null,
  "type" : "POSTGRESQL",
  "datasource" : 5,
  "sql" : "SELECT *\nFROM article_hashes\nWHERE hash = ${article_data_hash}",
  "sqlType" : 0,
  "sendEmail" : null,
  "displayRows" : 10,
  "udfs" : null,
  "showType" : null,
  "connParams" : null,
  "preStatements" : [ "CREATE TABLE IF NOT EXISTS article_hashes (\n\t    hash TEXT NOT NULL\n\t);" ],
  "postStatements" : [ ],
  "groupId" : 0,
  "title" : null,
  "limit" : 0
}
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[239] - Task plugin instance: SQL create successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[243] - Success initialized task plugin instance successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[246] - Set taskVarPool: [{"prop":"article_data_hash","direct":"IN","type":"VARCHAR","value":"c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df"}] successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.s.SqlTask:[119] - Full sql parameters: SqlParameters{type='POSTGRESQL', datasource=5, sql='SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash}', sqlType=0, sendEmail=null, displayRows=10, limit=0, udfs='null', showType='null', connParams='null', groupId='0', title='null', preStatements=[CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);], postStatements=[]}
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.543 +0800 o.a.d.p.t.s.SqlTask:[120] - sql type : POSTGRESQL, datasource : 5, sql : SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} , localParams : [],udfs : null,showType : null,connParams : null,varPool : [Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}] ,query max result limit  0
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.544 +0800 o.a.d.p.t.a.AbstractTask:[206] - setSqlParamsMap: Property with paramName: article_data_hash put in sqlParamsMap of content SELECT *
FROM article_hashes
WHERE hash = ${article_data_hash} successfully.
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.544 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.545 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df(VARCHAR)
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.545 +0800 o.a.d.p.t.s.SqlTask:[410] - after replace sql , preparing : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.545 +0800 o.a.d.p.t.s.SqlTask:[420] - Sql Params are replaced sql , parameters:
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.545 +0800 o.a.d.p.t.s.SqlTask:[489] - can't find udf function resource
[WI-812][TI-2395] - [WARN] 2024-05-03 04:54:53.545 +0800 n.s.c.j.SnowflakeConnectString:[136] - Connect strings must start with jdbc:snowflake://
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.566 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);, sql parameters : {}
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.567 +0800 o.a.d.p.t.s.SqlTask:[328] - pre statement execute update result: 0, for sql: CREATE TABLE IF NOT EXISTS article_hashes (
	    hash TEXT NOT NULL
	);
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.568 +0800 o.a.d.p.t.s.SqlTask:[392] - prepare statement replace sql : SELECT *
FROM article_hashes
WHERE hash = ?, sql parameters : {1=Property{prop='article_data_hash', direct=IN, type=VARCHAR, value='c1890cda263e4d010c5292e71f03fbcca8e13aa3a5e703e6efcc2966dad482df'}}
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.568 +0800 o.a.d.p.t.s.SqlTask:[316] - main statement execute query, for sql: SELECT *
FROM article_hashes
WHERE hash = ?
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.581 +0800 o.a.d.p.t.s.SqlTask:[260] - display sql result 0 rows as follows:
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.582 +0800 o.a.d.p.t.s.SqlTask:[288] - sql query results is empty
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.584 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.584 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.584 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.585 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[289] - Upload output files: [] successfully
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.593 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[294] - Send task execute status: SUCCESS to master : 172.18.1.1:1234
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[111] - Remove the current task execute context from worker cache
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[301] - The current execute mode isn't develop mode, will clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2395
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[316] - Success clear the task execute file: /tmp/dolphinscheduler/exec/process/default/13010050770016/13471825071552_5/812/2395
[WI-812][TI-2395] - [INFO] 2024-05-03 04:54:53.594 +0800 o.a.d.s.w.r.WorkerTaskExecutor:[342] - FINALIZE_SESSION
[WI-0][TI-2395] - [INFO] 2024-05-03 04:54:54.406 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionRunningEventAckListenFunction:[44] - Receive TaskInstanceExecutionRunningEventAck: TaskInstanceExecutionRunningEventAck(taskInstanceId=2395, success=true)
[WI-0][TI-2395] - [INFO] 2024-05-03 04:54:54.415 +0800 o.a.d.s.w.r.l.TaskInstanceExecutionFinishEventAckListenFunction:[44] - Receive TaskInstanceExecutionFinishEventAck: TaskInstanceExecutionFinishEventAck(taskInstanceId=2395, success=true)
[WI-0][TI-0] - [INFO] 2024-05-03 04:55:06.379 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7994428969359331 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 04:55:08.415 +0800 o.a.d.s.w.c.WorkerServerLoadProtection:[48] - Worker OverLoad: the TotalCpuUsedPercentage: 0.7915590954865881 is over then the MaxCpuUsagePercentageThresholds 0.7
