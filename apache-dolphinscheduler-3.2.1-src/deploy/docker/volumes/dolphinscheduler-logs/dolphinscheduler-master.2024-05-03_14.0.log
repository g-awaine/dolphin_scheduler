[WI-0][TI-0] - [INFO] 2024-05-03 14:00:02.847 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:07.866 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:12.898 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:17.923 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:22.943 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:27.972 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:32.984 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:38.029 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:43.047 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:47.646 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7908309455587392 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:00:47.663 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:47.663 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7908309455587392 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:48.060 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:48.692 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8320000000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:00:48.692 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:48.707 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8320000000000001 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.076 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.714 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 12ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.783 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=840)
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.783 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=840)
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.783 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=840)
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.783 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=840)
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 3
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 3, recover flag: NO
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.799 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.805 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.805 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.808 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.822 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2625, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:53.854 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.856 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.856 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:53.857 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.857 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.863 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:53.874 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2625, processInstanceId=840, startTime=1714716053872, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.482 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.488 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.488 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.494 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2625, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.494 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.523 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:54.524 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.570 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2625, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.570 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:54.898 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=Fri May 03 14:00:54 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2625, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, processId=5637, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.483 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=Fri May 03 14:00:54 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2625, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, processId=5637, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.489 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2625, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.489 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2625, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:00:53 GMT+08:00 2024, endTime=Fri May 03 14:00:54 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2625, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2625.log, processId=5637, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:55.489 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2625, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.584 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.584 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.584 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.584 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.593 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.594 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.594 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.596 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2625] - [INFO] 2024-05-03 14:00:55.597 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2626, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.601 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:55.603 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2626, taskName=check file existence, firstSubmitTime=1714716055596, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=19, appIds=null, processInstanceId=840, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2626'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140055'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='840'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.603 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.604 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.609 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.609 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.609 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716055609
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.609 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 840_2626
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:55.606 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.610 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2626,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716055596,
  "startTime" : 1714716055609,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 19,
  "processInstanceId" : 840,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2626"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140055"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "840"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "840_2626",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.610 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:55.604 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:53 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:53 GMT+08:00 2024
Start Time:             Fri May 03 14:00:53 GMT+08:00 2024
End Time:               Fri May 03 14:00:54 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:00:55.611 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2626, processInstanceId=840, startTime=1714716055609, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-840][TI-2626] - [ERROR] 2024-05-03 14:00:55.612 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.613 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2626] - [ERROR] 2024-05-03 14:00:55.613 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2626] - [WARN] 2024-05-03 14:00:55.613 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.613 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:55 GMT+08:00 2024, endTime=Fri May 03 14:00:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.614 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.614 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.614 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:55.614 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.491 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.505 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.506 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:56.512 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=752), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2626] - [ERROR] 2024-05-03 14:00:56.513 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:55 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.513 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:55 GMT+08:00 2024, endTime=Fri May 03 14:00:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:56.516 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=753), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2626] - [WARN] 2024-05-03 14:00:56.521 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2626
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.521 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2626, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.521 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2626, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:55 GMT+08:00 2024, endTime=Fri May 03 14:00:55 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2626.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:56.521 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2626, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.610 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.611 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.611 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.612 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2626] - [INFO] 2024-05-03 14:00:56.613 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2627, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.633 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:56.633 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:56.633 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:56.633 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:56.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:55 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:55 GMT+08:00 2024
Start Time:             Fri May 03 14:00:55 GMT+08:00 2024
End Time:               Fri May 03 14:00:55 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:00:56.635 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2627, taskName=check file existence, firstSubmitTime=1714716056612, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=19, appIds=null, processInstanceId=840, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2627'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140056'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='840'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.635 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.636 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.691 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.691 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716056691
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.692 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 840_2627
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.692 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2627,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716056612,
  "startTime" : 1714716056691,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 19,
  "processInstanceId" : 840,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2627"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140056"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "840"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "840_2627",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.692 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:56.685 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:56.699 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2627, processInstanceId=840, startTime=1714716056691, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.702 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.702 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.703 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-840][TI-2627] - [ERROR] 2024-05-03 14:00:56.705 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.705 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2627] - [ERROR] 2024-05-03 14:00:56.705 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2627] - [WARN] 2024-05-03 14:00:56.705 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.711 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:56 GMT+08:00 2024, endTime=Fri May 03 14:00:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.712 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.713 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.713 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:56.713 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.501 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.514 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.514 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:57.519 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=757), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2627] - [ERROR] 2024-05-03 14:00:57.521 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:56 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.521 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:56 GMT+08:00 2024, endTime=Fri May 03 14:00:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:57.524 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=758), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2627] - [WARN] 2024-05-03 14:00:57.525 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2627
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.525 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2627, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.525 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2627, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:56 GMT+08:00 2024, endTime=Fri May 03 14:00:56 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2627.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:57.526 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2627, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.619 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.621 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.623 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2627] - [INFO] 2024-05-03 14:00:57.624 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2628, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.630 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:57.632 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2628, taskName=check file existence, firstSubmitTime=1714716057623, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=19, appIds=null, processInstanceId=840, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2628'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140057'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='840'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.633 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.633 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:57.630 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.641 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:57.641 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716057642
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 840_2628
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:56 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:56 GMT+08:00 2024
Start Time:             Fri May 03 14:00:56 GMT+08:00 2024
End Time:               Fri May 03 14:00:56 GMT+08:00 2024

[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.642 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2628,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716057623,
  "startTime" : 1714716057642,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 19,
  "processInstanceId" : 840,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2628"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140057"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "840"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "840_2628",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.643 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:57.643 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:57.644 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2628, processInstanceId=840, startTime=1714716057642, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.644 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.644 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-840][TI-2628] - [ERROR] 2024-05-03 14:00:57.645 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.645 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.646 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.646 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2628] - [ERROR] 2024-05-03 14:00:57.646 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2628] - [WARN] 2024-05-03 14:00:57.646 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.647 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:57 GMT+08:00 2024, endTime=Fri May 03 14:00:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.648 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.649 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.649 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:57.649 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:58.104 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.509 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.530 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.549 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:58.560 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=762), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2628] - [ERROR] 2024-05-03 14:00:58.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:57 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.563 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:57 GMT+08:00 2024, endTime=Fri May 03 14:00:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:58.589 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=763), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2628] - [WARN] 2024-05-03 14:00:58.592 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2628
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.592 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2628, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.593 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2628, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:57 GMT+08:00 2024, endTime=Fri May 03 14:00:57 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2628.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:58.593 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2628, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.634 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.641 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2628] - [INFO] 2024-05-03 14:00:58.645 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2629, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.673 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:58.673 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:58.673 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:58.673 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:58.673 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:57 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:57 GMT+08:00 2024
Start Time:             Fri May 03 14:00:57 GMT+08:00 2024
End Time:               Fri May 03 14:00:57 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:00:58.676 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2629, taskName=check file existence, firstSubmitTime=1714716058642, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=19, appIds=null, processInstanceId=840, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2629'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140058'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='840'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.677 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.677 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.688 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.693 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:58.693 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.693 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.694 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716058694
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.694 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 840_2629
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.695 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2629,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716058642,
  "startTime" : 1714716058694,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 19,
  "processInstanceId" : 840,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2629"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140058"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "840"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "840_2629",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.696 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:58.697 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2629, processInstanceId=840, startTime=1714716058694, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.700 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.702 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-840][TI-2629] - [ERROR] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.703 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-840][TI-2629] - [ERROR] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2629] - [WARN] 2024-05-03 14:00:58.703 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.704 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:58 GMT+08:00 2024, endTime=Fri May 03 14:00:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.706 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.706 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.706 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:58.706 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.510 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.516 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:59.519 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=767), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2629] - [ERROR] 2024-05-03 14:00:59.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:58 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:58 GMT+08:00 2024, endTime=Fri May 03 14:00:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:00:59.526 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=768), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 121, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-840][TI-2629] - [WARN] 2024-05-03 14:00:59.527 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2629
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.528 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2629, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.528 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2629, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:58 GMT+08:00 2024, endTime=Fri May 03 14:00:58 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2629.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:59.528 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.557 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2629, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.558 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.558 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.558 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.558 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.573 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.573 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.574 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.576 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2629] - [INFO] 2024-05-03 14:00:59.577 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2630, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2630] - [INFO] 2024-05-03 14:00:59.581 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:00:59.582 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:58 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:58 GMT+08:00 2024
Start Time:             Fri May 03 14:00:58 GMT+08:00 2024
End Time:               Fri May 03 14:00:58 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:00:59.595 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:00:59.599 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2630, processInstanceId=840, startTime=1714716059591, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.512 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.531 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.532 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.555 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2630, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.556 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.556 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.561 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:00.561 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.575 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2630, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.581 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:00.662 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=Fri May 03 14:01:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2630, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, processId=5657, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:00.813 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7025495750708215 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:01:00.814 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:00.846 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7025495750708215 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.512 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=Fri May 03 14:01:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2630, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, processId=5657, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.519 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2630, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.519 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2630, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:00:59 GMT+08:00 2024, endTime=Fri May 03 14:01:00 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2630, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2630.log, processId=5657, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:01.519 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2630, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.600 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.602 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.604 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2630] - [INFO] 2024-05-03 14:01:01.605 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2631, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:01.613 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:01.614 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:01.614 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:01.614 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:01.614 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:00:59 GMT+08:00 2024
Submit Time:            Fri May 03 14:00:59 GMT+08:00 2024
Start Time:             Fri May 03 14:00:59 GMT+08:00 2024
End Time:               Fri May 03 14:01:00 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:01:01.623 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2631, processInstanceId=840, startTime=1714716061621, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:01.623 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:01.832 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7590027700831025 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:01:01.832 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:01.874 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7590027700831025 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.513 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2631, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [WARN] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.522 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.527 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:02.527 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.541 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2631, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.541 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:02.655 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=Fri May 03 14:01:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2631, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, processId=5669, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:03.138 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.520 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=Fri May 03 14:01:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2631, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, processId=5669, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.530 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2631, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.530 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2631, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:01 GMT+08:00 2024, endTime=Fri May 03 14:01:02 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2631, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2631.log, processId=5669, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:03.530 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.558 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2631, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.561 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.561 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.561 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.561 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.561 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.566 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.566 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.566 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.569 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2631] - [INFO] 2024-05-03 14:01:03.572 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2632, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:03.591 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:03.591 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:03.592 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:03.592 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:03.592 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:01:01 GMT+08:00 2024
Submit Time:            Fri May 03 14:01:01 GMT+08:00 2024
Start Time:             Fri May 03 14:01:01 GMT+08:00 2024
End Time:               Fri May 03 14:01:02 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:01:03.597 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:03.601 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2632, processInstanceId=840, startTime=1714716063596, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.520 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.525 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.526 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.550 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2632, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.550 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.551 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.557 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:04.557 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.577 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2632, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.577 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:04.624 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=Fri May 03 14:01:04 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2632, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, processId=5680, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.526 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=Fri May 03 14:01:04 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2632, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, processId=5680, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.554 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2632, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.554 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2632, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:03 GMT+08:00 2024, endTime=Fri May 03 14:01:04 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2632, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2632.log, processId=5680, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:05.554 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2632, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.589 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.594 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.596 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.596 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.597 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:840, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2632] - [INFO] 2024-05-03 14:01:05.600 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2633, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:840, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:05.607 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:05.608 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:05.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:05.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-840][TI-0] - [INFO] 2024-05-03 14:01:05.609 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:01:03 GMT+08:00 2024
Submit Time:            Fri May 03 14:01:03 GMT+08:00 2024
Start Time:             Fri May 03 14:01:03 GMT+08:00 2024
End Time:               Fri May 03 14:01:04 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:01:05.613 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:05.615 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2633, processInstanceId=840, startTime=1714716065613, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.528 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.538 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.538 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.546 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2633, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.549 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.549 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.572 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:06.572 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.610 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2633, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.614 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:06.670 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=Fri May 03 14:01:06 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2633, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, processId=5691, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.534 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=Fri May 03 14:01:06 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2633, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, processId=5691, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.543 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=840, taskInstanceId=2633, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.543 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2633, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:01:05 GMT+08:00 2024, endTime=Fri May 03 14:01:06 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_19/840/2633, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/19/840/2633.log, processId=5691, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=840)
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:07.544 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-840] persist events succeeded
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=840, taskInstanceId=2633, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.638 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.638 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.638 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.638 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:preprocessing and kafka, task id:null, task code:13475238524229
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: preprocessing and kafka depend result : FAILED
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.640 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.646 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-2633] - [INFO] 2024-05-03 14:01:07.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-17-20240503135422295
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:01:05 GMT+08:00 2024
Submit Time:            Fri May 03 14:01:05 GMT+08:00 2024
Start Time:             Fri May 03 14:01:05 GMT+08:00 2024
End Time:               Fri May 03 14:01:06 GMT+08:00 2024

[WI-840][TI-null] - [INFO] 2024-05-03 14:01:07.647 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=840, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-840][TI-null] - [INFO] 2024-05-03 14:01:07.648 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-840][TI-null] - [INFO] 2024-05-03 14:01:07.649 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-17-20240503135422295
Command Type:              REPEAT_RUNNING
State:                     failure
Host:                      172.18.0.12:5678
Is Sub Process:            no
Run Times:                 3
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Fri May 03 14:00:53 GMT+08:00 2024
Work Group:                default
Start Time:                Fri May 03 14:00:53 GMT+08:00 2024
End Time:                  Fri May 03 14:01:07 GMT+08:00 2024

[WI-840][TI-0] - [INFO] 2024-05-03 14:01:07.649 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:08.153 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:13.204 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:18.220 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:23.235 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:28.260 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:33.278 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:38.340 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:43.370 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:48.388 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:53.418 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:56.293 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:01:56.294 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:01:58.451 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:03.477 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:08.498 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:13.537 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:18.571 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:23.590 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:28.611 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:33.630 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:38.647 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:43.673 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:48.709 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:53.729 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:02:58.746 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:03.772 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:08.786 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:13.407 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:13.803 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:18.824 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:22.448 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:03:22.449 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:23.455 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:03:23.456 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:23.837 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:28.869 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:33.940 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:38.965 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:43.985 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:49.021 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:54.055 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:03:59.071 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:04.103 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:09.141 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:14.164 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:19.181 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:24.196 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:29.233 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:34.260 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:39.275 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:44.290 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:49.315 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:54.349 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 10/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:04:59.375 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:04.409 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:07.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.3333333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:09.465 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:14.493 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:19.520 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:24.533 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:29.564 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:34.591 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 14/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:39.616 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:44.102 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:05:44.103 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:44.638 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:49.651 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:54.670 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:05:59.690 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:04.706 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:09.718 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:14.757 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:18.245 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7824858757062146 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:18.246 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7824858757062146 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:06:18.246 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:19.804 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:24.834 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:29.887 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:34.909 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:39.929 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:44.948 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:49.965 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:06:55.003 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:00.016 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:05.031 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:10.049 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:15.074 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:20.094 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:25.604 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:30.631 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:35.647 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:40.659 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:45.686 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 18/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:50.702 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:07:55.714 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:00.733 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:05.779 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 7/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:09.734 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7956403269754767 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:09.734 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7956403269754767 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:08:09.734 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:10.791 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:15.821 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:20.874 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:22.789 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8083333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:08:22.790 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:22.825 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8083333333333333 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:25.902 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:26.805 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 1ms, current slot: 0, total slot size: 1
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.841 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=841)
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.842 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:26.841 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=841)
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.842 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=841)
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.852 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.857 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.859 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2634, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:26.881 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.881 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.881 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:26.881 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:26.881 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:26.890 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:26.923 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2634, processInstanceId=841, startTime=1714716506903, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.680 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2634, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.680 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.680 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:27.687 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.759 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2634, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.759 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:27.999 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=Fri May 03 14:08:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2634, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, processId=5786, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=Fri May 03 14:08:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2634, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, processId=5786, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.688 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2634, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.689 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2634, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:08:26 GMT+08:00 2024, endTime=Fri May 03 14:08:27 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2634, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2634.log, processId=5786, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:28.689 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.781 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2634, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.781 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.781 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.781 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.781 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.796 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.798 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.800 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2634] - [INFO] 2024-05-03 14:08:28.801 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2635, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.806 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:28.807 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2635, taskName=check file existence, firstSubmitTime=1714716508800, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=20, appIds=null, processInstanceId=841, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2635'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140828'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='841'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.808 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.809 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716508823
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 841_2635
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.823 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2635,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716508800,
  "startTime" : 1714716508823,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 20,
  "processInstanceId" : 841,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2635"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140828"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "841"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "841_2635",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.824 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:28.821 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.825 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.825 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.825 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:28.825 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:26 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:26 GMT+08:00 2024
Start Time:             Fri May 03 14:08:26 GMT+08:00 2024
End Time:               Fri May 03 14:08:27 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:28.826 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2635, processInstanceId=841, startTime=1714716508823, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.827 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.827 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.827 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.828 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-841][TI-2635] - [ERROR] 2024-05-03 14:08:28.830 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.830 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2635] - [ERROR] 2024-05-03 14:08:28.830 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2635] - [WARN] 2024-05-03 14:08:28.831 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.832 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:28 GMT+08:00 2024, endTime=Fri May 03 14:08:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.833 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.833 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.833 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:28.834 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.665 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.669 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.670 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:29.673 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=792), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2635] - [ERROR] 2024-05-03 14:08:29.674 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:28 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.675 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:28 GMT+08:00 2024, endTime=Fri May 03 14:08:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:29.711 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=793), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2635] - [WARN] 2024-05-03 14:08:29.718 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2635
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.719 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2635, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.719 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2635, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:28 GMT+08:00 2024, endTime=Fri May 03 14:08:28 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2635.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:29.720 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.795 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2635, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.796 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.797 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.800 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2635] - [INFO] 2024-05-03 14:08:29.802 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2636, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.833 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:29.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:29.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:29.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:29.834 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:28 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:28 GMT+08:00 2024
Start Time:             Fri May 03 14:08:28 GMT+08:00 2024
End Time:               Fri May 03 14:08:28 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:29.835 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2636, taskName=check file existence, firstSubmitTime=1714716509800, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=20, appIds=null, processInstanceId=841, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2636'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140829'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='841'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.836 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.840 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.840 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.840 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.840 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716509840
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.840 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 841_2636
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.841 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2636,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716509800,
  "startTime" : 1714716509840,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 20,
  "processInstanceId" : 841,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2636"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140829"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "841"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "841_2636",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.841 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.841 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.841 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:29.842 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:29.845 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2636, processInstanceId=841, startTime=1714716509840, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.848 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-841][TI-2636] - [ERROR] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.849 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2636] - [ERROR] 2024-05-03 14:08:29.849 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2636] - [WARN] 2024-05-03 14:08:29.850 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.853 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:29 GMT+08:00 2024, endTime=Fri May 03 14:08:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.856 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.856 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.856 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:29.856 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.672 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.687 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:30.706 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=797), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2636] - [ERROR] 2024-05-03 14:08:30.707 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:29 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.707 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:29 GMT+08:00 2024, endTime=Fri May 03 14:08:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:30.710 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=798), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 105, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2636] - [WARN] 2024-05-03 14:08:30.711 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2636
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.711 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2636, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.711 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2636, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:29 GMT+08:00 2024, endTime=Fri May 03 14:08:29 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2636.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.712 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.807 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2636, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.807 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.807 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.808 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.809 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2636] - [INFO] 2024-05-03 14:08:30.811 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2637, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.817 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:30.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:30.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:30.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:30.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:29 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:29 GMT+08:00 2024
Start Time:             Fri May 03 14:08:29 GMT+08:00 2024
End Time:               Fri May 03 14:08:29 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.818 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2637, taskName=check file existence, firstSubmitTime=1714716510809, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=20, appIds=null, processInstanceId=841, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2637'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140830'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='841'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.819 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.821 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.821 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.825 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.826 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.826 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.826 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716510826
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.826 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 841_2637
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.826 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2637,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716510809,
  "startTime" : 1714716510826,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 20,
  "processInstanceId" : 841,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2637"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140830"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "841"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "841_2637",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.827 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.827 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.828 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.829 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2637, processInstanceId=841, startTime=1714716510826, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.830 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.830 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.831 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.832 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.832 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.832 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.833 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.834 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.836 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-841][TI-2637] - [ERROR] 2024-05-03 14:08:30.837 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.837 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.838 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2637] - [ERROR] 2024-05-03 14:08:30.839 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2637] - [WARN] 2024-05-03 14:08:30.840 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.842 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:30 GMT+08:00 2024, endTime=Fri May 03 14:08:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.846 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.846 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.847 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:30.847 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.856 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7584269662921348 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.859 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7584269662921348 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:08:30.860 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:30.925 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.670 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.674 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.674 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:31.677 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=802), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2637] - [ERROR] 2024-05-03 14:08:31.678 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:30 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.678 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:30 GMT+08:00 2024, endTime=Fri May 03 14:08:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:31.682 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=803), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2637] - [WARN] 2024-05-03 14:08:31.683 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2637
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.683 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2637, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2637, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:30 GMT+08:00 2024, endTime=Fri May 03 14:08:30 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2637.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:31.684 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.723 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2637, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.724 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.724 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.724 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.724 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.724 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.725 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.725 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.725 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.736 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2637] - [INFO] 2024-05-03 14:08:31.738 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2638, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:31.749 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2638, taskName=check file existence, firstSubmitTime=1714716511736, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=20, appIds=null, processInstanceId=841, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2638'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503140831'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='841'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.750 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.747 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.751 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:31.754 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:31.753 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.758 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716511759
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 841_2638
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.759 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2638,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716511736,
  "startTime" : 1714716511759,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 20,
  "processInstanceId" : 841,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2638"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503140831"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "841"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "841_2638",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:31.758 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.765 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.766 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.766 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:31.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:31.767 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:30 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:30 GMT+08:00 2024
Start Time:             Fri May 03 14:08:30 GMT+08:00 2024
End Time:               Fri May 03 14:08:30 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:31.768 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2638, processInstanceId=841, startTime=1714716511759, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.769 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.770 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-841][TI-2638] - [ERROR] 2024-05-03 14:08:31.771 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.771 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.771 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.771 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-841][TI-2638] - [ERROR] 2024-05-03 14:08:31.771 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2638] - [WARN] 2024-05-03 14:08:31.771 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.773 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:31 GMT+08:00 2024, endTime=Fri May 03 14:08:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.775 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.775 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.775 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:31.775 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.676 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.685 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:32.689 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=807), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2638] - [ERROR] 2024-05-03 14:08:32.691 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.691 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:31 GMT+08:00 2024, endTime=Fri May 03 14:08:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:08:32.696 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=808), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 122, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-841][TI-2638] - [WARN] 2024-05-03 14:08:32.697 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2638
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.697 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2638, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.698 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2638, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:31 GMT+08:00 2024, endTime=Fri May 03 14:08:31 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2638.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:32.698 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2638, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.756 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.757 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.757 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.757 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.760 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.803 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2638] - [INFO] 2024-05-03 14:08:32.805 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2639, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:32.839 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.841 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:32.842 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:31 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:31 GMT+08:00 2024
Start Time:             Fri May 03 14:08:31 GMT+08:00 2024
End Time:               Fri May 03 14:08:31 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:32.848 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:32.853 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2639, processInstanceId=841, startTime=1714716512844, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.681 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.712 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.712 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.722 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2639, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.722 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.722 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.729 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:33.729 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.782 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2639, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.786 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:33.910 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=Fri May 03 14:08:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2639, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, processId=5805, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.678 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=Fri May 03 14:08:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2639, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, processId=5805, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.684 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2639, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.685 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2639, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:32 GMT+08:00 2024, endTime=Fri May 03 14:08:33 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2639, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2639.log, processId=5805, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:34.685 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.700 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2639, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.701 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.702 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.702 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.702 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.705 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.712 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.714 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2639] - [INFO] 2024-05-03 14:08:34.716 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2640, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:34.725 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:34.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:34.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:34.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:34.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:32 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:32 GMT+08:00 2024
Start Time:             Fri May 03 14:08:32 GMT+08:00 2024
End Time:               Fri May 03 14:08:33 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:34.732 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:34.732 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2640, processInstanceId=841, startTime=1714716514729, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:34.868 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492795389048992 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:08:34.868 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:34.886 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7492795389048992 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.680 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.684 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.690 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2640, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.691 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.697 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:35.697 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.714 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2640, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.714 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:35.797 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=Fri May 03 14:08:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2640, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, processId=5817, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:35.869 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7122905027932961 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:08:35.869 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:35.894 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7122905027932961 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:35.939 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.683 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=Fri May 03 14:08:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2640, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, processId=5817, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.707 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2640, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.707 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2640, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:34 GMT+08:00 2024, endTime=Fri May 03 14:08:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2640, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2640.log, processId=5817, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:36.708 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.726 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2640, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.727 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.727 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.727 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.727 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.727 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.737 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.737 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.737 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.753 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2640] - [INFO] 2024-05-03 14:08:36.759 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2641, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:36.783 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:36.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:36.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:36.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:36.784 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:34 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:34 GMT+08:00 2024
Start Time:             Fri May 03 14:08:34 GMT+08:00 2024
End Time:               Fri May 03 14:08:35 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:36.789 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:36.790 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2641, processInstanceId=841, startTime=1714716516788, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.686 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.690 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.691 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.699 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2641, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.700 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.700 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.704 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:37.704 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.742 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2641, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.746 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:37.810 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=Fri May 03 14:08:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2641, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, processId=5828, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.687 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=Fri May 03 14:08:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2641, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, processId=5828, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.705 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2641, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.705 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2641, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:36 GMT+08:00 2024, endTime=Fri May 03 14:08:37 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2641, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2641.log, processId=5828, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:38.705 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.754 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2641, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.754 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.755 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.755 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.755 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.756 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.765 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.768 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:841, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2641] - [INFO] 2024-05-03 14:08:38.770 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2642, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:841, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:38.802 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:38.802 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:38.802 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:38.802 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-841][TI-0] - [INFO] 2024-05-03 14:08:38.804 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:36 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:36 GMT+08:00 2024
Start Time:             Fri May 03 14:08:36 GMT+08:00 2024
End Time:               Fri May 03 14:08:37 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:08:38.818 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:38.823 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2642, processInstanceId=841, startTime=1714716518818, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.692 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.698 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.698 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.722 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2642, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.724 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.724 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.730 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:39.730 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.766 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2642, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.766 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:39.985 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=Fri May 03 14:08:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2642, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, processId=5839, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.692 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=Fri May 03 14:08:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2642, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, processId=5839, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.698 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=841, taskInstanceId=2642, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.698 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2642, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:08:38 GMT+08:00 2024, endTime=Fri May 03 14:08:39 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_20/841/2642, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/20/841/2642.log, processId=5839, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=841)
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:40.698 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-841] persist events succeeded
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.806 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=841, taskInstanceId=2642, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.807 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.807 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.807 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.807 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.809 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:preprocessing and kafka, task id:null, task code:13475238524229
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: preprocessing and kafka depend result : FAILED
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.810 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.812 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.816 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.817 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.818 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.818 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-2642] - [INFO] 2024-05-03 14:08:40.818 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-20-20240503140826809
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:08:38 GMT+08:00 2024
Submit Time:            Fri May 03 14:08:38 GMT+08:00 2024
Start Time:             Fri May 03 14:08:38 GMT+08:00 2024
End Time:               Fri May 03 14:08:39 GMT+08:00 2024

[WI-841][TI-null] - [INFO] 2024-05-03 14:08:40.818 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=841, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-841][TI-null] - [INFO] 2024-05-03 14:08:40.819 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-841][TI-null] - [INFO] 2024-05-03 14:08:40.820 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-20-20240503140826809
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.12:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Fri May 03 14:08:26 GMT+08:00 2024
Work Group:                default
Start Time:                Fri May 03 14:08:26 GMT+08:00 2024
End Time:                  Fri May 03 14:08:40 GMT+08:00 2024

[WI-841][TI-0] - [INFO] 2024-05-03 14:08:40.821 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:40.964 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:45.984 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:50.996 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:08:56.019 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:01.037 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:06.077 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:11.100 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:16.145 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:21.159 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:26.179 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:31.199 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:36.221 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:41.250 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:46.263 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:51.290 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:55.347 +0800 o.a.d.s.m.s.MasterFailoverService:[86] - Master failover service 172.18.0.12:5678 begin to failover hosts:[172.18.0.12:5678]
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:55.410 +0800 o.a.d.s.m.s.MasterFailoverService:[124] - Master[172.18.0.12:5678] failover starting there are 4 workflowInstance may need to failover, will do a deep check, workflowInstanceIds: [448, 508, 510, 511]
[WI-448][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-448][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-508][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-508][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-510][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-510][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-511][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[133] - WorkflowInstance failover starting
[WI-511][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[190] - The workflowInstance's restartTime is after the dead master startup time, no need to failover
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:55.411 +0800 o.a.d.s.m.s.MasterFailoverService:[148] - Master[172.18.0.12:5678] failover finished, useTime:12ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:09:56.302 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:01.330 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:06.347 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:11.360 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:16.385 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:21.412 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:26.427 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:28.425 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7470238095238095 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:28.425 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:28.475 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7470238095238095 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.452 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 5/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.473 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 4ms, current slot: 0, total slot size: 1
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.513 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=838)
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.515 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=838)
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.515 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=838)
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.521 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=838)
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.521 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[2027] - The workflowInstance has been executed before, this execution is to reRun, processInstance status: WorkflowExecutionStatus{code=1, desc='running'}, runTimes: 2
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.521 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[789] - The workflowInstance is not a newly running instance, runtimes: 2, recover flag: NO
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.524 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.524 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.526 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake JSON files, task id:null, task code:13340113777664
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.526 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake JSON files is success, so ready to submit to execute
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.527 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake JSON files, processInstance id:838, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.529 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2643, taskInstanceName: search for intake JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:838, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:31.533 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.533 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.533 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:31.533 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.534 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.539 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:31.539 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2643, processInstanceId=838, startTime=1714716631537, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.034 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.039 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.040 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.046 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=838, taskInstanceId=2643, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.046 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.046 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.069 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:32.069 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-838] persist events succeeded
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.078 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=838, taskInstanceId=2643, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.079 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:32.622 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=Fri May 03 14:10:32 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2643, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, processId=5872, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.034 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=Fri May 03 14:10:32 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2643, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, processId=5872, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.049 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=838, taskInstanceId=2643, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.050 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2643, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:31 GMT+08:00 2024, endTime=Fri May 03 14:10:32 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2643, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2643.log, processId=5872, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:33.050 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-838] persist events succeeded
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.120 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=838, taskInstanceId=2643, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.120 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.121 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.121 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.122 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.133 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13348933988640
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.133 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348933988640, dependTaskCodes: [13340113777664]
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.134 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.135 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:838, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-2643] - [INFO] 2024-05-03 14:10:33.137 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2644, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:838, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.142 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13340113777664 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.142 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.143 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:33.143 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2644, taskName=check file existence, firstSubmitTime=1714716633136, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13201021801792, processDefineVersion=120, appIds=null, processInstanceId=838, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=7, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13340390094208}],"nextNode":13348985859488}}, environmentConfig=export PYTHON_LAUNCHER=/bin/python3.11, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2644'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13348933988640'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503141033'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='838'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='null'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_post'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13201021801792'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.143 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.144 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:33.143 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake JSON files
Workflow Instance Name: preprocess_post-120-20240503134509362
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:10:31 GMT+08:00 2024
Submit Time:            Fri May 03 14:10:31 GMT+08:00 2024
Start Time:             Fri May 03 14:10:31 GMT+08:00 2024
End Time:               Fri May 03 14:10:32 GMT+08:00 2024

[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:33.149 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.151 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.152 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.152 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716633152
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.153 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 838_2644
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.154 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2644,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716633136,
  "startTime" : 1714716633152,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log",
  "processId" : 0,
  "processDefineCode" : 13201021801792,
  "processDefineVersion" : 120,
  "processInstanceId" : 838,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 7,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13340390094208}],\"nextNode\":13348985859488}}",
  "environmentConfig" : "export PYTHON_LAUNCHER=/bin/python3.11",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2644"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13348933988640"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503141033"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "838"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "null"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_post"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13201021801792"
    }
  },
  "taskAppId" : "838_2644",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"null\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.155 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:33.157 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2644, processInstanceId=838, startTime=1714716633152, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.158 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.158 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13348985859488 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13340390094208 ]
  } ]
}
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}] successfully
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.159 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"null"
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[110] - Format condition sentence::"null" != "null" successfully
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[114] - Execute condition sentence: "null" != "null" successfully: false
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 2 condition: null 
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[136] - The switch task depend result:SUCCESS, switch branch:1
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[75] - Switch task execute finished, condition result is: SUCCESS, task status is: SUCCESS
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.160 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.161 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.162 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:33 GMT+08:00 2024, endTime=Fri May 03 14:10:33 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.162 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: SUCCESS to master: 172.18.0.12:5678 successfully
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.163 +0800 o.a.d.s.m.r.e.SyncMasterTaskExecutor:[54] - Execute task finished, will send the task execute result to master, the current task execute result is SUCCESS
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:33.163 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.034 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.039 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.040 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:10:34.062 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=832), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-838][TI-2644] - [ERROR] 2024-05-03 14:10:34.073 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:33 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.077 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:33 GMT+08:00 2024, endTime=Fri May 03 14:10:33 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:10:34.090 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=833), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 78, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-838][TI-2644] - [WARN] 2024-05-03 14:10:34.091 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2644
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.091 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=838, taskInstanceId=2644, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.091 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2644, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:33 GMT+08:00 2024, endTime=Fri May 03 14:10:33 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2644.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:34.091 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-838] persist events succeeded
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.146 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=838, taskInstanceId=2644, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.146 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.146 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.146 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.147 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.152 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:end workflow, task id:null, task code:13348985859488
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.154 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13348985859488, dependTaskCodes: [13348933988640, 13340113777664]
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.154 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task end workflow is success, so ready to submit to execute
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.156 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : end workflow, processInstance id:838, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-2644] - [INFO] 2024-05-03 14:10:34.158 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2645, taskInstanceName: end workflow, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:838, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348933988640 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-838][TI-0] - [INFO] 2024-05-03 14:10:34.161 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_post-120-20240503134509362
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:10:33 GMT+08:00 2024
Submit Time:            Fri May 03 14:10:33 GMT+08:00 2024
Start Time:             Fri May 03 14:10:33 GMT+08:00 2024
End Time:               Fri May 03 14:10:33 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:10:34.164 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task end workflow to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:34.168 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2645, processInstanceId=838, startTime=1714716634166, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.079 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.084 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.084 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.090 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=838, taskInstanceId=2645, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.090 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.090 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.108 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=838)
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:35.108 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-838] persist events succeeded
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.180 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=838, taskInstanceId=2645, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.180 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:35.214 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.044 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.079 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.085 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=838, taskInstanceId=2645, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.086 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.086 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
[WI-838][TI-2645] - [ERROR] 2024-05-03 14:10:36.088 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2645, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:10:34 GMT+08:00 2024, endTime=Fri May 03 14:10:35 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13201021801792_120/838/2645, logPath=/opt/dolphinscheduler/logs/20240503/13201021801792/120/838/2645.log, processId=5885, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"null"}], cacheTaskInstanceId=0, processInstanceId=838)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task result event error, the task instance is already finished, will discord this event
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:86)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:36.088 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-838] persist events succeeded
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.103 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=838, taskInstanceId=2645, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.104 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.104 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13348985859488 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.104 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.104 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.121 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.121 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=7, desc='success'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.126 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13348985859488 state:TaskExecutionStatus{code=7, desc='success'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.126 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=7, desc='success'}, target state: WorkflowExecutionStatus{code=7, desc='success'}
[WI-838][TI-2645] - [INFO] 2024-05-03 14:10:36.127 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              end workflow
Workflow Instance Name: preprocess_post-120-20240503134509362
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:10:34 GMT+08:00 2024
Submit Time:            Fri May 03 14:10:34 GMT+08:00 2024
Start Time:             Fri May 03 14:10:34 GMT+08:00 2024
End Time:               Fri May 03 14:10:35 GMT+08:00 2024

[WI-838][TI-null] - [INFO] 2024-05-03 14:10:36.127 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=838, taskInstanceId=null, status=WorkflowExecutionStatus{code=7, desc='success'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-838][TI-null] - [INFO] 2024-05-03 14:10:36.127 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=7, desc='success'} will be changed to WorkflowExecutionStatus{code=7, desc='success'}
[WI-838][TI-null] - [INFO] 2024-05-03 14:10:36.128 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_post
Workflow Instance Name:    preprocess_post-120-20240503134509362
Command Type:              REPEAT_RUNNING
State:                     success
Host:                      172.18.0.12:5678
Is Sub Process:            no
Run Times:                 2
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Fri May 03 14:10:31 GMT+08:00 2024
Work Group:                default
Start Time:                Fri May 03 14:10:31 GMT+08:00 2024
End Time:                  Fri May 03 14:10:36 GMT+08:00 2024

[WI-838][TI-0] - [INFO] 2024-05-03 14:10:36.128 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:36.489 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:37.523 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8232044198895029 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:37.533 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8232044198895029 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:37.533 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:38.360 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714694959733, reportTime=1714716637501, cpuUsage=0.8176795580110497, jvmMemoryUsage=0.038089656829833986, memoryUsage=0.6098123872605629, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:38.364 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:38.556 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:39.558 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:40.560 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:41.523 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:41.562 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8343195266272189 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:41.562 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:41.599 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8343195266272189 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:42.564 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.839779005524862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:42.564 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:42.623 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.839779005524862 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:43.564 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:44.565 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:45.566 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:46.565 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:46.567 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:10:47.570 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:48.388 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:51.593 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:10:56.638 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 8/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:01.670 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:06.708 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 4/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:11.741 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:16.764 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:21.782 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:26.793 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:31.810 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:36.851 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:41.902 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:46.915 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:51.925 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:56.945 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:57.891 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8123249299719888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:11:57.891 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:11:57.905 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.8123249299719888 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:11:58.473 +0800 o.a.d.s.m.d.h.LowerWeightHostManager:[139] - Worker 172.18.1.1:1234 in workerGroup default is Busy, heartbeat is WorkerHeartBeat(startupTime=1714694959733, reportTime=1714716717909, cpuUsage=0.8107344632768362, jvmMemoryUsage=0.038089656829833986, memoryUsage=0.6147588052085222, diskUsage=0.0, serverStatus=BUSY, processId=7, host=172.18.1.1, port=1234, workerHostWeight=100, threadPoolUsage=0)
[WI-0][TI-0] - [WARN] 2024-05-03 14:11:58.477 +0800 o.a.d.s.m.r.MasterSlotManager:[90] - Current master is not in active master list
[WI-0][TI-0] - [WARN] 2024-05-03 14:11:58.896 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:11:59.897 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:00.899 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:01.908 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:01.961 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 0/ms
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:02.917 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:03.919 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:04.921 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:05.923 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:06.925 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:06.988 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:07.926 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[179] - Master count: 0 is invalid, the current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:08.484 +0800 o.a.d.s.m.r.MasterSlotManager:[94] - Update master nodes, total master size: 1, current slot: 0
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:12.019 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:17.036 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:22.080 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 9/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:27.146 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:31.024 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7464788732394366 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:31.024 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:31.126 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7464788732394366 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:32.167 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:37.219 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.054 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[187] - Master schedule bootstrap loop command success, fetch command size: 1, cost: 2ms, current slot: 0, total slot size: 1
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.101 +0800 o.a.d.s.m.r.WorkflowEventLooper:[91] - Begin to handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=842)
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.102 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[52] - Handle workflow start event, begin to start a workflow, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=842)
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.102 +0800 o.a.d.s.m.r.WorkflowEventLooper:[95] - Success handle WorkflowEvent: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.102 +0800 o.a.d.s.m.e.WorkflowEventQueue:[37] - Added workflow event to workflowEvent queue, event: WorkflowEvent(workflowEventType=START_WORKFLOW, workflowInstanceId=842)
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.102 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[853] - The current workflowInstance is a newly running workflowInstance
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.103 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[895] - Initialize task queue, dependFailedTaskSet: [], completeTaskSet: [], errorTaskMap: {}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.103 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[687] - workflowStatue changed to :INITIALIZE_QUEUE
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:search for intake article JSON files, task id:null, task code:13475238524226
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.107 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task search for intake article JSON files is success, so ready to submit to execute
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.111 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : search for intake article JSON files, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.114 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2646, taskInstanceName: search for intake article JSON files, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.118 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.119 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.120 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:40.120 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[693] - workflowStatue changed to :STARTED
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.120 +0800 o.a.d.s.m.e.WorkflowStartEventHandler:[66] - Success submit the workflow instance
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.139 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task search for intake article JSON files to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.155 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2646, processInstanceId=842, startTime=1714716760149, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.346 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.351 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.352 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.357 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2646, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.357 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.357 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.361 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:40.361 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.393 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2646, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:40.393 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.201 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2646, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, processId=5917, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.348 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2646, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, processId=5917, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.356 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2646, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.356 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2646, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=7, desc='success'}, startTime=Fri May 03 14:12:40 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2646, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2646.log, processId=5917, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:41.356 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.404 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2646, taskCode=0, status=TaskExecutionStatus{code=7, desc='success'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.404 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state SUCCESS will be changed to SUCCESS
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.404 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.404 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.404 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.422 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2646] - [INFO] 2024-05-03 14:12:41.425 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2647, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.430 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.430 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.430 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2647, taskName=check file existence, firstSubmitTime=1714716761423, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=21, appIds=null, processInstanceId=842, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2647'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503141241'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='842'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.430 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524226 state:TaskExecutionStatus{code=7, desc='success'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.449 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:41.431 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              search for intake article JSON files
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          success
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:40 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:40 GMT+08:00 2024
Start Time:             Fri May 03 14:12:40 GMT+08:00 2024
End Time:               Fri May 03 14:12:41 GMT+08:00 2024

[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.451 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716761451
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.451 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 842_2647
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:41.448 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.452 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2647,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716761423,
  "startTime" : 1714716761451,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 21,
  "processInstanceId" : 842,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2647"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503141241"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "842"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "842_2647",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.452 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:41.453 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2647, processInstanceId=842, startTime=1714716761451, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.454 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-842][TI-2647] - [ERROR] 2024-05-03 14:12:41.455 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.455 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2647] - [ERROR] 2024-05-03 14:12:41.455 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2647] - [WARN] 2024-05-03 14:12:41.455 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.456 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:41 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.465 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.466 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.466 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:41.466 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.116 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7358278295778296 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:42.116 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.174 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7358278295778296 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.231 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 1/ms
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.349 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.360 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.383 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:42.413 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=846), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2647] - [ERROR] 2024-05-03 14:12:42.453 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:41 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.453 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:41 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:42.461 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=847), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 78, 121, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2647] - [WARN] 2024-05-03 14:12:42.471 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2647
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.471 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2647, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.471 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2647, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:41 GMT+08:00 2024, endTime=Fri May 03 14:12:41 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2647.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.471 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.541 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2647, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.545 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.546 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.546 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.546 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.546 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.546 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.547 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.548 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.550 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2647] - [INFO] 2024-05-03 14:12:42.552 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2648, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.561 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:42.562 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:42.562 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:42.562 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:42.562 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:41 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:41 GMT+08:00 2024
Start Time:             Fri May 03 14:12:41 GMT+08:00 2024
End Time:               Fri May 03 14:12:41 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.563 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2648, taskName=check file existence, firstSubmitTime=1714716762550, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=21, appIds=null, processInstanceId=842, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2648'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503141242'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='842'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.563 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.564 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716762569
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 842_2648
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.568 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2648,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716762550,
  "startTime" : 1714716762569,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 21,
  "processInstanceId" : 842,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2648"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503141242"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "842"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "842_2648",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.569 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.570 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:42.587 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2648, processInstanceId=842, startTime=1714716762569, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.592 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.594 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.595 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-842][TI-2648] - [ERROR] 2024-05-03 14:12:42.595 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.595 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.595 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.595 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2648] - [ERROR] 2024-05-03 14:12:42.595 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2648] - [WARN] 2024-05-03 14:12:42.595 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.600 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:42 GMT+08:00 2024, endTime=Fri May 03 14:12:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.605 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.606 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.606 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:42.606 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.360 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.371 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.372 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:43.375 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=851), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2648] - [ERROR] 2024-05-03 14:12:43.376 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:42 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.377 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:42 GMT+08:00 2024, endTime=Fri May 03 14:12:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:43.381 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=852), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 79, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2648] - [WARN] 2024-05-03 14:12:43.382 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2648
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.382 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2648, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2648, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:42 GMT+08:00 2024, endTime=Fri May 03 14:12:42 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2648.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:43.382 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2648, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.460 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.462 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2648] - [INFO] 2024-05-03 14:12:43.464 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2649, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.492 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:43.492 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:43.492 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:43.492 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:43.492 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:42 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:42 GMT+08:00 2024
Start Time:             Fri May 03 14:12:42 GMT+08:00 2024
End Time:               Fri May 03 14:12:42 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:43.493 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2649, taskName=check file existence, firstSubmitTime=1714716763462, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=21, appIds=null, processInstanceId=842, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2649'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503141243'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='842'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.494 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.495 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.511 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:43.498 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.514 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.514 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.514 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716763514
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.514 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 842_2649
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.514 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2649,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716763462,
  "startTime" : 1714716763514,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 21,
  "processInstanceId" : 842,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2649"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503141243"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "842"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "842_2649",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.515 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.515 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.515 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:43.522 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2649, processInstanceId=842, startTime=1714716763514, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.525 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.525 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-842][TI-2649] - [ERROR] 2024-05-03 14:12:43.526 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.526 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2649] - [ERROR] 2024-05-03 14:12:43.526 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2649] - [WARN] 2024-05-03 14:12:43.526 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.527 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:43 GMT+08:00 2024, endTime=Fri May 03 14:12:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:43.529 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.360 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.364 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:44.367 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=856), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2649] - [ERROR] 2024-05-03 14:12:44.368 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:43 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.368 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:43 GMT+08:00 2024, endTime=Fri May 03 14:12:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:44.372 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=857), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 48, 79, 83, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2649] - [WARN] 2024-05-03 14:12:44.373 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2649
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.373 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2649, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.373 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2649, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:43 GMT+08:00 2024, endTime=Fri May 03 14:12:43 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2649.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:44.373 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.468 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2649, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:check file existence, task id:null, task code:13476553659200
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13476553659200, dependTaskCodes: [13475238524226]
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.469 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task check file existence is success, so ready to submit to execute
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.471 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : check file existence, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2649] - [INFO] 2024-05-03 14:12:44.473 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2650, taskInstanceName: check file existence, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.488 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:44.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:44.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:44.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:44.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:43 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:43 GMT+08:00 2024
Start Time:             Fri May 03 14:12:43 GMT+08:00 2024
End Time:               Fri May 03 14:12:43 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:44.490 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[48] - Received dispatchLogicTask request: LogicTaskDispatchRequest(taskExecutionContext=TaskExecutionContext(taskInstanceId=2650, taskName=check file existence, firstSubmitTime=1714716764472, startTime=0, taskType=SWITCH, workflowInstanceHost=172.18.0.12:5678, host=172.18.0.12:5678, executePath=null, logPath=null, appInfoPath=null, taskJson=null, processId=0, processDefineCode=13475238524230, processDefineVersion=21, appIds=null, processInstanceId=842, scheduleTime=0, globalParams=[{"prop":"folder","direct":"IN","type":"VARCHAR","value":"in"}], executorId=1, cmdTypeIfComplement=0, tenantCode=default, processDefineId=0, projectId=0, projectCode=13010050770016, taskParams={"localParams":[],"rawScript":"","resourceList":[],"switchResult":{"dependTaskList":[{"condition":"${raw_file_dir} != 'null'","nextNode":13475238524227}],"nextNode":13475238524224}}, environmentConfig=null, definedParams=null, prepareParamsMap={GNEWS_HOME=Property{prop='GNEWS_HOME', direct=IN, type=VARCHAR, value='/local_storage/gnews'}, system.task.definition.name=Property{prop='system.task.definition.name', direct=IN, type=VARCHAR, value='check file existence'}, system.project.name=Property{prop='system.project.name', direct=IN, type=VARCHAR, value='null'}, REDDIT_HOME=Property{prop='REDDIT_HOME', direct=IN, type=VARCHAR, value='/local_storage/reddit'}, system.biz.curdate=Property{prop='system.biz.curdate', direct=IN, type=VARCHAR, value='20240503'}, system.task.instance.id=Property{prop='system.task.instance.id', direct=IN, type=VARCHAR, value='2650'}, system.task.definition.code=Property{prop='system.task.definition.code', direct=IN, type=VARCHAR, value='13476553659200'}, system.datetime=Property{prop='system.datetime', direct=IN, type=VARCHAR, value='20240503141244'}, folder=Property{prop='folder', direct=IN, type=VARCHAR, value='in'}, system.project.code=Property{prop='system.project.code', direct=IN, type=VARCHAR, value='13010050770016'}, system.workflow.instance.id=Property{prop='system.workflow.instance.id', direct=IN, type=VARCHAR, value='842'}, raw_file_dir=Property{prop='raw_file_dir', direct=IN, type=VARCHAR, value='/local_storage/gnews/in/830-20240503110322.json'}, system.biz.date=Property{prop='system.biz.date', direct=IN, type=VARCHAR, value='20240502'}, system.workflow.definition.name=Property{prop='system.workflow.definition.name', direct=IN, type=VARCHAR, value='preprocess_gnews_article'}, system.workflow.definition.code=Property{prop='system.workflow.definition.code', direct=IN, type=VARCHAR, value='13475238524230'}}, taskAppId=null, taskTimeoutStrategy=null, taskTimeout=2147483647, workerGroup=default, delayTime=0, currentExecutionStatus=TaskExecutionStatus{code=0, desc='submit success'}, resourceParametersHelper=null, endTime=0, sqlTaskExecutionContext=null, k8sTaskExecutionContext=null, resourceContext=null, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], dryRun=0, paramsMap={}, dataQualityTaskExecutionContext=null, cpuQuota=-1, memoryMax=-1, testFlag=0, logBufferEnable=false, dispatchFailTimes=0))
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.490 +0800 o.a.d.s.m.r.LogicITaskInstanceDispatchOperationFunction:[66] - Submit LogicTask: check file existence to MasterTaskExecutorThreadPool success
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.491 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.500 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Initialize task context  ***********************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.502 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.502 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[123] - Begin to initialize task
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.503 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[127] - Set task startTime: 1714716764503
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.503 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[132] - Set task appId: 842_2650
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.503 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[134] - End initialize task {
  "taskInstanceId" : 2650,
  "taskName" : "check file existence",
  "firstSubmitTime" : 1714716764472,
  "startTime" : 1714716764503,
  "taskType" : "SWITCH",
  "workflowInstanceHost" : "172.18.0.12:5678",
  "host" : "172.18.0.12:5678",
  "logPath" : "/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log",
  "processId" : 0,
  "processDefineCode" : 13475238524230,
  "processDefineVersion" : 21,
  "processInstanceId" : 842,
  "scheduleTime" : 0,
  "globalParams" : "[{\"prop\":\"folder\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"in\"}]",
  "executorId" : 1,
  "cmdTypeIfComplement" : 0,
  "tenantCode" : "default",
  "processDefineId" : 0,
  "projectId" : 0,
  "projectCode" : 13010050770016,
  "taskParams" : "{\"localParams\":[],\"rawScript\":\"\",\"resourceList\":[],\"switchResult\":{\"dependTaskList\":[{\"condition\":\"${raw_file_dir} != 'null'\",\"nextNode\":13475238524227}],\"nextNode\":13475238524224}}",
  "prepareParamsMap" : {
    "GNEWS_HOME" : {
      "prop" : "GNEWS_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews"
    },
    "system.task.definition.name" : {
      "prop" : "system.task.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "check file existence"
    },
    "system.project.name" : {
      "prop" : "system.project.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : null
    },
    "REDDIT_HOME" : {
      "prop" : "REDDIT_HOME",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/reddit"
    },
    "system.biz.curdate" : {
      "prop" : "system.biz.curdate",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503"
    },
    "system.task.instance.id" : {
      "prop" : "system.task.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "2650"
    },
    "system.task.definition.code" : {
      "prop" : "system.task.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13476553659200"
    },
    "system.datetime" : {
      "prop" : "system.datetime",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240503141244"
    },
    "folder" : {
      "prop" : "folder",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "in"
    },
    "system.project.code" : {
      "prop" : "system.project.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13010050770016"
    },
    "system.workflow.instance.id" : {
      "prop" : "system.workflow.instance.id",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "842"
    },
    "raw_file_dir" : {
      "prop" : "raw_file_dir",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "/local_storage/gnews/in/830-20240503110322.json"
    },
    "system.biz.date" : {
      "prop" : "system.biz.date",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "20240502"
    },
    "system.workflow.definition.name" : {
      "prop" : "system.workflow.definition.name",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "preprocess_gnews_article"
    },
    "system.workflow.definition.code" : {
      "prop" : "system.workflow.definition.code",
      "direct" : "IN",
      "type" : "VARCHAR",
      "value" : "13475238524230"
    }
  },
  "taskAppId" : "842_2650",
  "taskTimeout" : 2147483647,
  "workerGroup" : "default",
  "delayTime" : 0,
  "currentExecutionStatus" : "SUBMITTED_SUCCESS",
  "endTime" : 0,
  "varPool" : "[{\"prop\":\"raw_file_dir\",\"direct\":\"IN\",\"type\":\"VARCHAR\",\"value\":\"/local_storage/gnews/in/830-20240503110322.json\"}]",
  "dryRun" : 0,
  "paramsMap" : { },
  "cpuQuota" : -1,
  "memoryMax" : -1,
  "testFlag" : 0,
  "logBufferEnable" : false,
  "dispatchFailTimes" : 0
}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.509 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:44.494 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task check file existence to 172.18.0.12:5678.
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.515 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Load task instance plugin  *********************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.516 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:44.517 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2650, processInstanceId=842, startTime=1714716764503, taskInstanceHost=172.18.0.12:5678, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.519 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[141] - Send task status RUNNING_EXECUTION to master 172.18.0.12:5678
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.520 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[36] - Success initialize task parameters: 
{
  "localParams" : null,
  "varPool" : null,
  "dependRelation" : null,
  "relation" : null,
  "nextNode" : [ 13475238524224 ],
  "resultConditionLocation" : 0,
  "dependTaskList" : [ {
    "condition" : "${raw_file_dir} != 'null'",
    "nextNode" : [ 13475238524227 ]
  } ]
}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.520 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[146] - Initialized task plugin instance: SWITCH successfully
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.521 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[149] - Initialize taskVarPool: [{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}] successfully
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.521 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.521 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Execute task instance  *************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.521 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.522 +0800 o.a.d.s.m.r.t.s.SwitchLogicTask:[103] - Begin to execute 1 condition: ${raw_file_dir} != 'null' 
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.522 +0800 o.a.d.s.m.u.SwitchTaskUtils:[93] - paramName:raw_file_dirï¼ŒparamValue:"/local_storage/gnews/in/830-20240503110322.json"
[WI-842][TI-2650] - [ERROR] 2024-05-03 14:12:44.524 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[114] - Task execute failed, due to meet an exception
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.524 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - *********************************  Finalize task instance  ************************************
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.525 +0800 o.a.d.p.t.a.l.TaskInstanceLogHeader:[1259] - ***********************************************************************************************
[WI-842][TI-2650] - [ERROR] 2024-05-03 14:12:44.525 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[60] - Get a exception when execute the task, will try to cancel the task
java.lang.IllegalArgumentException: condition is not valid, please check it. condition: ${raw_file_dir} != 'null'
	at org.apache.dolphinscheduler.server.master.utils.SwitchTaskUtils.generateContentWithTaskParams(SwitchTaskUtils.java:99)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.calculateConditionResult(SwitchLogicTask.java:109)
	at org.apache.dolphinscheduler.server.master.runner.task.switchtask.SwitchLogicTask.handle(SwitchLogicTask.java:72)
	at org.apache.dolphinscheduler.server.master.runner.execute.SyncMasterTaskExecutor.executeTask(SyncMasterTaskExecutor.java:44)
	at org.apache.dolphinscheduler.server.master.runner.execute.MasterTaskExecutor.run(MasterTaskExecutor.java:110)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2650] - [WARN] 2024-05-03 14:12:44.528 +0800 o.a.d.s.m.r.t.BaseSyncLogicTask:[46] - The Sync task does not support kill operation
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.529 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:44 GMT+08:00 2024, endTime=Fri May 03 14:12:44 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.531 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[172] - Send task status: FAILURE to master: 172.18.0.12:5678 successfully
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.532 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[67] - Get a exception when execute the task, sent the task execute result to master, the current task execute result is TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.533 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[72] - Get a exception when execute the task, removed the TaskExecutionContext
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:44.533 +0800 o.a.d.s.m.r.e.MasterTaskExecutor:[162] - FINALIZE_SESSION
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:45.131 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7690140845070421 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:45.131 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:45.196 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7690140845070421 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.360 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.370 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.370 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:45.373 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck), opaque=861), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 49, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 82, 117, 110, 110, 105, 110, 103, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2650] - [ERROR] 2024-05-03 14:12:45.374 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[64] - Handle task event error, this event will be removed, event: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:44 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
org.apache.dolphinscheduler.server.master.event.TaskEventHandleError: Handle task running event error, update taskInstance to db failed
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:98)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
Caused by: org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionRunningEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionRunningEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionRunningEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.sendAckToWorker(TaskRunningEventHandler.java:115)
	at org.apache.dolphinscheduler.server.master.event.TaskRunningEventHandler.handleTaskEvent(TaskRunningEventHandler.java:92)
	... 6 common frames omitted
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.374 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:44 GMT+08:00 2024, endTime=Fri May 03 14:12:44 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:12:45.377 +0800 o.a.d.e.b.s.JdkDynamicServerHandler:[84] - Cannot find the ServerMethodInvoker of : Transporter(header=TransporterHeader(methodIdentifier=public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck), opaque=862), body=[123, 34, 97, 114, 103, 115, 34, 58, 91, 34, 101, 121, 74, 48, 89, 88, 78, 114, 83, 87, 53, 122, 100, 71, 70, 117, 89, 50, 86, 74, 90, 67, 73, 54, 77, 106, 89, 49, 77, 67, 119, 105, 99, 51, 86, 106, 89, 50, 86, 122, 99, 121, 73, 54, 100, 72, 74, 49, 90, 88, 48, 61, 34, 93, 44, 34, 97, 114, 103, 115, 84, 121, 112, 101, 115, 34, 58, 91, 34, 111, 114, 103, 46, 97, 112, 97, 99, 104, 101, 46, 100, 111, 108, 112, 104, 105, 110, 115, 99, 104, 101, 100, 117, 108, 101, 114, 46, 101, 120, 116, 114, 97, 99, 116, 46, 119, 111, 114, 107, 101, 114, 46, 116, 114, 97, 110, 115, 112, 111, 114, 116, 111, 114, 46, 84, 97, 115, 107, 73, 110, 115, 116, 97, 110, 99, 101, 69, 120, 101, 99, 117, 116, 105, 111, 110, 70, 105, 110, 105, 115, 104, 69, 118, 101, 110, 116, 65, 99, 107, 34, 93, 125])
[WI-842][TI-2650] - [WARN] 2024-05-03 14:12:45.378 +0800 o.a.d.s.m.e.TaskResultEventHandler:[131] - send ack to worker error, taskInstanceId: 2650
org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException: Cannot find the ServerMethodInvoker of public abstract void org.apache.dolphinscheduler.extract.worker.ITaskInstanceExecutionEventAckListener.handleTaskInstanceExecutionFinishEventAck(org.apache.dolphinscheduler.extract.worker.transportor.TaskInstanceExecutionFinishEventAck)
	at org.apache.dolphinscheduler.extract.base.exception.MethodInvocationException.of(MethodInvocationException.java:27)
	at org.apache.dolphinscheduler.extract.base.client.SyncClientMethodInvoker.invoke(SyncClientMethodInvoker.java:48)
	at org.apache.dolphinscheduler.extract.base.client.ClientInvocationHandler.invoke(ClientInvocationHandler.java:55)
	at com.sun.proxy.$Proxy229.handleTaskInstanceExecutionFinishEventAck(Unknown Source)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.sendAckToWorker(TaskResultEventHandler.java:127)
	at org.apache.dolphinscheduler.server.master.event.TaskResultEventHandler.handleTaskEvent(TaskResultEventHandler.java:110)
	at org.apache.dolphinscheduler.server.master.processor.queue.TaskExecuteRunnable.run(TaskExecuteRunnable.java:56)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:750)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.378 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2650, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.378 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2650, workerAddress=172.18.0.12:5678, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:44 GMT+08:00 2024, endTime=Fri May 03 14:12:44 GMT+08:00 2024, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2650.log, processId=0, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"IN","type":"VARCHAR","value":"/local_storage/gnews/in/830-20240503110322.json"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:45.379 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.482 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2650, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.482 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.483 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.483 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.483 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.487 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.489 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.491 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2650] - [INFO] 2024-05-03 14:12:45.493 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2651, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:45.498 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.498 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.498 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.498 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13476553659200 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.499 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.499 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:45.499 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              check file existence
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.0.12:5678
Task Type:              SWITCH
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:44 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:44 GMT+08:00 2024
Start Time:             Fri May 03 14:12:44 GMT+08:00 2024
End Time:               Fri May 03 14:12:44 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:45.503 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2651, processInstanceId=842, startTime=1714716765502, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:45.504 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:46.132 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.706043956043956 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:46.132 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:46.207 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.706043956043956 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.362 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2651, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [WARN] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.382 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.388 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:46.389 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.394 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2651, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.395 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:46.554 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=Fri May 03 14:12:46 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2651, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, processId=5930, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:47.245 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 2/ms
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.374 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=Fri May 03 14:12:46 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2651, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, processId=5930, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.381 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2651, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.381 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2651, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:45 GMT+08:00 2024, endTime=Fri May 03 14:12:46 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2651, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2651.log, processId=5930, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:47.381 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.405 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2651, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.406 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.406 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.406 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.406 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.408 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.410 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2651] - [INFO] 2024-05-03 14:12:47.411 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2652, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:47.419 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:47.419 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:47.420 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:47.420 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:47.424 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:45 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:45 GMT+08:00 2024
Start Time:             Fri May 03 14:12:45 GMT+08:00 2024
End Time:               Fri May 03 14:12:46 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:47.425 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2652, processInstanceId=842, startTime=1714716767422, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:47.427 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.386 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.428 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2652, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.429 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.429 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [WARN] 2024-05-03 14:12:48.429 +0800 o.a.d.s.m.e.TaskDispatchEventHandler:[57] - The current taskInstance status is not SUBMITTED_SUCCESS, so the dispatch event will be discarded, the current is a delay event, event: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.430 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.430 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.434 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:48.434 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.447 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=Fri May 03 14:12:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2652, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, processId=5942, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.528 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2652, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:48.529 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:49.136 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7909604519774011 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:49.137 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:49.240 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7909604519774011 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.387 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=Fri May 03 14:12:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2652, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, processId=5942, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.393 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2652, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.393 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2652, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:47 GMT+08:00 2024, endTime=Fri May 03 14:12:48 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2652, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2652.log, processId=5942, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:49.393 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.457 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2652, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.457 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.458 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.458 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.458 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.458 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.459 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.460 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2652] - [INFO] 2024-05-03 14:12:49.462 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2653, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:49.479 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:49.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:49.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:49.479 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:49.480 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:47 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:47 GMT+08:00 2024
Start Time:             Fri May 03 14:12:47 GMT+08:00 2024
End Time:               Fri May 03 14:12:48 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:49.484 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:49.488 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2653, processInstanceId=842, startTime=1714716769483, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.388 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.392 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.393 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.402 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2653, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.402 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.403 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.428 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:50.430 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.473 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2653, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.476 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:50.540 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=Fri May 03 14:12:50 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2653, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, processId=5953, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.397 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=Fri May 03 14:12:50 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2653, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, processId=5953, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.416 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2653, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.416 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2653, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:49 GMT+08:00 2024, endTime=Fri May 03 14:12:50 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2653, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2653.log, processId=5953, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:51.416 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.503 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2653, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.504 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.504 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.504 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.504 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.504 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[393] - Retry taskInstance taskInstance state: TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.505 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:move to processing, task id:null, task code:13475238524227
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.506 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1460] - The dependTasks of task all success, currentTaskCode: 13475238524227, dependTaskCodes: [13476553659200, 13475238524226]
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.506 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1920] - The dependResult of task move to processing is success, so ready to submit to execute
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.509 +0800 o.a.d.s.p.ProcessServiceImpl:[1076] - Start save taskInstance to database : move to processing, processInstance id:842, state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2653] - [INFO] 2024-05-03 14:12:51.512 +0800 o.a.d.s.p.ProcessServiceImpl:[1093] - End save taskInstance to db successfully:2654, taskInstanceName: move to processing, taskInstance state:TaskExecutionStatus{code=0, desc='submit success'}, processInstanceId:842, processInstanceState: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:51.520 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[167] - Adding task instance into timeout check list
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:51.520 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:51.520 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1657] - The workflowInstance has task running, the workflowInstance status is WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:51.520 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=1, desc='running'}
[WI-842][TI-0] - [INFO] 2024-05-03 14:12:51.520 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:49 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:49 GMT+08:00 2024
Start Time:             Fri May 03 14:12:49 GMT+08:00 2024
End Time:               Fri May 03 14:12:50 GMT+08:00 2024

[WI-0][TI-0] - [INFO] 2024-05-03 14:12:51.525 +0800 o.a.d.s.m.r.BaseTaskDispatcher:[66] - Success dispatch task move to processing to 172.18.1.1:1234.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:51.537 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionRunningEventListenFunction:[40] - Receive handleTaskInstanceExecutionEvent request: TaskInstanceExecutionRunningEvent(taskInstanceId=2654, processInstanceId=842, startTime=1714716771524, taskInstanceHost=172.18.1.1:1234, workflowInstanceHost=172.18.0.12:5678, status=TaskExecutionStatus{code=1, desc='running'}, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, executePath=null, processId=0, appIds=null, eventCreateTime=0, eventSendTime=0)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:52.151 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7861271676300579 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:12:52.151 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:52.259 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:52.263 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.7861271676300579 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.408 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.420 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=null, startTime=null, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=DISPATCH, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.421 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.427 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2654, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.427 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=1, desc='running'}, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, processId=0, appIds=null, event=RUNNING, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.427 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.431 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=null, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=null, executePath=null, logPath=null, processId=0, appIds=null, event=UPDATE_PID, varPool=null, cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:52.431 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.536 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2654, taskCode=0, status=TaskExecutionStatus{code=1, desc='running'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.544 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state RUNNING_EXECUTION will be changed to RUNNING_EXECUTION
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:52.619 +0800 o.a.d.s.m.r.l.TaskInstanceExecutionResultEventListenFunction:[45] - Received TaskInstanceExecutionFinishEvent: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=Fri May 03 14:12:52 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2654, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, processId=5964, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.422 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[55] - Handle task event begin: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=Fri May 03 14:12:52 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2654, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, processId=5964, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.429 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[78] - Submit state event success, stateEvent: TaskStateEvent(processInstanceId=842, taskInstanceId=2654, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.430 +0800 o.a.d.s.m.p.q.TaskExecuteRunnable:[58] - Handle task event finished: TaskEvent(taskInstanceId=2654, workerAddress=172.18.1.1:1234, state=TaskExecutionStatus{code=6, desc='failure'}, startTime=Fri May 03 14:12:51 GMT+08:00 2024, endTime=Fri May 03 14:12:52 GMT+08:00 2024, executePath=/tmp/dolphinscheduler/exec/process/default/13010050770016/13475238524230_21/842/2654, logPath=/opt/dolphinscheduler/logs/20240503/13475238524230/21/842/2654.log, processId=5964, appIds=null, event=RESULT, varPool=[{"prop":"raw_file_dir","direct":"OUT","type":"VARCHAR","value":"${GNEW_HOME}/processing/${filename}"}], cacheTaskInstanceId=0, processInstanceId=842)
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:53.430 +0800 o.a.d.s.m.p.q.TaskExecuteThreadPool:[126] - [WorkflowInstance-842] persist events succeeded
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.443 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, TaskStateEvent(processInstanceId=842, taskInstanceId=2654, taskCode=0, status=TaskExecutionStatus{code=6, desc='failure'}, type=TASK_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.443 +0800 o.a.d.s.m.e.TaskStateEventHandler:[53] - Handle task instance state event, the current task instance state FAILURE will be changed to FAILURE
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.443 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[364] - TaskInstance finished task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.445 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[186] - remove task instance from timeout check list
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.445 +0800 o.a.d.s.m.r.StateWheelExecuteThread:[209] - remove task instance from retry check list
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1810] - Add task to stand by list, task name:preprocessing and kafka, task id:null, task code:13475238524229
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1948] - Task dependent result is failed, taskInstanceName: preprocessing and kafka depend result : FAILED
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1739] - Update workflowInstance states, origin state: WorkflowExecutionStatus{code=1, desc='running'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.448 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1770] - Begin to update workflow instance state , state will change from WorkflowExecutionStatus{code=1, desc='running'} to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[415] - TaskInstance finished will try to update the workflow instance state, task code:13475238524227 state:TaskExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1587] - The current process has failed task, the current process failed
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1693] - The workflowInstance is failed, the workflow status is WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.452 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[1752] - There is no need to update the workflow instance state, origin state: WorkflowExecutionStatus{code=6, desc='failure'}, target state: WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-2654] - [INFO] 2024-05-03 14:12:53.453 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[420] - 
********************************************************************************
                    Task Instance Detail
********************************************************************************
Task Name:              move to processing
Workflow Instance Name: preprocess_gnews_article-21-20240503141240058
Task Execute Type:      batch
Execute State:          failure
Host:                   172.18.1.1:1234
Task Type:              SHELL
Priority:               medium
Tenant:                 default
First Submit Time:      Fri May 03 14:12:51 GMT+08:00 2024
Submit Time:            Fri May 03 14:12:51 GMT+08:00 2024
Start Time:             Fri May 03 14:12:51 GMT+08:00 2024
End Time:               Fri May 03 14:12:52 GMT+08:00 2024

[WI-842][TI-null] - [INFO] 2024-05-03 14:12:53.453 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[287] - Begin to handle state event, WorkflowStateEvent(processInstanceId=842, taskInstanceId=null, status=WorkflowExecutionStatus{code=6, desc='failure'}, type=PROCESS_STATE_CHANGE, key=null, channel=null, context=null)
[WI-842][TI-null] - [INFO] 2024-05-03 14:12:53.453 +0800 o.a.d.s.m.e.WorkflowStateEventHandler:[43] - Handle workflow instance state event, the current workflow instance state WorkflowExecutionStatus{code=6, desc='failure'} will be changed to WorkflowExecutionStatus{code=6, desc='failure'}
[WI-842][TI-null] - [INFO] 2024-05-03 14:12:53.454 +0800 o.a.d.s.m.r.WorkflowExecuteRunnable:[729] - 
********************************************************************************
                    Workflow Instance Detail
********************************************************************************
Workflow Name:             preprocess_gnews_article
Workflow Instance Name:    preprocess_gnews_article-21-20240503141240058
Command Type:              START_PROCESS
State:                     failure
Host:                      172.18.0.12:5678
Is Sub Process:            no
Run Times:                 1
Max Try Times:             0
Schedule Time:             null
Dry Run:                   0
Tenant:                    default
Restart Time:              Fri May 03 14:12:40 GMT+08:00 2024
Work Group:                default
Start Time:                Fri May 03 14:12:40 GMT+08:00 2024
End Time:                  Fri May 03 14:12:53 GMT+08:00 2024

[WI-842][TI-0] - [INFO] 2024-05-03 14:12:53.455 +0800 o.a.d.s.m.r.WorkflowExecuteThreadPool:[121] - Workflow instance is finished.
[WI-0][TI-0] - [INFO] 2024-05-03 14:12:57.290 +0800 o.a.d.s.m.r.t.TaskGroupCoordinator:[127] - TaskGroupCoordinator round time cost: 3/ms
[WI-0][TI-0] - [INFO] 2024-05-03 14:13:00.340 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [INFO] 2024-05-03 14:13:00.468 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 1.0 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:00.468 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:00.800 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001af460001 for server dolphinscheduler-zookeeper/172.18.0.4:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.io.IOException: Connection reset by peer
	at sun.nio.ch.FileDispatcherImpl.read0(Native Method)
	at sun.nio.ch.SocketDispatcher.read(SocketDispatcher.java:39)
	at sun.nio.ch.IOUtil.readIntoNativeBuffer(IOUtil.java:223)
	at sun.nio.ch.IOUtil.read(IOUtil.java:192)
	at sun.nio.ch.SocketChannelImpl.read(SocketChannelImpl.java:379)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doIO(ClientCnxnSocketNIO.java:74)
	at org.apache.zookeeper.ClientCnxnSocketNIO.doTransport(ClientCnxnSocketNIO.java:350)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1282)
[WI-0][TI-0] - [INFO] 2024-05-03 14:13:00.909 +0800 o.a.c.f.s.ConnectionStateManager:[252] - State change: SUSPENDED
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:00.915 +0800 o.a.d.p.r.z.ZookeeperConnectionStateListener:[50] - Registry suspended
[WI-0][TI-0] - [INFO] 2024-05-03 14:13:00.929 +0800 o.a.d.s.m.r.MasterConnectionStateListener:[38] - Master received a SUSPENDED event from registry, the current server state is RUNNING
[WI-0][TI-0] - [INFO] 2024-05-03 14:13:01.469 +0800 o.a.d.s.m.c.MasterServerLoadProtection:[48] - Master OverLoad: the TotalCpuUsedPercentage: 0.863080684596577 is over then the MaxCpuUsagePercentageThresholds 0.7
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:01.469 +0800 o.a.d.s.m.r.MasterSchedulerBootstrap:[123] - The current server is overload, cannot consumes commands.
[WI-0][TI-0] - [ERROR] 2024-05-03 14:13:01.907 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper: Temporary failure in name resolution
	at java.net.Inet4AddressImpl.lookupAllHostAddr(Native Method)
	at java.net.InetAddress$2.lookupAllHostAddr(InetAddress.java:867)
	at java.net.InetAddress.getAddressesFromNameService(InetAddress.java:1302)
	at java.net.InetAddress$NameServiceAddresses.get(InetAddress.java:815)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:02.796 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001af460001 for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:13:03.929 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:04.865 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001af460001 for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [ERROR] 2024-05-03 14:13:05.969 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:06.082 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001af460001 for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:06.183 +0800 o.a.c.r.ExponentialBackoffRetry:[74] - Sleep extension too large (840). Pinning to 300
[WI-0][TI-0] - [ERROR] 2024-05-03 14:13:07.183 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:07.408 +0800 o.a.z.ClientCnxn:[1292] - Session 0x1000001af460001 for server dolphinscheduler-zookeeper:2181, Closing socket connection. Attempting reconnect except it is a SessionExpiredException.
java.lang.IllegalArgumentException: Unable to canonicalize address dolphinscheduler-zookeeper:2181 because it's not resolvable
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:78)
	at org.apache.zookeeper.SaslServerPrincipal.getServerPrincipal(SaslServerPrincipal.java:41)
	at org.apache.zookeeper.ClientCnxn$SendThread.startConnect(ClientCnxn.java:1151)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1200)
[WI-0][TI-0] - [WARN] 2024-05-03 14:13:07.510 +0800 o.a.c.r.ExponentialBackoffRetry:[74] - Sleep extension too large (1440). Pinning to 300
[WI-0][TI-0] - [ERROR] 2024-05-03 14:13:08.515 +0800 o.a.z.c.StaticHostProvider:[148] - Unable to resolve address: dolphinscheduler-zookeeper:2181
java.net.UnknownHostException: dolphinscheduler-zookeeper
	at java.net.InetAddress$CachedAddresses.get(InetAddress.java:764)
	at java.net.InetAddress.getAllByName0(InetAddress.java:1291)
	at java.net.InetAddress.getAllByName(InetAddress.java:1144)
	at java.net.InetAddress.getAllByName(InetAddress.java:1065)
	at org.apache.zookeeper.client.StaticHostProvider$1.getAllByName(StaticHostProvider.java:88)
	at org.apache.zookeeper.client.StaticHostProvider.resolve(StaticHostProvider.java:141)
	at org.apache.zookeeper.client.StaticHostProvider.next(StaticHostProvider.java:368)
	at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:1197)
